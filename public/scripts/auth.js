!function(e){var t,r,i=e.console,n=[["auth","/lib/auth.js",function(e,t,i,n,s,f){const d=o(1,i),h=o(4,i),a=o(7,i),c=e=>h.digest(r.from(e));i.exports={generateChallenge:()=>d.randomBytes(32).toString("hex"),getPublicKeyFromPassword:e=>(e=>a.publicKeyCreate(e))(c(e)).toString("hex"),sign:(e,t)=>a.sign(r.from(e,"hex"),c(t)).toString("hex"),verify:(e,t,i)=>a.verify(r.from(e,"hex"),r.from(t,"hex"),r.from(i,"hex"))}}],["bcrypto","/lib/random-browser.js",function(e,t,r,i,n,s){"use strict";r.exports=o(2,r)}],["bcrypto","/lib/js/random.js",function(t,i,n,s,f,d){"use strict";const h=o(3,n),a=e.crypto||e.msCrypto,c=a&&"function"==typeof a.getRandomValues,u=c?a.getRandomValues.bind(a):null,l=new Uint32Array(16),b=65536;let m=0;function p(){return 0==(15&m)&&(g(l),m=0),l[m++]}function g(e){if(!c)throw new Error("Entropy source not available.");return u(e)}function w(e,t,r){if(h(null!=e&&!0===e._isBuffer),h(e.buffer instanceof ArrayBuffer),h(e.byteOffset>>>0===e.byteOffset),h(e.byteLength>>>0===e.byteLength),h(t>>>0===t),h(r>>>0===r),h(t+r<=e.byteLength),r>2**31-1)throw new RangeError('The value "size" is out of range.');const i=e.byteOffset+t,n=new Uint8Array(e.buffer,i,r);if(n.length>b)for(let e=0;e<n.length;e+=b){let t=e+b;t>n.length&&(t=n.length),g(n.subarray(e,t))}else n.length>0&&g(n)}t.native=0,t.randomBytes=function(e){h(e>>>0===e);const t=r.alloc(e);return w(t,0,e),t},t.randomFill=function(e,t,r){return h(null!=e&&!0===e._isBuffer),null==t&&(t=0),h(t>>>0===t),null==r&&(r=e.length-t),h(r>>>0===r),h(t+r<=e.length),w(e,t,r),e},t.randomInt=p,t.randomRange=function(e,t){h(e>>>0===e),h(t>>>0===t),h(t>=e);const r=t-e;if(0===r)return e;const i=-r>>>0;let n,s;do{s=(n=p())%r}while(n-s>i);return s+e}}],["bcrypto","/lib/internal/assert.js",function(e,t,r,i,n,s){"use strict";r.exports=function e(t,r){if(!t){const t=new Error(r||"Assertion failed");throw Error.captureStackTrace&&Error.captureStackTrace(t,e),t}}}],["bcrypto","/lib/sha256-browser.js",function(e,t,r,i,n,s){"use strict";r.exports=o(5,r)}],["bcrypto","/lib/js/sha256.js",function(e,t,i,n,s,f){"use strict";const d=o(3,i),h=o(6,i),a=-1,c=r.alloc(8,0),u=r.alloc(64,0);u[0]=128;const l=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);class b{constructor(){this.state=new Uint32Array(8),this.msg=new Uint32Array(64),this.block=r.alloc(64),this.size=a}init(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.size=0,this}update(e){return d(null!=e&&!0===e._isBuffer),this._update(e,e.length),this}final(){return this._final(r.alloc(32))}_update(e,t){d(this.size!==a,"Context is not initialized.");let r=63&this.size,i=0;if(this.size+=t,r>0){let n=64-r;if(n>t&&(n=t),e.copy(this.block,r,i,i+n),t-=n,i+=n,(r+=n)<64)return;this._transform(this.block,0)}for(;t>=64;)this._transform(e,i),i+=64,t-=64;t>0&&e.copy(this.block,0,i,i+t)}_final(e){d(this.size!==a,"Context is not initialized.");const t=63&this.size,r=8*this.size;y(c,r*(1/4294967296)>>>0,0),y(c,r>>>0,4),this._update(u,1+(119-t&63)),this._update(c,8);for(let t=0;t<8;t++)y(e,this.state[t],4*t),this.state[t]=0;for(let e=0;e<64;e++)this.msg[e]=0;for(let e=0;e<64;e++)this.block[e]=0;return this.size=a,e}_transform(e,t){const r=this.msg;let i=this.state[0],n=this.state[1],s=this.state[2],f=this.state[3],d=this.state[4],o=this.state[5],h=this.state[6],a=this.state[7],c=0;for(;c<16;c++)r[c]=(b=t+4*c,16777216*(u=e)[b++]+65536*u[b++]+256*u[b++]+u[b]);for(var u,b,y;c<64;c++)r[c]=(((y=r[c-2])>>>17|y<<15)^(y>>>19|y<<13)^y>>>10)+r[c-7]+g(r[c-15])+r[c-16];for(c=0;c<64;c++){const e=a+p(d)+w(d,o,h)+l[c]+r[c],t=m(i)+v(i,n,s);a=h,h=o,o=d,d=f+e>>>0,f=s,s=n,n=i,i=e+t>>>0}this.state[0]+=i,this.state[1]+=n,this.state[2]+=s,this.state[3]+=f,this.state[4]+=d,this.state[5]+=o,this.state[6]+=h,this.state[7]+=a}static hash(){return new b}static hmac(){return new h(b,64)}static digest(e){return b.ctx.init().update(e).final()}static root(e,t){return d(null!=e&&!0===e._isBuffer&&32===e.length),d(null!=t&&!0===t._isBuffer&&32===t.length),b.ctx.init().update(e).update(t).final()}static multi(e,t,r){const{ctx:i}=b;return i.init(),i.update(e),i.update(t),r&&i.update(r),i.final()}static mac(e,t){return b.hmac().init(t).update(e).final()}}function m(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function p(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function g(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}function w(e,t,r){return r^e&(t^r)}function v(e,t,r){return e&t|r&(e|t)}function y(e,t,r){return e[r++]=t>>>24,e[r++]=t>>>16,e[r++]=t>>>8,e[r++]=t,r}b.native=0,b.id="SHA256",b.size=32,b.bits=256,b.blockSize=64,b.zero=r.alloc(32,0),b.ctx=new b,i.exports=b}],["bcrypto","/lib/internal/hmac.js",function(e,t,i,n,s,f){"use strict";const d=o(3,i);i.exports=class{constructor(e,t,r=[],i=[]){d("function"==typeof e),d(t>>>0===t),d(Array.isArray(r)),d(Array.isArray(i)),this.hash=e,this.size=t,this.x=r,this.y=i,this.inner=new e,this.outer=new e}init(e){if(d(null!=e&&!0===e._isBuffer),e.length>this.size){const t=new(0,this.hash);t.init(...this.x),t.update(e),e=t.final(...this.y),d(e.length<=this.size)}const t=r.alloc(this.size);for(let r=0;r<e.length;r++)t[r]=54^e[r];for(let r=e.length;r<t.length;r++)t[r]=54;this.inner.init(...this.x),this.inner.update(t);for(let r=0;r<e.length;r++)t[r]=92^e[r];for(let r=e.length;r<t.length;r++)t[r]=92;return this.outer.init(...this.x),this.outer.update(t),this}update(e){return this.inner.update(e),this}final(){return this.outer.update(this.inner.final(...this.y)),this.outer.final(...this.y)}}}],["bcrypto","/lib/secp256k1-browser.js",function(e,t,r,i,n,s){"use strict";r.exports=o(8,r)}],["bcrypto","/lib/js/secp256k1.js",function(e,t,r,i,n,s){"use strict";const f=o(9,r),d=o(4,r),h=o(24,r);r.exports=new f("SECP256K1",d,h)}],["bcrypto","/lib/js/ecdsa.js",function(e,t,i,n,s,f){"use strict";const d=o(3,i),h=o(10,i),a=o(1,i),c=o(13,i),u=o(17,i),l=o(21,i),b=o(23,i);i.exports=class{constructor(e,t,r){d("string"==typeof e),d(t),this.id=e,this.type="ecdsa",this.hash=t,this.native=0,this._pre=r||null,this._curve=null,this._schnorr=null}get curve(){return this._curve||(this._curve=b.curve(this.id,this._pre),this._curve.precompute(a),this._pre=null),this._curve}get schnorr(){return this._schnorr||(this._schnorr=new u(this.curve,this.hash)),this._schnorr}get size(){return this.curve.fieldSize}get bits(){return this.curve.fieldBits}privateKeyGenerate(){const e=this.curve.randomScalar(a);return this.curve.encodeScalar(e)}privateKeyVerify(e){let t;d(null!=e&&!0===e._isBuffer);try{t=this.curve.decodeScalar(e)}catch(e){return!1}return!t.isZero()&&t.cmp(this.curve.n)<0}privateKeyExport(e){const t=this.publicKeyCreate(e,!1),{x:i,y:n}=this.publicKeyExport(t);return{d:r.from(e),x:i,y:n}}privateKeyImport(e){d(e&&"object"==typeof e);const t=h.decode(e.d,this.curve.endian);if(t.isZero()||t.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");return this.curve.encodeScalar(t)}privateKeyTweakAdd(e,t){const r=this.curve.decodeScalar(t);if(r.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const i=this.curve.decodeScalar(e);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const n=i.add(r).imod(this.curve.n);if(n.isZero())throw new Error("Invalid private key.");return this.curve.encodeScalar(n)}privateKeyTweakMul(e,t){const r=this.curve.decodeScalar(t);if(r.isZero()||r.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const i=this.curve.decodeScalar(e);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const n=i.mul(r).imod(this.curve.n);if(n.isZero())throw new Error("Invalid private key.");return this.curve.encodeScalar(n)}privateKeyReduce(e){d(null!=e&&!0===e._isBuffer),e.length>this.curve.scalarSize&&(e=e.slice(0,this.curve.scalarSize));const t=h.decode(e,this.curve.endian).imod(this.curve.n);if(t.isZero())throw new Error("Invalid private key.");return this.curve.encodeScalar(t)}privateKeyNegate(e){const t=this.curve.decodeScalar(e);if(t.isZero()||t.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const r=t.neg().imod(this.curve.n);return this.curve.encodeScalar(r)}privateKeyInvert(e){const t=this.curve.decodeScalar(e);if(t.isZero()||t.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const r=t.invert(this.curve.n);return this.curve.encodeScalar(r)}publicKeyCreate(e,t){const r=this.curve.decodeScalar(e);if(r.isZero()||r.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");return this.curve.g.mulBlind(r).encode(t)}publicKeyConvert(e,t){return this.curve.decodePoint(e).encode(t)}publicKeyFromUniform(e,t){const r=this.curve.decodeUniform(e);return this.curve.pointFromUniform(r).encode(t)}publicKeyToUniform(e,t=a.randomInt()){const r=this.curve.decodePoint(e),i=this.curve.pointToUniform(r,t);return this.curve.encodeUniform(i,t>>>8)}publicKeyFromHash(e,t){return this.curve.pointFromHash(e).encode(t)}publicKeyToHash(e){const t=this.curve.decodePoint(e);return this.curve.pointToHash(t,0,a)}publicKeyVerify(e){d(null!=e&&!0===e._isBuffer);try{this.curve.decodePoint(e)}catch(e){return!1}return!0}publicKeyExport(e){const{x:t,y:r}=this.curve.decodePoint(e);return{x:this.curve.encodeField(t.fromRed()),y:this.curve.encodeField(r.fromRed())}}publicKeyImport(e,t){d(e&&"object"==typeof e);const r=h.decode(e.x,this.curve.endian);if(r.cmp(this.curve.p)>=0)throw new Error("Invalid point.");if(null!=e.y){const i=h.decode(e.y,this.curve.endian);if(i.cmp(this.curve.p)>=0)throw new Error("Invalid point.");const n=this.curve.point(r,i);if(!n.validate())throw new Error("Invalid point.");return n.encode(t)}return this.curve.pointFromX(r,e.sign).encode(t)}publicKeyTweakAdd(e,t,r){const i=this.curve.decodeScalar(t);if(i.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const n=this.curve.decodePoint(e);return this.curve.g.jmul(i).add(n).encode(r)}publicKeyTweakMul(e,t,r){const i=this.curve.decodeScalar(t);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");return this.curve.decodePoint(e).mul(i).encode(r)}publicKeyCombine(e,t){d(Array.isArray(e));let r=this.curve.jpoint();for(const t of e){const e=this.curve.decodePoint(t);r=r.add(e)}return r.encode(t)}publicKeyNegate(e,t){return this.curve.decodePoint(e).neg().encode(t)}signatureNormalize(e){const[t,r]=this._decodeCompact(e);return r.cmp(this.curve.nh)>0&&r.ineg().imod(this.curve.n),this._encodeCompact(t,r)}signatureNormalizeDER(e){const[t,r]=this._decodeDER(e,!1);return r.cmp(this.curve.nh)>0&&r.ineg().imod(this.curve.n),this._encodeDER(t,r)}signatureExport(e){const[t,r]=this._decodeCompact(e);return this._encodeDER(t,r)}signatureImport(e){const[t,r]=this._decodeDER(e,!1);return this._encodeCompact(t,r)}isLowS(e){let t;d(null!=e&&!0===e._isBuffer);try{[,t]=this._decodeCompact(e)}catch(e){return!1}return t.cmp(this.curve.nh)<=0}isLowDER(e){let t;d(null!=e&&!0===e._isBuffer);try{[,t]=this._decodeDER(e,!1)}catch(e){return!1}return t.cmp(this.curve.nh)<=0}sign(e,t){const[r,i]=this._sign(e,t);return this._encodeCompact(r,i)}signRecoverable(e,t){const[r,i,n]=this._sign(e,t);return[this._encodeCompact(r,i),n]}signDER(e,t){const[r,i]=this._sign(e,t);return this._encodeDER(r,i)}signRecoverableDER(e,t){const[r,i,n]=this._sign(e,t);return[this._encodeDER(r,i),n]}_sign(e,t){const{n:r,nh:i}=this.curve,n=this.curve.g,s=this.curve.decodeScalar(t);if(s.isZero()||s.cmp(r)>=0)throw new Error("Invalid private key.");const f=this._reduce(e),d=this.curve.encodeScalar(f),o=new l(this.hash,t,d);for(;;){const e=o.generate(this.curve.scalarSize),t=this._truncate(e);if(t.isZero()||t.cmp(r)>=0)continue;const d=n.mulBlind(t);if(d.isInfinity())continue;const h=d.getX(),c=h.mod(r);if(c.isZero())continue;const u=this.curve.randomScalar(a),l=t.mul(u).fermat(r),b=s.mul(u).imod(r),m=f.mul(u).imod(r),p=c.mul(b).iadd(m).imod(r).mul(l).imod(r);if(p.isZero())continue;let g=d.isOdd()|!h.eq(c)<<1;return p.cmp(i)>0&&(p.ineg().imod(r),g^=1),[c,p,g]}}verify(e,t,r){let i,n;d(null!=e&&!0===e._isBuffer),d(null!=t&&!0===t._isBuffer),d(null!=r&&!0===r._isBuffer);try{[i,n]=this._decodeCompact(t)}catch(e){return!1}try{return this._verify(e,i,n,r)}catch(e){return!1}}verifyDER(e,t,r){let i,n;d(null!=e&&!0===e._isBuffer),d(null!=t&&!0===t._isBuffer),d(null!=r&&!0===r._isBuffer);try{[i,n]=this._decodeDER(t,!1)}catch(e){return!1}try{return this._verify(e,i,n,r)}catch(e){return!1}}_verify(e,t,r,i){const{n:n}=this.curve,s=this.curve.g,f=this._reduce(e),d=this.curve.decodePoint(i);if(t.isZero()||t.cmp(n)>=0)return!1;if(r.isZero()||r.cmp(n)>=0)return!1;const o=r.invert(n),h=f.mul(o).imod(n),a=t.mul(o).imod(n);return s.jmulAdd(h,d,a).eqR(t)}recover(e,t,r,i){let n,s,f;d(null!=e&&!0===e._isBuffer),d(null!=t&&!0===t._isBuffer),d(r>>>0===r),d((3&r)===r,"The recovery param is more than two bits.");try{[n,s]=this._decodeCompact(t)}catch(e){return null}try{f=this._recover(e,n,s,r)}catch(e){return null}return f.encode(i)}recoverDER(e,t,r,i){let n,s,f;d(null!=e&&!0===e._isBuffer),d(null!=t&&!0===t._isBuffer),d(r>>>0===r),d((3&r)===r,"The recovery param is more than two bits.");try{[n,s]=this._decodeDER(t,!1)}catch(e){return null}try{f=this._recover(e,n,s,r)}catch(e){return null}return f.encode(i)}_recover(e,t,r,i){const{n:n,pmodn:s}=this.curve,f=this.curve.g,d=this._reduce(e);if(t.isZero()||t.cmp(n)>=0)throw new Error("Invalid R value.");if(r.isZero()||r.cmp(n)>=0)throw new Error("Invalid S value.");const o=0!=(1&i);let h=t;if(i>>>1){if(this.curve.highOrder)throw new Error("Invalid high bit.");if(h.cmp(s)>=0)throw new Error("Invalid R value.");h=h.add(n)}const a=this.curve.pointFromX(h,o),c=t.invert(n),u=d.mul(c).ineg().imod(n),l=r.mul(c).imod(n),b=f.mulAdd(u,a,l);if(b.isInfinity())throw new Error("Invalid point.");return b}derive(e,t,r){const i=this.curve.decodePoint(e),n=this.curve.decodeScalar(t);if(n.isZero()||n.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");if(this.curve.h.cmpn(1)>0&&i.isSmall())throw new Error("Invalid point.");return i.mulConst(n,a).encode(r)}schnorrSign(e,t){return this.schnorr.sign(e,t)}schnorrVerify(e,t,r){return this.schnorr.verify(e,t,r)}schnorrVerifyBatch(e){return this.schnorr.verifyBatch(e)}_encodeCompact(e,t){return r.concat([this.curve.encodeScalar(e),this.curve.encodeScalar(t)])}_decodeCompact(e){d(null!=e&&!0===e._isBuffer);const{n:t}=this.curve,r=this.curve.scalarSize;if(e.length!==2*r)throw new Error("Invalid signature size.");const i=e.slice(0,r),n=e.slice(r,2*r),s=this.curve.decodeScalar(i),f=this.curve.decodeScalar(n);if(s.cmp(t)>=0||f.cmp(t)>=0)throw new Error("Invalid signature.");return[s,f]}_encodeDER(e,t){const i=c.sizeInt(e)+c.sizeInt(t),n=r.alloc(c.sizeSeq(i));let s=0;return s=c.writeSeq(n,s,i),s=c.writeInt(n,s,e),s=c.writeInt(n,s,t),d(s===n.length),n}_decodeDER(e,t){d(null!=e&&!0===e._isBuffer),d("boolean"==typeof t);const{n:r}=this.curve;let i,n,s=0;if(s=c.readSeq(e,s,t),[i,s]=c.readInt(e,s,t),[n,s]=c.readInt(e,s,t),t&&s!==e.length)throw new Error("Trailing bytes.");if(i.cmp(r)>=0||n.cmp(r)>=0)throw new Error("Invalid signature.");return[i,n]}_truncate(e){d(null!=e&&!0===e._isBuffer);const t=this.curve.n.bitLength(),r=t+7>>>3;e.length>r&&(e=e.slice(0,r));const i=h.decode(e,this.curve.endian),n=8*e.length-t;return n>0&&i.iushrn(n),i}_reduce(e){return this._truncate(e).imod(this.curve.n)}}}],["bcrypto","/lib/bn-browser.js",function(e,t,r,i,n,s){"use strict";r.exports=o(11,r)}],["bcrypto","/lib/js/bn.js",function(e,t,i,n,s,f){"use strict";const{custom:d}=o(12,i),h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],a=[0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],c=[0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176],u={p192:null,p224:null,p521:null,k256:null,p251:null,p25519:null,p448:null},l={NONE:0,QUO:1,REM:2,BOTH:3,EUCLID:4,ALL:7},b=4,m=1<<b-1,p="function"==typeof BigInt;class g{constructor(e,t,r){this.words=[0],this.length=1,this.negative=0,this.red=null,this.from(e,t,r)}_iadd(e,t){let r=0,i=0;for(e.length<t.length&&([e,t]=[t,e]),e!==this&&this._alloc(e.length);i<t.length;i++){const n=(0|e.words[i])+(0|t.words[i])+r;this.words[i]=67108863&n,r=n>>>26}for(;0!==r&&i<e.length;i++){const t=(0|e.words[i])+r;this.words[i]=67108863&t,r=t>>>26}if(this.length=e.length,0!==r)this._alloc(this.length+1),this.words[this.length++]=r;else if(e!==this)for(;i<e.length;i++)this.words[i]=e.words[i];return this}_iaddn(e){if(this.words[0]+=e,this.words[0]<67108864)return this;let t=0;for(this._alloc(this.length+1),this.words[this.length]=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,this.words[t+1]+=1;return this.length=Math.max(this.length,t+1),this}iadd(e){if(O(g.isBN(e),"num","bignum"),this.negative===e.negative)this._iadd(this,e);else{const t=this.ucmp(e);if(0===t)return this.words[0]=0,this.length=1,this.negative=0,this;t<0?(this._isub(e,this),this.negative^=1):this._isub(this,e)}return this}iaddn(e){O(k(e),"num","smi");const t=e<0|0;return t&&(e=-e),this.negative===t?this._iaddn(e):1===this.length&&this.words[0]<e?(this.words[0]=e-this.words[0],this.negative^=1):this._isubn(e),this}add(e){return O(g.isBN(e),"num","bignum"),e.length>this.length?e.clone().iadd(this):this.clone().iadd(e)}addn(e){return this.clone().iaddn(e)}_isub(e,t){let r=0,i=0;for(z(e.length>=t.length),e!==this&&this._alloc(e.length);i<t.length;i++){const n=(0|e.words[i])-(0|t.words[i])+r;r=n>>26,this.words[i]=67108863&n}for(;0!==r&&i<e.length;i++){const t=(0|e.words[i])+r;r=t>>26,this.words[i]=67108863&t}if(z(0===r),e!==this)for(;i<e.length;i++)this.words[i]=e.words[i];return this.length=Math.max(this.length,i),this._strip()}_isubn(e){if(this.words[0]-=e,this.words[0]>=0)return this._normalize();z(1!==this.length),this._alloc(this.length+1);for(let e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.words[this.length]=0,this._strip()}isub(e){if(O(g.isBN(e),"num","bignum"),this.negative!==e.negative)this._iadd(this,e);else{const t=this.ucmp(e);if(0===t)return this.words[0]=0,this.length=1,this.negative=0,this;t<0?(this._isub(e,this),this.negative^=1):this._isub(this,e)}return this}isubn(e){O(k(e),"num","smi");const t=e<0|0;return t&&(e=-e),this.negative!==t?this._iaddn(e):1===this.length&&this.words[0]<e?(this.words[0]=e-this.words[0],this.negative^=1):this._isubn(e),this}sub(e){return this.clone().isub(e)}subn(e){return this.clone().isubn(e)}_mul(e,t){if(O(g.isBN(e),"num","bignum"),O(g.isBN(t),"out","bignum"),10===this.length&&10===e.length)return Y(this,e,t);const r=this.length+e.length;return r<63?C(this,e,t):r<1024?X(this,e,t):function(e,t,r){if(!p||e.length+t.length>82595519)return X(e,t,r);const i=BigInt(0),n=BigInt(67108863),s=BigInt(26);let f=e.toBigInt()*t.toBigInt();const d=f<i|0;d&&(f=-f);let o=0;for(;f>i;)r.words[o++]=Number(f&n),f>>=s;0===o&&(r.words[o++]=0);return r.length=o,r.negative=d,r}(this,e,t)}imul(e){return this.mul(e)._move(this)}imuln(e){O(k(e),"num","smi");const t=e<0|0;t&&(e=-e);let r=0;for(let t=0;t<this.length;t++){const i=this.words[t]*e,n=(67108863&i)+(67108863&r);r>>=26,r+=i/67108864|0,r+=n>>>26,this.words[t]=67108863&n}return this.negative^=t,0!==r?(this._alloc(this.length+1),this.words[this.length++]=r):this._strip(),this}mul(e){O(g.isBN(e),"num","bignum");const t=this.length+e.length,r=new g;r.words=new Array(t);for(let e=0;e<t;e++)r.words[e]=0;return this._mul(e,r)}muln(e){return this.clone().imuln(e)}mulShift(e,t){O(g.isBN(e),"num","bignum"),O(t>>>0===t,"bits","uint32");const r=this.mul(e),i=r.utestn(t-1);return r.iushrn(t),this.negative^e.negative?r.isubn(i):r.iaddn(i)}_div(e,t){O(g.isBN(e),"num","bignum"),z((t&l.ALL)===t),z(t!==l.NONE);const r=this,i=e;if(P(!i.isZero()),r.isZero())return[new g(0),new g(0)];const n=r.negative,s=i.negative;r.negative=0,i.negative=0;let f=null,d=null;return r.ucmp(i)<0?(t&l.QUO&&(f=new g(0)),t&l.REM&&(d=r.clone())):1===i.length?(t&l.QUO&&(f=r.quon(i.words[0])),t&l.REM&&(d=r.remn(i.words[0]))):[f,d]=r._wordDiv(i,t),r.negative=n,i.negative=s,t&l.QUO&&(f.negative=r.negative^i.negative,f._normalize()),t&l.REM&&(d.negative=r.negative,d._normalize()),t&l.EUCLID&&(t&l.QUO&&(z(0!=(t&l.REM)),0!==d.negative&&(0!==i.negative?f.iaddn(1):f.isubn(1))),t&l.REM&&0!==d.negative&&(0!==i.negative?d.isub(i):d.iadd(i))),[f,d]}_wordDiv(e,t){let r,i=this.clone(),n=e,s=null;const f=0|n.words[n.length-1],d=26-Z(f);0!==d?(n=n.clone(),i.iushln(d),n.iushln(d),r=0|n.words[n.length-1]):r=f;const o=i.length-n.length;if(z(o>=0),t&l.QUO){(s=new g(0)).length=o+1,s.words=new Array(s.length);for(let e=0;e<s.length;e++)s.words[e]=0}const h=i.clone();h._ishlnsubmul(n,1,o),0===h.negative&&(s&&(s.words[o]=1),i=h);for(let e=o-1;e>=0;e--){const t=(67108864*i.words[n.length+e]+i.words[n.length+e-1])/r|0;let f=Math.min(t,67108863);for(i._ishlnsubmul(n,f,e);0!==i.negative;)f-=1,i.negative=0,i._ishlnsubmul(n,1,e),i.ineg();s&&(s.words[e]=f)}return s&&s._strip(),t&l.REM&&0!==d&&i.iushrn(d),[s,i]}_ishlnsubmul(e,t,r){let i=0,n=0;for(this._expand(e.length+r);n<e.length;n++){const s=(0|this.words[n+r])+i,f=e.words[n]*t,d=s-(67108863&f);i=(d>>26)-(f/67108864|0),this.words[n+r]=67108863&d}for(;n<this.length-r;n++){const e=(0|this.words[n+r])+i;i=e>>26,this.words[n+r]=67108863&e}if(0===i)return this._strip();z(-1===i),i=0;for(let e=0;e<this.length;e++){const t=-(0|this.words[e])+i;i=t>>26,this.words[e]=67108863&t}return this.negative=1,this._strip()}quorem(e){return this._div(e,l.BOTH)}iquo(e){return this.quo(e)._move(this)}iquon(e){O(k(e),"num","smi"),P(0!==e);const t=e<0|0;t&&(e=-e);let r=0;for(let t=this.length-1;t>=0;t--){const i=(0|this.words[t])+67108864*r;this.words[t]=i/e|0,r=i%e}return this.negative^=t,this._strip()}quo(e){return this._div(e,l.QUO)[0]}quon(e){return this.clone().iquon(e)}irem(e){return this.rem(e)._move(this)}iremn(e){let t=this.remrn(e);return t<0&&(t=-t),this.words[0]=t,this.length=1,this._normalize()}rem(e){return this._div(e,l.REM)[1]}remn(e){return this.clone().iremn(e)}remrn(e){O(k(e),"num","smi"),P(0!==e),e<0&&(e=-e);const t=(1<<26)%e;let r=0;for(let i=this.length-1;i>=0;i--)r=(t*r+(0|this.words[i]))%e;return 0!==this.negative?0|-r:r}divmod(e){return this._div(e,l.BOTH|l.EUCLID)}idiv(e){return this.div(e)._move(this)}idivn(e){if(0===this.negative)return this.iquon(e);const t=this.remrn(e);return this.iquon(e),t<0&&(e<0?this.iaddn(1):this.isubn(1)),this}div(e){return this._div(e,l.BOTH|l.EUCLID)[0]}divn(e){return this.clone().idivn(e)}imod(e){return this.ucmp(e)<0?(0!==this.negative&&(this._isub(e,this),this.negative=0),this):this.mod(e)._move(this)}imodn(e){return this.words[0]=this.modrn(e),this.length=1,this.negative=0,this}mod(e){return this._div(e,l.REM|l.EUCLID)[1]}modn(e){return this.clone().imodn(e)}modrn(e){O(k(e),"num","smi");let t=this.remrn(e);return t<0&&(e<0?t-=e:t+=e),t}divRound(e){const[t,r]=this.quorem(e);if(r.isZero())return t;const i=1&e.words[0];e.iushrn(1);const n=r.ucmp(e);return e.iushln(1),e.words[0]|=i,n<0||e.isOdd()&&0===n?t:this.negative^e.negative?t.isubn(1):t.iaddn(1)}ipow(e){return this.pow(e)._move(this)}ipown(e){return this.pown(e)._move(this)}pow(e){O(g.isBN(e),"num","bignum");let t=Z(e.words[e.length-1]),r=new g(1);for(let i=e.length-1;i>=0;i--){const n=e.words[i];for(let e=t-1;e>=0;e--)r=r.sqr(),n>>e&1&&(r=r.mul(this));t=26}return r}pown(e){if(O(k(e),"num","smi"),e<0&&(e=-e),0===e)return new g(1);if(1===e)return this.clone();let t=this;for(let r=Z(e)-2;r>=0;r--)t=t.sqr(),e>>r&1&&(t=t.mul(this));return t}isqr(){return this.imul(this)}sqr(){return this.mul(this)}_rootrem(e,t){if(O(e>>>0===e,"num","uint32"),0===e)throw new RangeError("Zeroth root.");if(~e&this.negative)throw new RangeError("Negative with even root.");if(this.ucmpn(1)<=0)return[this.clone(),new g(0)];let r,i,n=new g(0),s=g.shift(1,this.bitLength()/e+1|0);if(0!==this.negative&&s.ineg(),2===e)do{n=s,(s=this.quo(n)).iadd(n),s.iushrn(1)}while(s.ucmp(n)<0);else do{s=(n=s).pown(e-1),s=this.quo(s),r=n.muln(e-1),s.iadd(r),s=s.quon(e)}while(s.ucmp(n)<0);return t&&(s=n.pown(e),i=this.sub(s)),[n,i]}rootrem(e){return this._rootrem(e,1)}iroot(e){return this.root(e)._move(this)}root(e){return this._rootrem(e,0)[0]}isPower(e){if(O(e>>>0===e,"num","uint32"),0===e||~e&this.negative)return!1;const[,t]=this.rootrem(e);return 0===t.sign()}sqrtrem(){return this.rootrem(2)}isqrt(){return this.sqrt()._move(this)}sqrt(){return this.root(2)}isSquare(){return this.isPower(2)}iand(e){O(g.isBN(e),"num","bignum");let t=this,r=e;if(t===r)return t;if(0==(t.negative|r.negative))return t.iuand(r);if(1==(t.negative&r.negative))return t.iaddn(1),r.iaddn(1),t.iuor(r),t.isubn(1),r.isubn(1),t;0!==t.negative&&([t,r]=[r.clone(),t]);const i=t.bitLength();return r.iaddn(1),r.inotn(i),t.iuand(r),r.inotn(i),r.isubn(1),t._move(this)}iandn(e){return O(k(e),"num","smi"),0!=(this.negative|e<0)?this.iand(new g(e)):(this.words[0]&=e,this.length=1,this)}and(e){return this.clone().iand(e)}andn(e){return this.clone().iandn(e)}andrn(e){if(O(k(e),"num","smi"),0!=(this.negative|e<0)){const t=this.iand(new g(e));if(t.length>1)throw new RangeError("Number exceeds 26 bits.");return 0!==t.negative?-t.words[0]:t.words[0]}return this.words[0]&e}iuand(e){O(g.isBN(e),"num","bignum"),this.length=Math.min(this.length,e.length);for(let t=0;t<this.length;t++)this.words[t]&=e.words[t];return this._strip()}iuandn(e){return O(k(e),"num","smi"),this.words[0]&=Math.abs(e),this.length=1,this._normalize()}uand(e){return this.clone().iuand(e)}uandn(e){return this.clone().iuandn(e)}uandrn(e){O(k(e),"num","smi");const t=this.words[0]&Math.abs(e);return 0!==this.negative?0|-t:t}ior(e){O(g.isBN(e),"num","bignum");let t=this,r=e;return t===r?t:0==(t.negative|r.negative)?t.iuor(r):1==(t.negative&r.negative)?(t.iaddn(1),r.iaddn(1),t.iuand(r),t.isubn(1),r.isubn(1),t):(r=r.clone(),0!==t.negative&&([t,r]=[r,t]),r.iaddn(1),t.inotn(r.bitLength()),r.iuand(t),r.isubn(1),r._move(this))}iorn(e){return O(k(e),"num","smi"),0!=(this.negative|e<0)?this.ior(new g(e)):(this.words[0]|=e,this)}or(e){return this.clone().ior(e)}orn(e){return this.clone().iorn(e)}iuor(e){O(g.isBN(e),"num","bignum"),this._expand(e.length);for(let t=0;t<e.length;t++)this.words[t]|=e.words[t];return this}iuorn(e){return O(k(e),"num","smi"),this.words[0]|=Math.abs(e),this}uor(e){return this.clone().iuor(e)}uorn(e){return this.clone().iuorn(e)}ixor(e){O(g.isBN(e),"num","bignum");let t=this,r=e;return t===r?(t.words[0]=0,t.length=1,t.negative=0,t):0==(t.negative|r.negative)?t.iuxor(r):1==(t.negative&r.negative)?(t.iaddn(1),r.iaddn(1),t.iuxor(r),t.ineg(),r.isubn(1),t):(0!==t.negative&&([t,r]=[r.clone(),t]),r.iaddn(1),t.iuxor(r),t.iaddn(1),t.ineg(),r.isubn(1),t._move(this))}ixorn(e){return O(k(e),"num","smi"),0!=(this.negative|e<0)?this.ixor(new g(e)):(this.words[0]^=e,this)}xor(e){return this.clone().ixor(e)}xorn(e){return this.clone().ixorn(e)}iuxor(e){O(g.isBN(e),"num","bignum");let t=this,r=e;t.length<r.length&&([t,r]=[r,t]);let i=0;for(;i<r.length;i++)this.words[i]=t.words[i]^r.words[i];if(t!==this)for(this._alloc(t.length);i<t.length;i++)this.words[i]=t.words[i];return this.length=t.length,this._strip()}iuxorn(e){return O(k(e),"num","smi"),this.words[0]^=Math.abs(e),this._normalize()}uxor(e){return this.clone().iuxor(e)}uxorn(e){return this.clone().iuxorn(e)}inot(){return 0!==this.negative?this.ineg().isubn(1):this.iaddn(1).ineg(),this}not(){return this.clone().inot()}inotn(e){O(e>>>0===e,"width","uint32");const t=e%26;let r=Math.ceil(e/26),i=0;for(this._expand(r),t>0&&(r-=1);i<r;i++)this.words[i]^=67108863;return t>0&&(this.words[i]^=(1<<t)-1),this._strip()}notn(e){return this.clone().inotn(e)}ishl(e){return O(g.isBN(e),"bits","bignum"),O(e.bitLength()<=32,"bits","uint32"),this.ishln(e.toNumber())}ishln(e){return this.iushln(e)}shl(e){return this.clone().ishl(e)}shln(e){return this.clone().ishln(e)}iushl(e){return O(g.isBN(e),"bits","bignum"),O(e.bitLength()<=32,"bits","uint32"),this.iushln(e.toNumber())}iushln(e){O(e>>>0===e,"bits","uint32");const t=e%26,r=(e-t)/26,i=(1<<t)-1<<26-t;if(0!==t){let e=0;for(let r=0;r<this.length;r++){const n=this.words[r]&i,s=(0|this.words[r])-n<<t;this.words[r]=s|e,e=n>>>26-t}0!==e&&(this._alloc(this.length+1),this.words[this.length++]=e)}if(0!==r){this._alloc(this.length+r);for(let e=this.length-1;e>=0;e--)this.words[e+r]=this.words[e];for(let e=0;e<r;e++)this.words[e]=0;this.length+=r}return this._strip()}ushl(e){return this.clone().iushl(e)}ushln(e){return this.clone().iushln(e)}_split(e,t){const r=e%26,i=Math.min((e-r)/26,this.length),n=(1<<r)-1;if(t){t._alloc(i);for(let e=0;e<i;e++)t.words[e]=this.words[e];t.length=i}if(0===i);else if(this.length>i){this.length-=i;for(let e=0;e<this.length;e++)this.words[e]=this.words[e+i]}else this.words[0]=0,this.length=1;let s=0;if(0!==r)for(let e=this.length-1;e>=0;e--){const t=0|this.words[e];this.words[e]=s<<26-r|t>>>r,s=t&n}return t&&(0!==s?(t._alloc(t.length+1),t.words[t.length++]=s):(0===t.length&&(t.words[t.length++]=0),t._strip())),this._strip()}ishr(e){return O(g.isBN(e),"bits","bignum"),O(e.bitLength()<=32,"bits","uint32"),this.ishrn(e.toNumber())}ishrn(e){return O(e>>>0===e,"bits","uint32"),0!==this.negative?(this.iaddn(1),this.iushrn(e),this.isubn(1),this):this.iushrn(e)}shr(e){return this.clone().ishr(e)}shrn(e){return this.clone().ishrn(e)}iushr(e){return O(g.isBN(e),"bits","bignum"),O(e.bitLength()<=32,"bits","uint32"),this.iushrn(e.toNumber())}iushrn(e){return O(e>>>0===e,"bits","uint32"),this._split(e,null)}ushr(e){return this.clone().iushr(e)}ushrn(e){return this.clone().iushrn(e)}setn(e,t){return O(e>>>0===e,"bit","uint32"),0!==this.negative?(this.iaddn(1),this.usetn(e,!t),this.isubn(1),this):this.usetn(e,t)}usetn(e,t){O(e>>>0===e,"bit","uint32");const r=e%26,i=(e-r)/26;return this._expand(i+1),t?this.words[i]|=1<<r:this.words[i]&=~(1<<r),this._strip()}testn(e){O(e>>>0===e,"bit","uint32");const t=e%26,r=(e-t)/26;if(this.length<=r)return this.negative;const i=this.words[r],n=i>>t&1;if(0!==this.negative){if(t>0&&i&(1<<t)-1)return 1^n;let e=r;for(;e--;)if(this.words[e]>0)return 1^n}return n}utestn(e){O(e>>>0===e,"bit","uint32");const t=e%26,r=(e-t)/26;return this.length<=r?0:this.words[r]>>t&1}imaskn(e){return O(e>>>0===e,"bits","uint32"),0!==this.negative&&(this.iaddn(1),this.inotn(e+1),this.ineg()),this.iumaskn(e)}maskn(e){return this.clone().imaskn(e)}iumaskn(e){O(e>>>0===e,"bits","uint32");const t=e%26;let r=(e-t)/26;return this.length<=r?this:(0!==t&&(r+=1),this.length=Math.min(r,this.length),0!==t&&(this.words[this.length-1]&=(1<<t)-1),0===this.length&&(this.words[this.length++]=0),this._strip())}umaskn(e){return this.clone().iumaskn(e)}andln(e){return this.words[0]&e}bit(e){return this.utestn(e)}bits(e,t){O(e>>>0===e,"pos","uint32"),O(t>>>0===t,"width","uint32"),O(t<=26,"width","width");const r=e%26,i=(e-r)/26;if(i>=this.length)return 0;let n=this.words[i]>>r&(1<<t)-1;if(r+t>26&&i+1<this.length){const e=r+t-26;n|=(this.words[i+1]&(1<<e)-1)<<26-r}return n}ineg(){return this.isZero()||(this.negative^=1),this}neg(){return this.clone().ineg()}iabs(){return this.negative=0,this}abs(){return this.clone().iabs()}cmp(e){if(O(g.isBN(e),"num","bignum"),this.negative!==e.negative)return e.negative-this.negative;const t=this.ucmp(e);return 0!==this.negative?0|-t:t}cmpn(e){O(k(e),"num","smi");const t=e<0|0;if(this.negative!==t)return t-this.negative;const r=this.ucmpn(e);return 0!==this.negative?0|-r:r}eq(e){return 0===this.cmp(e)}eqn(e){return 0===this.cmpn(e)}gt(e){return this.cmp(e)>0}gtn(e){return this.cmpn(e)>0}gte(e){return this.cmp(e)>=0}gten(e){return this.cmpn(e)>=0}lt(e){return this.cmp(e)<0}ltn(e){return this.cmpn(e)<0}lte(e){return this.cmp(e)<=0}lten(e){return this.cmpn(e)<=0}sign(){return 0!==this.negative?-1:1===this.length&&0===this.words[0]?0:1}isZero(){return 1===this.length&&0===this.words[0]}isNeg(){return 0!==this.negative}isPos(){return 0===this.negative}isOdd(){return 1==(1&this.words[0])}isEven(){return 0==(1&this.words[0])}ucmp(e){if(O(g.isBN(e),"num","bignum"),this.length<e.length)return-1;if(this.length>e.length)return 1;for(let t=this.length-1;t>=0;t--){const r=0|this.words[t],i=0|e.words[t];if(r!==i)return(r>i)-(r<i)}return 0}ucmpn(e){if(O(k(e),"num","smi"),this.length>1)return 1;const t=0|this.words[0];return e<0&&(e=-e),(t>e)-(t<e)}legendre(e){const t=p?g.red(e):g.mont(e);return this.toRed(t).redLegendre()}jacobi(e){if(O(g.isBN(e),"num","bignum"),e.isZero()||e.isEven())throw new Error("jacobi: `num` must be odd.");let t=this._cloneNormal(),r=e.clone(),i=1;for(r.isNeg()&&(t.isNeg()&&(i=-1),r.ineg()),(t.isNeg()||t.ucmp(r)>=0)&&t.imod(r);!t.isZero();){if(1&t._makeOdd()){const e=r.andln(7);3!==e&&5!==e||(i=-i)}t.ucmp(r)<0&&([t,r]=[r,t],3===t.andln(3)&&3===r.andln(3)&&(i=-i)),t._isub(t,r).iushrn(1);const e=r.andln(7);3!==e&&5!==e||(i=-i)}return 0!==r.cmpn(1)?0:i}kronecker(e){O(g.isBN(e),"num","bignum");const t=[0,1,0,-1,0,-1,0,1];let r=this._cloneNormal(),i=e.clone(),n=1;if(i.isZero())return 0===r.ucmpn(1)?n:0;if(!r.isOdd()&&!i.isOdd())return 0;for(1&i._makeOdd()&&(n=t[r.andln(7)]),i.isNeg()&&(r.isNeg()&&(n=-n),i.ineg());!r.isZero();){1&r._makeOdd()&&(n*=t[i.andln(7)]),(r.words[0]^67108863*r.negative)&i.words[0]&2&&(n=-n),i.imod(r),[r,i]=[i,r],i.negative=0}return 0!==i.cmpn(1)?0:n}igcd(e){return this.gcd(e)._move(this)}gcd(e){if(O(g.isBN(e),"num","bignum"),this.isZero())return e.abs();if(e.isZero())return this.abs();let t=this.clone(),r=e.clone();t.negative=0,r.negative=0;const i=t._factor2(r);for(0!==i&&(t.iushrn(i),r.iushrn(i));;){t._makeOdd(),r._makeOdd();const e=t.ucmp(r);if(e<0)[t,r]=[r,t];else if(0===e||0===r.ucmpn(1))break;t._isub(t,r)}return r.iushln(i)}ilcm(e){return this.lcm(e)._move(this)}lcm(e){return O(g.isBN(e),"num","bignum"),this.isZero()||e.isZero()?new g(0):this.quo(this.gcd(e)).mul(e).iabs()}egcd(e){if(O(g.isBN(e),"num","bignum"),this.isZero())return[new g(0),new g(e.sign()),e.abs()];if(e.isZero())return[new g(this.sign()),new g(0),this.abs()];const t=this.clone(),r=e.clone();t.negative=0,r.negative=0;const i=new g(1),n=new g(0),s=new g(0),f=new g(1),d=t._factor2(r);0!==d&&(t.iushrn(d),r.iushrn(d));const o=r.clone(),h=t.clone();for(;!t.isZero();){let e=t._makeOdd(),d=r._makeOdd();for(;e--;)(i.isOdd()||n.isOdd())&&(i.iadd(o),n.isub(h)),i.iushrn(1),n.iushrn(1);for(;d--;)(s.isOdd()||f.isOdd())&&(s.iadd(o),f.isub(h)),s.iushrn(1),f.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(s),n.isub(f)):(r.isub(t),s.isub(i),f.isub(n))}return 0!==this.negative&&s.ineg(),0!==e.negative&&f.ineg(),[s,f,r.iushln(d)]}iinvert(e){return this.invert(e)._move(this)}invert(e){if(O(g.isBN(e),"num","bignum"),B(e.sign()>0,"invert"),e.isOdd())return this._invertp(e);if(0===e.cmpn(1))throw new RangeError("Not invertible.");const[t,,r]=this.egcd(e);if(0!==r.cmpn(1))throw new RangeError("Not invertible.");return t.imod(e)}ifermat(e){return this.fermat(e)._move(this)}fermat(e){const t=p?g.red(e):g.mont(e);return this.toRed(t).redFermat().fromRed()}ipowm(e,t,r){return this.powm(e,t,r)._move(this)}powm(e,t,r){const i=!p&&r?g.mont(t):g.red(t);return this.toRed(i).redPow(e).fromRed()}ipowmn(e,t,r){return this.powmn(e,t,r)._move(this)}powmn(e,t,r){const i=r?g.mont(t):g.red(t);return this.toRed(i).redPown(e).fromRed()}isqrtm(e){return this.sqrtm(e)._move(this)}sqrtm(e){let t;return O(g.isBN(e),"p","bignum"),t=3===e.andln(3)||5===e.andln(7)?g.red(e):g.mont(e),this.toRed(t).redSqrt().fromRed()}isqrtpq(e,t){return this.sqrtpq(e,t)._move(this)}sqrtpq(e,t){const r=this.sqrtm(e),i=this.sqrtm(t),[n,s]=e.egcd(t),f=i.mul(n).mul(e),d=r.mul(s).mul(t),o=e.mul(t);return f.iadd(d).imod(o)}isPrime(e,t,r){return O(t>>>0===t,"reps","uint32"),!!this.isPrimeMR(e,t+1,!0)&&!!this.isPrimeLucas(r)}isPrimeMR(e,t,r=!1){O(t>>>0===t,"reps","uint32"),O(t>0,"reps","integer"),O("boolean"==typeof r,"force2","boolean");const i=this;if(i.cmpn(7)<0)return 0===i.cmpn(2)||0===i.cmpn(3)||0===i.cmpn(5);if(i.isEven())return!1;const n=i.subn(1),s=n.subn(2),f=n.zeroBits(),d=n.ushrn(f),o=g.red(i),h=n.toRed(o),a=new g(1).toRed(o);e:for(let i=0;i<t;i++){let n;i===t-1&&r?n=new g(2):(n=g.random(e,0,s)).iaddn(2);let c=n.toRed(o).redPow(d);if(0!==c.cmp(a)&&0!==c.cmp(h)){for(let e=1;e<f;e++){if(0===(c=c.redSqr()).cmp(h))continue e;if(0===c.cmp(a))return!1}return!1}}return!0}isPrimeLucas(e=0){O(e>>>0===e,"limit","uint32");const t=this;if(t.cmpn(1)<=0)return!1;if(t.isEven())return 0===t.cmpn(2);let r=3;for(;;){if(r>1e4)throw new Error(`Cannot find (D/n) = -1 for ${t.toString(10)}.`);if(0!==e&&r>e)return!1;const i=new g(r*r-4).jacobi(t);if(-1===i)break;if(0===i)return 0===t.cmpn(r+2);if(40===r&&t.isSquare())return!1;r+=1}const i=t.addn(1),n=i._makeOdd(),s=t.subn(2);let f=new g(2),d=new g(r);for(let e=i.bitLength();e>=0;e--)i.utestn(e)?(f=f.mul(d).iadd(t).isubn(r).imod(t),d=d.sqr().iadd(s).imod(t)):(d=d.mul(f).iadd(t).isubn(r).imod(t),f=f.sqr().iadd(s).imod(t));if(0===f.cmpn(2)||0===f.cmp(s)){let e=f.muln(r),i=d.ushln(1);if(e.cmp(i)<0&&([e,i]=[i,e]),e.isub(i).imod(t).isZero())return!0}for(let e=0;e<n-1;e++){if(f.isZero())return!0;if(0===f.cmpn(2))return!1;f=f.sqr().isubn(2).imod(t)}return!1}toTwos(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()}fromTwos(e){return O(e>>>0===e,"width","uint32"),B(e>0,"width"),this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()}toRed(e){if(O(e instanceof A,"ctx","reduction context"),this.red)throw new Error("Already in reduction context.");return e.convertTo(this)}fromRed(){return j(this.red,"fromRed"),this.red.convertFrom(this)}forceRed(e){if(O(e instanceof A,"ctx","reduction context"),this.red){if(!e.m.eq(this.red.m)||e.mont!==this.red.mont)throw new Error("Already in reduction context.")}else B(0===this.negative,"red"),B(this.ucmp(e.m)<0,"red");return this.clone()._forceRed(e)}redIAdd(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redIAdd"),this.red.iadd(this,e)}redAdd(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redAdd"),this.red.add(this,e)}redIAddn(e){return O(k(e),"num","smi"),j(this.red,"redIAddn"),this.red.iaddn(this,e)}redAddn(e){return O(k(e),"num","smi"),j(this.red,"redAddn"),this.red.addn(this,e)}redISub(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redISub"),this.red.isub(this,e)}redSub(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redSub"),this.red.sub(this,e)}redISubn(e){return O(k(e),"num","smi"),j(this.red,"redISubn"),this.red.isubn(this,e)}redSubn(e){return O(k(e),"num","smi"),j(this.red,"redSubn"),this.red.subn(this,e)}redIMul(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redIMul"),this.red.imul(this,e)}redMul(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redMul"),this.red.mul(this,e)}redIMuln(e){return O(k(e),"num","smi"),j(this.red,"redIMuln"),this.red.imuln(this,e)}redMuln(e){return O(k(e),"num","smi"),j(this.red,"redMuln"),this.red.muln(this,e)}redIDiv(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redIDiv"),this.red.idiv(this,e)}redDiv(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redDiv"),this.red.div(this,e)}redIDivn(e){return O(k(e),"num","smi"),j(this.red,"redIDivn"),this.red.idivn(this,e)}redDivn(e){return O(k(e),"num","smi"),j(this.red,"redDivn"),this.red.divn(this,e)}redIPow(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redIPow"),R(!e.red,"redIPow"),this.red.ipow(this,e)}redPow(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redPow"),R(!e.red,"redPow"),this.red.pow(this,e)}redIPown(e){return O(k(e),"num","smi"),j(this.red,"redIPown"),this.red.ipown(this,e)}redPown(e){return O(k(e),"num","smi"),j(this.red,"redPown"),this.red.pown(this,e)}redISqr(){return j(this.red,"redISqr"),this.red.isqr(this)}redSqr(){return j(this.red,"redSqr"),this.red.sqr(this)}redISqrt(){return j(this.red,"redISqrt"),this.red.isqrt(this)}redSqrt(){return j(this.red,"redSqrt"),this.red.sqrt(this)}redIDivSqrt(e){return j(this.red,"redIDivSqrt"),this.red.idivsqrt(this,e)}redDivSqrt(e){return j(this.red,"redDivSqrt"),this.red.divsqrt(this,e)}redIsSquare(){return j(this.red,"redIsSquare"),this.red.isSquare(this)}redIShl(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redIShl"),R(!e.red,"redIShl"),this.red.ishl(this,e)}redShl(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redShl"),R(!e.red,"redShl"),this.red.shl(this,e)}redIShln(e){return O(e>>>0===e,"num","uint32"),j(this.red,"redIShln"),this.red.ishln(this,e)}redShln(e){return O(e>>>0===e,"num","uint32"),j(this.red,"redShln"),this.red.shln(this,e)}redINeg(){return j(this.red,"redINeg"),this.red.ineg(this)}redNeg(){return j(this.red,"redNeg"),this.red.neg(this)}redEq(e){return O(g.isBN(e),"num","bignum"),j(this.red,"redEq"),this.red.eq(this,e)}redEqn(e){return O(k(e),"num","smi"),j(this.red,"redEqn"),this.red.eqn(this,e)}redIsHigh(){return j(this.red,"redIsHigh"),this.red.isHigh(this)}redIsLow(){return j(this.red,"redIsLow"),this.red.isLow(this)}redIsOdd(){return j(this.red,"redIsOdd"),this.red.isOdd(this)}redIsEven(){return j(this.red,"redIsEven"),this.red.isEven(this)}redLegendre(){return j(this.red,"redLegendre"),this.red.legendre(this)}redJacobi(){return j(this.red,"redJacobi"),this.red.jacobi(this)}redKronecker(){return j(this.red,"redKronecker"),this.red.kronecker(this)}redIInvert(){return j(this.red,"redIInvert"),this.red.iinvert(this)}redInvert(){return j(this.red,"redInvert"),this.red.invert(this)}redIFermat(){return j(this.red,"redIFermat"),this.red.ifermat(this)}redFermat(){return j(this.red,"redFermat"),this.red.fermat(this)}_move(e){return e.words=this.words,e.length=this.length,e.negative=this.negative,e.red=this.red,e}_alloc(e){for(;this.words.length<e;)this.words.push(0);return this}_expand(e){for(this._alloc(e);this.length<e;)this.words[this.length++]=0;return this}_strip(){for(;this.length>1&&0===this.words[this.length-1];)this.length-=1;return this._normalize()}_normalize(){return z(this.length>0),1===this.length&&0===this.words[0]&&(this.negative=0),this}_check(){return z(this.length>0),z(this.length<=this.words.length),1===this.length?(0===this.words[0]&&z(0===this.negative),this):(z(0!==this.words[this.length-1]),this)}_invertp(e){if(O(g.isBN(e),"p","bignum"),B(e.sign()>0,"invert"),z(e.isOdd()),0===e.cmpn(1))throw new RangeError("Not invertible.");const t=this.clone(),r=e.clone(),i=new g(1),n=new g(0);for((t.isNeg()||t.ucmp(r)>=0)&&t.imod(r);!t.isZero();){let s=t._makeOdd(),f=r._makeOdd();for(;s--;)i.isOdd()&&i._iadd(i,e),i.iushrn(1);for(;f--;)n.isOdd()&&n._iadd(n,e),n.iushrn(1);t.ucmp(r)>=0?(t._isub(t,r),i.ucmp(n)<0?(i._isub(n,i),i._isub(e,i)):i._isub(i,n)):(r._isub(r,t),n.ucmp(i)<0?(n._isub(i,n),n._isub(e,n)):n._isub(n,i))}if(0!==r.cmpn(1))throw new RangeError("Not invertible.");return z(0===n.negative),z(n.ucmp(e)<0),n}_makeOdd(){const e=this.zeroBits();return e>0&&this.iushrn(e),e}_factor2(e){if(1&(this.words[0]|e.words[0]))return 0;const t=Math.min(this.length,e.length);let r=0;for(let i=0;i<t;i++){const t=L(this.words[i]|e.words[i]);if(r+=t,26!==t)break}return r}_cloneNormal(){return this.red?this.fromRed():this.clone()}_forceRed(e){return this.red=e,this}clone(){const e=new g;e.words=new Array(this.length);for(let t=0;t<this.length;t++)e.words[t]=this.words[t];return e.length=this.length,e.negative=this.negative,e.red=this.red,e}inject(e){O(g.isBN(e),"num","bignum"),this._alloc(e.length);for(let t=0;t<e.length;t++)this.words[t]=e.words[t];return this.length=e.length,this.negative=e.negative,this.red=e.red,this}set(e,t){return this.fromNumber(e,t)}swap(e){O(g.isBN(e),"num","bignum");const t=this,r=e;return[t.words,r.words]=[r.words,t.words],[t.length,r.length]=[r.length,t.length],[t.negative,r.negative]=[r.negative,t.negative],[t.red,r.red]=[r.red,t.red],t}reverse(){const e=this.negative;return this.fromBuffer(this.toBuffer("be"),"le"),this.negative=e,this}byteLength(){return Math.ceil(this.bitLength()/8)}bitLength(){const e=Z(this.words[this.length-1]);return 26*(this.length-1)+e}zeroBits(){if(this.isZero())return 0;if(this.isOdd())return 0;let e=0;for(let t=0;t<this.length;t++){const r=L(this.words[t]);if(e+=r,26!==r)break}return e}isSafe(){return this.length<=2||3===this.length&&1===this.words[2]}word(e){return O(e>>>0===e,"pos","uint32"),e>=this.length?0:this.words[e]}[d](){let e="BN";return this.red&&(e="BN-R"),`<${e}: ${this.toString(10)}>`}csign(){return-2*this.negative+1-this.czero()}czero(){const e=this.words[0]-1>>>31;return this.length-2>>>31&e}cneg(){return this.negative}cpos(){return 1^this.negative}ceq(e){O(g.isBN(e),"num","bignum");let t=0;for(let r=0;r<e.length;r++)t|=this.words[r%this.length]^e.words[r];return t|=this.length^e.length,(t|=this.negative^e.negative)-1>>>31}ceqn(e){const t=e>>31&1,r=(0|e)*(1|-t)&67108863;let i=0;return i|=this.words[0]^r,i|=1^this.length,(i|=this.negative^t)-1>>>31}cswap(e,t){O(g.isBN(e),"num","bignum");const r=this,i=e,n=67108863&-(1&(t>>31|-t>>31));r._alloc(i.words.length),i._alloc(r.words.length);for(let e=0;e<r.words.length;e++){const t=(r.words[e]^i.words[e])&n;r.words[e]^=t,i.words[e]^=t}const s=(r.length^i.length)&n,f=(r.negative^i.negative)&n;return r.length^=s,i.length^=s,r.negative^=f,i.negative^=f,this}cinject(e,t){O(g.isBN(e),"num","bignum");const r=this,i=e,n=1&(t>>31|-t>>31),s=n-1&67108863,f=67108863&~(n-1);r._alloc(i.length);for(let e=0;e<i.length;e++)r.words[e]=r.words[e]&s|i.words[e]&f;return r.length=r.length&s|i.length&f,r.negative=r.negative&s|i.negative&f,this}cset(e,t){const r=1&(t>>31|-t>>31),i=r-1&67108863,n=67108863&~(r-1),s=e>>31&1,f=(0|e)*(1|-s)&67108863;return this.words[0]=this.words[0]&i|f&n,this.length=this.length&i|1&n,this.negative=this.negative&i|s&n,this}toNumber(){let e=this.words[0];if(2===this.length)e+=67108864*this.words[1];else if(3===this.length&&1===this.words[2])e+=4503599627370496+67108864*this.words[1];else if(this.length>2)throw new RangeError("Number can only safely store up to 53 bits.");return 0!==this.negative?-e:e}toDouble(){let e=0;for(let t=this.length-1;t>=0;t--)e=67108864*e+this.words[t];return 0!==this.negative?-e:e}valueOf(){return this.toDouble()}toBigInt(){if(!p)throw new Error("BigInt is not supported!");const e=BigInt(52),t=BigInt(26);let r=this.length-1,i=BigInt(0);for(;r>=1;r-=2){const t=67108864*this.words[r],n=this.words[r-1];i=i<<e|BigInt(t+n)}return r>=0&&(i=i<<t|BigInt(this.words[0])),0!==this.negative?-i:i}toBool(){return!this.isZero()}toString(e,t){if(e=F(e),null==t&&(t=0),0===t&&(t=1),O(e>>>0===e,"base","uint32"),O(t>>>0===t,"padding","uint32"),e<2||e>36)throw new RangeError("Base ranges between 2 and 36.");if(this._check(),16===e){let e="",r=0,i=0;for(let t=0;t<this.length;t++){const n=this.words[t],s=(16777215&(n<<r|i)).toString(16);e=0!==(i=n>>>24-r&16777215)||t!==this.length-1?h[6-s.length]+s+e:s+e,(r+=2)>=26&&(r-=26,t-=1)}for(0!==i&&(e=i.toString(16)+e);e.length%t!=0;)e="0"+e;return 0!==this.negative&&(e="-"+e),e}const r=a[e-1],i=c[e-1],n=this.clone();let s="";for(n.negative=0;!n.isZero();){const t=n.remrn(i).toString(e);n.iquon(i),s=n.isZero()?t+s:h[r-t.length]+t+s}for(this.isZero()&&(s="0");s.length%t!=0;)s="0"+s;return 0!==this.negative&&(s="-"+s),s}toJSON(){return this.toString(16,2)}toArray(e,t){return this.toArrayLike(Array,e,t)}toBuffer(e,t){return this.toArrayLike(r,e,t)}toArrayLike(e,t,r){null==t&&(t="be"),null==r&&(r=0),O("function"==typeof e,"ArrayType","function"),O("be"===t||"le"===t,"endian","endianness"),O(r>>>0===r,"length","uint32"),this._check();const i=this.byteLength(),n=r||Math.max(1,i);if(i>n)throw new RangeError("Byte array longer than desired length.");const s=function(e,t){return e.allocUnsafeSlow?e.allocUnsafeSlow(t):new e(t)}(e,n);if("be"===t){let e=s.length-1,t=0;for(let r=0;r<this.length;r++){const i=(3&r)<<1,n=this.words[r]<<i|t;s[e--]=255&n,e>=0&&(s[e--]=n>>>8&255),e>=0&&(s[e--]=n>>>16&255),6===i?(e>=0&&(s[e--]=n>>>24&255),t=0):t=n>>>24}if(e>=0){for(s[e--]=t;e>=0;)s[e--]=0;t=0}z(0===t)}else{let e=0,t=0;for(let r=0;r<this.length;r++){const i=(3&r)<<1,n=this.words[r]<<i|t;s[e++]=255&n,e<s.length&&(s[e++]=n>>>8&255),e<s.length&&(s[e++]=n>>>16&255),6===i?(e<s.length&&(s[e++]=n>>>24&255),t=0):t=n>>>24}if(e<s.length){for(s[e++]=t;e<s.length;)s[e++]=0;t=0}z(0===t)}return s}encode(e,t){return this.toBuffer(e,t)}of(e,t){return this.fromNumber(e,t)}fromNumber(e,t){null==t&&(t="be"),O(J(e),"num","integer"),O("be"===t||"le"===t,"endian","endianness");const r=e<0|0;return r&&(e=-e),e<67108864?(this.words[0]=67108863&e,this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(this.words=[67108863&e,e/67108864&67108863,1],this.length=3),this.negative=r,"le"===t&&this.reverse(),this}fromDouble(e,t){null==t&&(t="be"),O("number"==typeof e,"num","double"),O("be"===t||"le"===t,"endian","endianness"),isFinite(e)||(e=0);const r=e<=-1|0;for(e<0&&(e=-e),e=Math.floor(e),this.words=[];e>0;){const t=e%67108864,r=(e-t)/67108864;this.words.push(t),e=r}return 0===this.words.length&&this.words.push(0),this.length=this.words.length,this.negative=r,"le"===t&&this.reverse(),this}fromBigInt(e,t){if(null==t&&(t="be"),O("bigint"==typeof e,"num","bigint"),O("be"===t||"le"===t,"endian","endianness"),!p)throw new Error("BigInt is not supported!");const r=e<BigInt(0)|0;return this._fromHex(e.toString(16),r),this.negative=r,"le"===t&&this.reverse(),this}fromBool(e){return O("boolean"==typeof e,"value","boolean"),this.words[0]=0|e,this.length=1,this.negative=0,this}fromString(e,t,r){if("le"!==t&&"be"!==t||([t,r]=[r,t]),t=F(t),null==r&&(r="be"),O("string"==typeof e,"string","string"),O(t>>>0===t,"base","uint32"),O("be"===r||"le"===r,"endian","endianness"),t<2||t>36)throw new Error("Base ranges between 2 and 36.");let i=0;return(e=e.replace(/\s+/g,"")).length>0&&45===e.charCodeAt(0)&&(i=1),16===t?this._fromHex(e,i):this._fromBase(e,t,i),this.negative=i,this._normalize(),"le"===r&&this.reverse(),this}_fromHex(e,t){this.length=Math.max(2,Math.ceil((e.length-t)/6)),this.words=new Array(this.length);for(let e=0;e<this.length;e++)this.words[e]=0;let r=0,i=e.length-6,n=0;for(;i>=t;i-=6){const t=D(e,i,i+6);this.words[n]|=t<<r&67108863,this.words[n+1]|=t>>>26-r&4194303,(r+=24)>=26&&(r-=26,n+=1)}if(i+6!==t){const s=D(e,t,i+6);this.words[n]|=s<<r&67108863,this.words[n+1]|=s>>>26-r&4194303}return this._strip()}_fromBase(e,t,r){this.words[0]=0,this.length=1,this.negative=0;let i=0,n=1;for(;n<=67108863;n*=t)i+=1;i-=1,n=n/t|0;const s=e.length-r,f=s%i,d=Math.min(s,s-f)+r;let o=r;for(;o<d;o+=i){const r=T(e,o,o+i,t);this.imuln(n),this._iaddn(r)}if(0!==f){const r=Math.pow(t,f),i=T(e,o,e.length,t);this.imuln(r),this._iaddn(i)}return this}fromJSON(e){if(g.isBN(e))return e.red?e.fromRed():e.clone();if(Array.isArray(e)){for(const t of e)O("string"==typeof t,"chunk","string");e=e.join("")}return this.fromString(e,16)}fromBN(e){return this.inject(e)}fromArray(e,t){return O(Array.isArray(e),"data","array"),this.fromArrayLike(e,t)}fromBuffer(e,t){return O(null!=e&&!0===e._isBuffer,"data","buffer"),this.fromArrayLike(e,t)}fromArrayLike(e,t){if(null==t&&(t="be"),O(e&&e.length>>>0===e.length,"data","array-like"),O("be"===t||"le"===t,"endian","endianness"),0===e.length)return this.words[0]=0,this.length=1,this.negative=0,this;this.length=Math.max(2,Math.ceil(e.length/3)),this.words=new Array(this.length),this.negative=0;for(let e=0;e<this.length;e++)this.words[e]=0;const r=e.length%3;let i=0,n=0,s=0;if("be"===t){for(let t=e.length-1;t>=2;t-=3){const r=e[t]|e[t-1]<<8|e[t-2]<<16;this.words[n]|=r<<i&67108863,this.words[n+1]=r>>>26-i&67108863,(i+=24)>=26&&(i-=26,n+=1)}switch(r){case 2:s=e[1]|e[0]<<8;break;case 1:s=e[0]}}else{const t=e.length-r;for(let r=0;r<t;r+=3){const t=e[r]|e[r+1]<<8|e[r+2]<<16;this.words[n]|=t<<i&67108863,this.words[n+1]=t>>>26-i&67108863,(i+=24)>=26&&(i-=26,n+=1)}switch(r){case 2:s=e[t]|e[t+1]<<8;break;case 1:s=e[t]}}return r>0&&(this.words[n]|=s<<i&67108863,this.words[n+1]=s>>>26-i&67108863),this._strip()}decode(e,t){return this.fromBuffer(e,t)}from(e,t,r){if(null==e)return this;if("le"!==t&&"be"!==t||([t,r]=[r,t]),"number"==typeof e)return this.fromNumber(e,r);if("bigint"==typeof e)return this.fromBigInt(e,r);if("string"==typeof e)return this.fromString(e,t,r);if("object"==typeof e){if(g.isBN(e))return this.fromBN(e,r);if(e.length>>>0===e.length)return this.fromArrayLike(e,r)}if("boolean"==typeof e)return this.fromBool(e);throw new TypeError("Non-numeric object passed to BN.")}static min(...e){let t=null;for(const r of e)O(g.isBN(r),"num","bignum"),(!t||r.cmp(t)<0)&&(t=r);return t||new g(0)}static max(...e){let t=null;for(const r of e)O(g.isBN(r),"num","bignum"),(!t||r.cmp(t)>0)&&(t=r);return t||new g(0)}static cmp(e,t){return O(g.isBN(e),"a","bignum"),e.cmp(t)}static ucmp(e,t){return O(g.isBN(e),"a","bignum"),e.ucmp(t)}static red(e){return new A(e)}static barrett(e){return new x(e)}static mont(e){return new q(e)}static _prime(e){if(u[e])return u[e];let t;if("p192"===e)t=new v;else if("p224"===e)t=new y;else if("p521"===e)t=new M;else if("k256"===e)t=new S;else if("p251"===e)t=new I;else if("p25519"===e)t=new _;else{if("p448"!==e)throw new Error(`Unknown prime: "${e}".`);t=new E}return u[e]=t,t}static prime(e){return g._prime(e).p.clone()}static pow(e,t){return 2===e?g.shift(1,t):(new g).fromNumber(e).pown(t)}static shift(e,t){return 1===e?new g(0).usetn(t,1):(new g).fromNumber(e).ishln(t)}static mask(e){return g.shift(1,e).isubn(1)}static randomBits(e,t){if(O(null!=e,"rng","rng"),O(t>>>0===t,"bits","uint32"),"object"==typeof e){O("function"==typeof e.randomBytes,"rng","rng");const r=t+7>>>3,i=8*r,n=e.randomBytes(r);if(O(null!=n&&!0===n._isBuffer,"bytes","buffer"),n.length!==r)throw new RangeError("Invalid number of bytes returned from RNG.");const s=g.fromBuffer(n);return i>t&&s.iushrn(i-t),s}O("function"==typeof e,"rng","rng");const r=e(t);if(O(g.isBN(r),"num","bignum"),B(0===r.negative,"RNG"),R(!r.red,"RNG"),r.bitLength()>t)throw new RangeError("Invalid number of bits returned from RNG.");return r}static random(e,t,r){if(t=g.cast(t,16),r=g.cast(r,16),t.cmp(r)>0)throw new RangeError("Minimum cannot be greater than maximum.");const i=r.sub(t).iabs(),n=i.bitLength();if(0===n)return t.clone();for(;;){const r=g.randomBits(e,n);if(!(r.cmp(i)>=0))return r.iadd(t),r}}static of(e,t){return(new g).of(e,t)}static fromNumber(e,t){return(new g).fromNumber(e,t)}static fromDouble(e,t){return(new g).fromDouble(e,t)}static fromBigInt(e,t){return(new g).fromBigInt(e,t)}static fromBool(e){return(new g).fromBool(e)}static fromString(e,t,r){return(new g).fromString(e,t,r)}static fromJSON(e){return(new g).fromJSON(e)}static fromBN(e){return(new g).fromBN(e)}static fromArray(e,t){return(new g).fromArray(e,t)}static fromBuffer(e,t){return(new g).fromBuffer(e,t)}static fromArrayLike(e,t){return(new g).fromArrayLike(e,t)}static decode(e,t){return(new g).decode(e,t)}static from(e,t,r){return(new g).from(e,t,r)}static cast(e,t,r){return g.isBN(e)?e:new g(e,t,r)}static isBN(e){return e instanceof g}}g.BN=g,g.wordSize=26,g.native=0;class w{constructor(e,t){this.name=e,this.p=new g(t,16),this.n=this.p.bitLength(),this.k=g.shift(1,this.n).isub(this.p),this.lo=this.p.clone(),this.one=this.p.clone()}ireduce(e){const t=0!==e.negative;let r=e.bitLength();for(z(r<=2*this.n),e.negative=0;r>this.n;)this.split(e,this.lo),this.imulK(e),e._iadd(e,this.lo),r=e.bitLength();const i=r<this.n?-1:e.ucmp(this.p);return 0===i?(e.words[0]=0,e.length=1):i>0&&e._isub(e,this.p),t&&!e.isZero()&&e._isub(this.p,e),e}split(e,t){e._split(this.n,t)}imulK(e){return e.imul(this.k)}}class v extends w{constructor(){super("p192","ffffffff ffffffff ffffffff fffffffeffffffff ffffffff")}imulK(e){const t=this.one.inject(e);return e.iushln(64)._iadd(e,t)}}class y extends w{constructor(){super("p224","ffffffff ffffffff ffffffff ffffffff00000000 00000000 00000001")}imulK(e){const t=this.one.inject(e);return e.iushln(96)._isub(e,t)}}class M extends w{constructor(){super("p521","000001ff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff")}imulK(e){return e}}class S extends w{constructor(){super("k256","ffffffff ffffffff ffffffff ffffffffffffffff ffffffff fffffffe fffffc2f")}split(e,t){const r=Math.min(e.length,9);t._alloc(r+1);for(let i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9)return t._strip(),e.words[0]=0,void(e.length=1);let i=e.words[9],n=10;for(t.words[t.length++]=4194303&i,t._strip();n<e.length;n++){const t=0|e.words[n];e.words[n-10]=(4194303&t)<<4|i>>>22,i=t}i>>>=22,e.words[n-10]=i,0===i&&e.length>10?e.length-=10:e.length-=9,e._strip()}imulK(e){e._expand(e.length+2);let t=0;for(let r=0;r<e.length;r++){const i=e.words[r];t+=977*i,e.words[r]=67108863&t,t=64*i+Math.floor(t/67108864)}return 0===e.words[e.length-1]&&(e.length-=1,0===e.words[e.length-1]&&(e.length-=1)),e}}class I extends w{constructor(){super("p251","07ffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff fffffff7")}imulK(e){if(e.isZero())return e;let t=0;for(let r=0;r<e.length;r++){const i=9*e.words[r]+t;t=i>>>26,e.words[r]=67108863&i}return 0!==t&&(e._alloc(e.length+1),e.words[e.length++]=t),e}}class _ extends w{constructor(){super("p25519","7fffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffed")}imulK(e){let t=0;for(let r=0;r<e.length;r++){const i=19*e.words[r]+t;t=i>>>26,e.words[r]=67108863&i}return 0!==t&&(e._alloc(e.length+1),e.words[e.length++]=t),e}}class E extends w{constructor(){super("p448","ffffffff ffffffff ffffffff ffffffffffffffff ffffffff fffffffe ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff")}imulK(e){const t=this.one.inject(e);return e.iushln(224)._iadd(e,t)}}class A{constructor(e){let t=null;"string"==typeof e&&(e=(t=g._prime(e)).p),O(g.isBN(e),"m","bignum"),R(!e.red,"reduction"),B(e.sign()>0,"reduction"),this.m=e,this.prime=t,this.mb=null,this.sm1=null}_verify1(e){B(0===e.negative,"red"),j(null!=e.red,"red")}_verify2(e,t){B(0==(e.negative|t.negative),"red"),j(null!=e.red&&e.red===t.red,"red")}get mont(){return!1}precompute(){if(null===this.sm1&&5===this.m.andln(7)){const e=new g(2).toRed(this),t=this.m.subn(1).iushrn(2);this.sm1=this.pow(e,t)}return this}convertTo(e){const t=e.mod(this.m);return t.red=this,t}convertFrom(e){const t=e.clone();return t.red=null,t}intTo(e){return e}intFrom(e){return e}imod(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.imod(this.m)._forceRed(this)}iadd(e,t){return this._verify2(e,t),e._iadd(e,t),e.ucmp(this.m)>=0&&e._isub(e,this.m),e}add(e,t){return e.length<t.length?this.iadd(t.clone(),e):this.iadd(e.clone(),t)}iaddn(e,t){return this._verify1(e),t<0?this.isubn(e,-t):(1===this.m.length&&(t%=this.m.words[0]),e._iaddn(t),e.ucmp(this.m)>=0&&e._isub(e,this.m),e)}addn(e,t){return this.iaddn(e.clone(),t)}isub(e,t){this._verify2(e,t);const r=e.ucmp(t);return 0===r?(e.words[0]=0,e.length=1,e):(r<0?(e._isub(t,e),e._isub(this.m,e)):e._isub(e,t),e)}sub(e,t){return this.isub(e.clone(),t)}isubn(e,t){return this._verify1(e),t<0?this.iaddn(e,-t):(1===this.m.length&&(t%=this.m.words[0]),1===e.length&&e.words[0]<t?(e.words[0]=t-e.words[0],e._isub(this.m,e)):e._isubn(t),e)}subn(e,t){return this.isubn(e.clone(),t)}imul(e,t){return this._verify2(e,t),this.imod(e.imul(t))}mul(e,t){return this._verify2(e,t),this.imod(e.mul(t))}imuln(e,t){if(this._verify1(e),e.isZero())return e;if(0===t)return e.words[0]=0,e.length=1,e;const r=t<0;if(r&&(t=-t),1===this.m.length&&(t%=this.m.words[0]),e.imuln(t),t<=16)for(;e.ucmp(this.m)>=0;)e._isub(e,this.m);else this.imod(e);return r&&this.ineg(e),e}muln(e,t){return this.imuln(e.clone(),t)}idiv(e,t){return this.div(e,t)._move(e)}div(e,t){return this.mul(e,this.invert(t))}idivn(e,t){return this.divn(e,t)._move(e)}divn(e,t){return this.div(e,this.convertTo(new g(t)))}ipow(e,t){return this.pow(e,t)._move(e)}pow(e,t){return this._verify1(e),t.isNeg()&&(e=this.invert(e)),1===t.length?this.pown(e,t.words[0]):p&&!this.prime?this.powInt(e,t):this.powNum(e,t)}powNum(e,t){const r=new Array(m);r[0]=this.sqrn(e,b-1);for(let t=1;t<m;t++)r[t]=this.mul(r[t-1],e);let i=t.bitLength(),n=new g(1).toRed(this);for(;i>=b;){const e=i-b,s=t.bits(e,b);s<m?(n=this.sqr(n),i-=1):(n=this.sqrn(n,b),n=this.mul(n,r[s&~m]),i=e)}if(i>0){const r=t.bits(0,i);for(;i--;)n=this.sqr(n),r>>i&1&&(n=this.mul(n,e))}return n}powInt(e,t){null===this.mb&&(this.mb=this.m.toBigInt());const r=function(e,t,r){const i=new Array(m);i[0]=U(e,b-1,r);for(let t=1;t<m;t++)i[t]=i[t-1]*e%r;let n=t.bitLength(),s=BigInt(1);for(;n>=b;){const e=n-b,f=t.bits(e,b);f<m?(s=s*s%r,n-=1):(s=(s=U(s,b,r))*i[f&~m]%r,n=e)}if(n>0){const i=t.bits(0,n);for(;n--;)s=s*s%r,i>>n&1&&(s=s*e%r)}return s}(this.intFrom(e.toBigInt()),t,this.mb),i=this.intTo(r);return g.fromBigInt(i)._forceRed(this)}sqrn(e,t){for(let r=0;r<t;r++)e=this.sqr(e);return e}ipown(e,t){return this.pown(e,t)._move(e)}pown(e,t){if(this._verify1(e),t<0&&(e=this.invert(e),t=-t),0===t)return new g(1).toRed(this);if(1===t)return e.clone();let r=e;for(let i=Z(t)-2;i>=0;i--)r=this.sqr(r),t>>i&1&&(r=this.mul(r,e));return r}isqr(e){return this.imul(e,e)}sqr(e){return this.mul(e,e)}isqrt(e){return this.sqrt(e)._move(e)}sqrt(e){return this._verify1(e),3===this.m.andln(3)?this.sqrt3mod4(e):5===this.m.andln(7)?null!=this.sm1?this.sqrt5mod8sm1(e):this.sqrt5mod8(e):this.sqrt0(e)}sqrt3mod4(e){const t=this.m.addn(1).iushrn(2),r=this.pow(e,t);if(!this.sqr(r).eq(e))throw new Error("X is not a square mod P.");return r}sqrt5mod8(e){const t=new g(1).toRed(this),r=this.m.ushrn(3),i=this.add(e,e),n=this.pow(i,r),s=this.mul(i,this.sqr(n)),f=this.mul(this.mul(n,e),this.isub(s,t));if(!this.sqr(f).eq(e))throw new Error("X is not a square mod P.");return f}sqrt5mod8sm1(e){const t=this.m.addn(3).iushrn(3),r=this.pow(e,t);if(this.sqr(r).eq(e))return r;const i=this.mul(r,this.sm1);if(this.sqr(i).eq(e))return i;throw new Error("X is not a square mod P.")}sqrt0(e){if(0===this.m.cmpn(1)||!this.m.isOdd())throw new Error("Invalid prime.");switch(this.jacobi(e)){case-1:throw new Error("X is not a square mod P.");case 0:return new g(0)._forceRed(this)}const t=new g(1).toRed(this),r=this.m.subn(1),i=r._makeOdd(),n=new g(2).toRed(this);for(;-1!==this.jacobi(n);)this.iadd(n,t);let s=this.pow(e,r),f=this.pow(n,r),d=this.pow(e,r.iaddn(1).iushrn(1)),o=i;for(;;){let e=s,r=0;for(;0!==e.cmp(t)&&r<o;)e=this.sqr(e),r+=1;if(0===r)break;z(r<o),e=this.sqrn(f,o-r-1),f=this.sqr(e),d=this.mul(d,e),s=this.mul(s,f),o=r}return d}idivsqrt(e,t){return this.divsqrt(e,t)._move(e)}divsqrt(e,t){if(this._verify2(e,t),t.isZero())throw new RangeError("Not invertible.");return 3===this.m.andln(3)?this.divsqrt3mod4(e,t):null!=this.sm1&&5===this.m.andln(7)?this.divsqrt5mod8(e,t):this.sqrt(this.div(e,t))}divsqrt3mod4(e,t){const r=this.m.subn(3).iushrn(2),i=this.sqr(e),n=this.mul(i,e),s=this.mul(n,i),f=this.mul(this.sqr(t),t),d=this.pow(this.mul(s,f),r),o=this.mul(this.mul(n,t),d);if(0===this.mul(t,this.sqr(o)).cmp(e))return o;throw new Error("X is not a square mod P.")}divsqrt5mod8(e,t){const r=this.m.subn(5).iushrn(3),i=this.mul(this.sqr(t),t),n=this.mul(this.sqr(i),t),s=this.pow(this.mul(e,n),r),f=this.mul(this.mul(e,i),s),d=this.mul(t,this.sqr(f));if(0===d.cmp(e))return f;if(0===this.ineg(d).cmp(e))return this.mul(f,this.sm1);throw new Error("X is not a square mod P.")}isSquare(e){let t;return t=this.prime?this.legendre(e):this.m.isOdd()?this.jacobi(e):this.kronecker(e),Boolean(~t>>>31)}ishl(e,t){return this._verify1(e),this.imod(e.iushl(t))}shl(e,t){return this.ishl(e.clone(),t)}ishln(e,t){if(this._verify1(e),e.iushln(t),t<=4)for(;e.ucmp(this.m)>=0;)e._isub(e,this.m);else this.imod(e);return e}shln(e,t){return this.ishln(e.clone(),t)}ineg(e){return this._verify1(e),e.isZero()||e._isub(this.m,e),e}neg(e){return this.ineg(e.clone())}eq(e,t){return this._verify2(e,t),0===e.ucmp(t)}eqn(e,t){if(this._verify1(e),1===this.m.length)return(t%=this.m.words[0])<0&&(t+=this.m.words[0]),0===e.ucmpn(t);if(t<0){this.m._isubn(-t);const r=e.ucmp(this.m);return this.m._iaddn(-t),0===r}return 0===e.ucmpn(t)}isHigh(e){return!this.isLow(e)}isLow(e){return this._verify1(e),e.ucmp(this.m.ushrn(1))<=0}isOdd(e){return this._verify1(e),e.isOdd()}isEven(e){return this._verify1(e),e.isEven()}legendre(e){if(this._verify1(e),this.m.isEven())throw new Error("legendre: `num` must be odd.");const t=this.m.subn(1).iushrn(1),r=this.pow(e,t),i=new g(1).toRed(this),n=r.czero(),s=r.ceq(i),f=r.ceq(this.ineg(i));if(0==(n|s|f))throw new Error("Invalid prime.");return z(n+s+f===1),s-f}jacobi(e){return this._verify1(e),e.jacobi(this.m)}kronecker(e){return this._verify1(e),e.kronecker(this.m)}iinvert(e){return this.invert(e)._move(e)}invert(e){return this._verify1(e),e.invert(this.m)._forceRed(this)}ifermat(e){return this.fermat(e)._move(e)}fermat(e){if(this._verify1(e),e.isZero()||0===this.m.cmpn(1))throw new RangeError("Not invertible.");return this.pow(e,this.m.subn(2))}[d](){return this.prime?`<Red: ${this.prime.name}>`:`<Red: ${this.m.toString(10)}>`}}class x extends A{constructor(e){super(e),this.prime=null,this.n=this.m.bitLength(),this.n%26!=0&&(this.n+=26-this.n%26),this.k=2*this.n,this.w=this.k/26,this.b=g.shift(1,this.k).div(this.m)}convertTo(e){return e.length>this.w?super.convertTo(e):this.imod(e.clone())}_shift(e){let t=0,r=this.w;for(;r<e.length;)e.words[t++]=e.words[r++];0===t&&(e.words[t++]=0),e.length=t}imod(e){const t=e.negative;z(e.length<=this.w),e.negative=0;const r=e.mul(this.b);return this._shift(r),e._isub(e,r.mul(this.m)),e.ucmp(this.m)>=0&&e._isub(e,this.m),t&&!e.isZero()&&e._isub(this.m,e),e.red=this,e}}class q extends A{constructor(e){super(e),this.prime=null,this.n=26*this.m.length,this.r=g.shift(1,this.n),this.r2=g.shift(1,2*this.n).imod(this.m),this.ri=this.r.invert(this.m),this.mi=this.r.mul(this.ri).isubn(1).div(this.m),this.rib=null}get mont(){return!0}convertTo(e){return e.isNeg()||e.ucmp(this.m)>=0?this.imod(e.ushln(this.n)):this.mul(e,this.r2)}convertFrom(e){const t=this.mul(e,new g(1));return t.red=null,t}intTo(e){return(e<<BigInt(this.n))%this.mb}intFrom(e){return null===this.rib&&(this.rib=this.ri.toBigInt()),e*this.rib%this.mb}iaddn(e,t){return this.iadd(e,this.convertTo(new g(t)))}isubn(e,t){return this.isub(e,this.convertTo(new g(t)))}imul(e,t){return this.mul(e,t)._move(e)}mul(e,t){if(e.isZero()||t.isZero())return new g(0)._forceRed(this);const r=e.mul(t),i=r.umaskn(this.n).mul(this.mi).iumaskn(this.n),n=r.iadd(i.mul(this.m)).iushrn(this.n);return n.ucmp(this.m)>=0&&n._isub(n,this.m),n._forceRed(this)}imuln(e,t){if(this._verify1(e),e.isZero())return e;if(0===t)return e.words[0]=0,e.length=1,e;const r=t<0;r&&(t=-t),1===this.m.length&&(t%=this.m.words[0]);const i=Z(t);if(i>5)this.imul(e,this.convertTo(new g(t)));else if(0==(t&t-1))for(let t=0;t<i-1;t++)this.iadd(e,e);else{const r=e.clone();for(let n=i-2;n>=0;n--)this.iadd(e,e),t>>n&1&&this.iadd(e,r)}return r&&this.ineg(e),e}eqn(e,t){return this._verify1(e),0===t?e.isZero():0===e.ucmp(this.convertTo(new g(t)))}isLow(e){return this._verify1(e),this.convertFrom(e).ucmp(this.m.ushrn(1))<=0}isOdd(e){return this._verify1(e),this.convertFrom(e).isOdd()}isEven(e){return this._verify1(e),this.convertFrom(e).isEven()}invert(e){return this._verify1(e),this.imod(e.invert(this.m).mul(this.r2))}}function N(e,t,r){const i=new e(t);return e.captureStackTrace&&e.captureStackTrace(i,r),i}function z(e,t){if(!e){throw N(Error,t||"Assertion failed.",z)}}function O(e,t,r){if(!e){const e=`"${t}" must be a(n) ${r}.`;throw N(TypeError,e,O)}}function B(e,t){if(!e){const e=`"${t}" only works with positive numbers.`;throw N(RangeError,e,B)}}function j(e,t){if(!e){const e=`"${t}" only works with red numbers.`;throw N(TypeError,e,j)}}function R(e,t){if(!e){const e=`"${t}" only works with normal numbers.`;throw N(TypeError,e,R)}}function P(e){if(!e){throw N(RangeError,"Cannot divide by zero.",P)}}function J(e){return Number.isSafeInteger(e)}function k(e){return J(e)&&e>=-67108863&&e<=67108863}function F(e){if(null==e)return 10;if("number"==typeof e)return e;switch(e){case"bin":return 2;case"oct":return 8;case"dec":return 10;case"hex":return 16}return 0}function Z(e){if(Math.clz32)return 32-Math.clz32(e);let t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t}function L(e){if(0===e)return 26;let t=e,r=0;return 0==(8191&t)&&(r+=13,t>>>=13),0==(127&t)&&(r+=7,t>>>=7),0==(15&t)&&(r+=4,t>>>=4),0==(3&t)&&(r+=2,t>>>=2),0==(1&t)&&(r+=1),r}function D(e,t,r){const i=Math.min(e.length,r);let n=0,s=0;for(let r=t;r<i;r++){const t=e.charCodeAt(r)-48;let i;n<<=4,n|=i=t>=49&&t<=54?t-49+10:t>=17&&t<=22?t-17+10:t,s|=i}if(-16&s)throw new Error("Invalid string.");return n}function T(e,t,r,i){const n=Math.min(e.length,r);let s=0;for(let r=t;r<n;r++){const t=e.charCodeAt(r)-48;let n;if(s*=i,n=t>=49?t-49+10:t>=17?t-17+10:t,t<0||t>207||n>=i)throw new Error("Invalid string.");s+=n}return s}function U(e,t,r){for(let i=0;i<t;i++)e=e*e%r;return e}function C(e,t,r){const i=e.length+t.length;r.negative=e.negative^t.negative,r._alloc(i),r.length=i;const n=e.words[0]*t.words[0],s=67108863&n;let f=n/67108864|0,d=1;for(r.words[0]=s;d<r.length-1;d++){let i=f>>>26,n=67108863&f;const s=Math.max(0,d-e.length+1),o=Math.min(d,t.length-1);for(let r=s;r<=o;r++){const s=d-r,f=e.words[s]*t.words[r]+n;i+=f/67108864|0,n=67108863&f}r.words[d]=0|n,f=0|i}return 0!==f?r.words[d]=0|f:r.length-=1,r._strip()}function X(e,t,r){const i=e.length+t.length;r.negative=e.negative^t.negative,r._alloc(i),r.length=i;let n=0,s=0,f=0;for(;f<r.length-1;f++){let i=s;s=0;let d=67108863&n;const o=Math.max(0,f-e.length+1),h=Math.min(f,t.length-1);for(let r=o;r<=h;r++){const n=f-r,o=e.words[n]*t.words[r];let h=67108863&o;d=67108863&(h=h+d|0),s+=(i=(i=i+(o/67108864|0)|0)+(h>>>26)|0)>>>26,i&=67108863}r.words[f]=d,n=i,i=s}return 0!==n?r.words[f]=n:r.length-=1,r._strip()}function Y(e,t,r){const i=e.words,n=t.words,s=r.words,f=0|i[0],d=8191&f,o=f>>>13,h=0|i[1],a=8191&h,c=h>>>13,u=0|i[2],l=8191&u,b=u>>>13,m=0|i[3],p=8191&m,g=m>>>13,w=0|i[4],v=8191&w,y=w>>>13,M=0|i[5],S=8191&M,I=M>>>13,_=0|i[6],E=8191&_,A=_>>>13,x=0|i[7],q=8191&x,N=x>>>13,z=0|i[8],O=8191&z,B=z>>>13,j=0|i[9],R=8191&j,P=j>>>13,J=0|n[0],k=8191&J,F=J>>>13,Z=0|n[1],L=8191&Z,D=Z>>>13,T=0|n[2],U=8191&T,C=T>>>13,X=0|n[3],Y=8191&X,H=X>>>13,K=0|n[4],V=8191&K,$=K>>>13,G=0|n[5],W=8191&G,Q=G>>>13,ee=0|n[6],te=8191&ee,re=ee>>>13,ie=0|n[7],ne=8191&ie,se=ie>>>13,fe=0|n[8],de=8191&fe,oe=fe>>>13,he=0|n[9],ae=8191&he,ce=he>>>13;let ue,le,be,me=0;r.negative=e.negative^t.negative,r._alloc(20),r.length=19;let pe=(me+(ue=Math.imul(d,k))|0)+((8191&(le=(le=Math.imul(d,F))+Math.imul(o,k)|0))<<13)|0;me=((be=Math.imul(o,F))+(le>>>13)|0)+(pe>>>26)|0,pe&=67108863,ue=Math.imul(a,k),le=(le=Math.imul(a,F))+Math.imul(c,k)|0,be=Math.imul(c,F);let ge=(me+(ue=ue+Math.imul(d,L)|0)|0)+((8191&(le=(le=le+Math.imul(d,D)|0)+Math.imul(o,L)|0))<<13)|0;me=((be=be+Math.imul(o,D)|0)+(le>>>13)|0)+(ge>>>26)|0,ge&=67108863,ue=Math.imul(l,k),le=(le=Math.imul(l,F))+Math.imul(b,k)|0,be=Math.imul(b,F),ue=ue+Math.imul(a,L)|0,le=(le=le+Math.imul(a,D)|0)+Math.imul(c,L)|0,be=be+Math.imul(c,D)|0;let we=(me+(ue=ue+Math.imul(d,U)|0)|0)+((8191&(le=(le=le+Math.imul(d,C)|0)+Math.imul(o,U)|0))<<13)|0;me=((be=be+Math.imul(o,C)|0)+(le>>>13)|0)+(we>>>26)|0,we&=67108863,ue=Math.imul(p,k),le=(le=Math.imul(p,F))+Math.imul(g,k)|0,be=Math.imul(g,F),ue=ue+Math.imul(l,L)|0,le=(le=le+Math.imul(l,D)|0)+Math.imul(b,L)|0,be=be+Math.imul(b,D)|0,ue=ue+Math.imul(a,U)|0,le=(le=le+Math.imul(a,C)|0)+Math.imul(c,U)|0,be=be+Math.imul(c,C)|0;let ve=(me+(ue=ue+Math.imul(d,Y)|0)|0)+((8191&(le=(le=le+Math.imul(d,H)|0)+Math.imul(o,Y)|0))<<13)|0;me=((be=be+Math.imul(o,H)|0)+(le>>>13)|0)+(ve>>>26)|0,ve&=67108863,ue=Math.imul(v,k),le=(le=Math.imul(v,F))+Math.imul(y,k)|0,be=Math.imul(y,F),ue=ue+Math.imul(p,L)|0,le=(le=le+Math.imul(p,D)|0)+Math.imul(g,L)|0,be=be+Math.imul(g,D)|0,ue=ue+Math.imul(l,U)|0,le=(le=le+Math.imul(l,C)|0)+Math.imul(b,U)|0,be=be+Math.imul(b,C)|0,ue=ue+Math.imul(a,Y)|0,le=(le=le+Math.imul(a,H)|0)+Math.imul(c,Y)|0,be=be+Math.imul(c,H)|0;let ye=(me+(ue=ue+Math.imul(d,V)|0)|0)+((8191&(le=(le=le+Math.imul(d,$)|0)+Math.imul(o,V)|0))<<13)|0;me=((be=be+Math.imul(o,$)|0)+(le>>>13)|0)+(ye>>>26)|0,ye&=67108863,ue=Math.imul(S,k),le=(le=Math.imul(S,F))+Math.imul(I,k)|0,be=Math.imul(I,F),ue=ue+Math.imul(v,L)|0,le=(le=le+Math.imul(v,D)|0)+Math.imul(y,L)|0,be=be+Math.imul(y,D)|0,ue=ue+Math.imul(p,U)|0,le=(le=le+Math.imul(p,C)|0)+Math.imul(g,U)|0,be=be+Math.imul(g,C)|0,ue=ue+Math.imul(l,Y)|0,le=(le=le+Math.imul(l,H)|0)+Math.imul(b,Y)|0,be=be+Math.imul(b,H)|0,ue=ue+Math.imul(a,V)|0,le=(le=le+Math.imul(a,$)|0)+Math.imul(c,V)|0,be=be+Math.imul(c,$)|0;let Me=(me+(ue=ue+Math.imul(d,W)|0)|0)+((8191&(le=(le=le+Math.imul(d,Q)|0)+Math.imul(o,W)|0))<<13)|0;me=((be=be+Math.imul(o,Q)|0)+(le>>>13)|0)+(Me>>>26)|0,Me&=67108863,ue=Math.imul(E,k),le=(le=Math.imul(E,F))+Math.imul(A,k)|0,be=Math.imul(A,F),ue=ue+Math.imul(S,L)|0,le=(le=le+Math.imul(S,D)|0)+Math.imul(I,L)|0,be=be+Math.imul(I,D)|0,ue=ue+Math.imul(v,U)|0,le=(le=le+Math.imul(v,C)|0)+Math.imul(y,U)|0,be=be+Math.imul(y,C)|0,ue=ue+Math.imul(p,Y)|0,le=(le=le+Math.imul(p,H)|0)+Math.imul(g,Y)|0,be=be+Math.imul(g,H)|0,ue=ue+Math.imul(l,V)|0,le=(le=le+Math.imul(l,$)|0)+Math.imul(b,V)|0,be=be+Math.imul(b,$)|0,ue=ue+Math.imul(a,W)|0,le=(le=le+Math.imul(a,Q)|0)+Math.imul(c,W)|0,be=be+Math.imul(c,Q)|0;let Se=(me+(ue=ue+Math.imul(d,te)|0)|0)+((8191&(le=(le=le+Math.imul(d,re)|0)+Math.imul(o,te)|0))<<13)|0;me=((be=be+Math.imul(o,re)|0)+(le>>>13)|0)+(Se>>>26)|0,Se&=67108863,ue=Math.imul(q,k),le=(le=Math.imul(q,F))+Math.imul(N,k)|0,be=Math.imul(N,F),ue=ue+Math.imul(E,L)|0,le=(le=le+Math.imul(E,D)|0)+Math.imul(A,L)|0,be=be+Math.imul(A,D)|0,ue=ue+Math.imul(S,U)|0,le=(le=le+Math.imul(S,C)|0)+Math.imul(I,U)|0,be=be+Math.imul(I,C)|0,ue=ue+Math.imul(v,Y)|0,le=(le=le+Math.imul(v,H)|0)+Math.imul(y,Y)|0,be=be+Math.imul(y,H)|0,ue=ue+Math.imul(p,V)|0,le=(le=le+Math.imul(p,$)|0)+Math.imul(g,V)|0,be=be+Math.imul(g,$)|0,ue=ue+Math.imul(l,W)|0,le=(le=le+Math.imul(l,Q)|0)+Math.imul(b,W)|0,be=be+Math.imul(b,Q)|0,ue=ue+Math.imul(a,te)|0,le=(le=le+Math.imul(a,re)|0)+Math.imul(c,te)|0,be=be+Math.imul(c,re)|0;let Ie=(me+(ue=ue+Math.imul(d,ne)|0)|0)+((8191&(le=(le=le+Math.imul(d,se)|0)+Math.imul(o,ne)|0))<<13)|0;me=((be=be+Math.imul(o,se)|0)+(le>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,ue=Math.imul(O,k),le=(le=Math.imul(O,F))+Math.imul(B,k)|0,be=Math.imul(B,F),ue=ue+Math.imul(q,L)|0,le=(le=le+Math.imul(q,D)|0)+Math.imul(N,L)|0,be=be+Math.imul(N,D)|0,ue=ue+Math.imul(E,U)|0,le=(le=le+Math.imul(E,C)|0)+Math.imul(A,U)|0,be=be+Math.imul(A,C)|0,ue=ue+Math.imul(S,Y)|0,le=(le=le+Math.imul(S,H)|0)+Math.imul(I,Y)|0,be=be+Math.imul(I,H)|0,ue=ue+Math.imul(v,V)|0,le=(le=le+Math.imul(v,$)|0)+Math.imul(y,V)|0,be=be+Math.imul(y,$)|0,ue=ue+Math.imul(p,W)|0,le=(le=le+Math.imul(p,Q)|0)+Math.imul(g,W)|0,be=be+Math.imul(g,Q)|0,ue=ue+Math.imul(l,te)|0,le=(le=le+Math.imul(l,re)|0)+Math.imul(b,te)|0,be=be+Math.imul(b,re)|0,ue=ue+Math.imul(a,ne)|0,le=(le=le+Math.imul(a,se)|0)+Math.imul(c,ne)|0,be=be+Math.imul(c,se)|0;let _e=(me+(ue=ue+Math.imul(d,de)|0)|0)+((8191&(le=(le=le+Math.imul(d,oe)|0)+Math.imul(o,de)|0))<<13)|0;me=((be=be+Math.imul(o,oe)|0)+(le>>>13)|0)+(_e>>>26)|0,_e&=67108863,ue=Math.imul(R,k),le=(le=Math.imul(R,F))+Math.imul(P,k)|0,be=Math.imul(P,F),ue=ue+Math.imul(O,L)|0,le=(le=le+Math.imul(O,D)|0)+Math.imul(B,L)|0,be=be+Math.imul(B,D)|0,ue=ue+Math.imul(q,U)|0,le=(le=le+Math.imul(q,C)|0)+Math.imul(N,U)|0,be=be+Math.imul(N,C)|0,ue=ue+Math.imul(E,Y)|0,le=(le=le+Math.imul(E,H)|0)+Math.imul(A,Y)|0,be=be+Math.imul(A,H)|0,ue=ue+Math.imul(S,V)|0,le=(le=le+Math.imul(S,$)|0)+Math.imul(I,V)|0,be=be+Math.imul(I,$)|0,ue=ue+Math.imul(v,W)|0,le=(le=le+Math.imul(v,Q)|0)+Math.imul(y,W)|0,be=be+Math.imul(y,Q)|0,ue=ue+Math.imul(p,te)|0,le=(le=le+Math.imul(p,re)|0)+Math.imul(g,te)|0,be=be+Math.imul(g,re)|0,ue=ue+Math.imul(l,ne)|0,le=(le=le+Math.imul(l,se)|0)+Math.imul(b,ne)|0,be=be+Math.imul(b,se)|0,ue=ue+Math.imul(a,de)|0,le=(le=le+Math.imul(a,oe)|0)+Math.imul(c,de)|0,be=be+Math.imul(c,oe)|0;let Ee=(me+(ue=ue+Math.imul(d,ae)|0)|0)+((8191&(le=(le=le+Math.imul(d,ce)|0)+Math.imul(o,ae)|0))<<13)|0;me=((be=be+Math.imul(o,ce)|0)+(le>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,ue=Math.imul(R,L),le=(le=Math.imul(R,D))+Math.imul(P,L)|0,be=Math.imul(P,D),ue=ue+Math.imul(O,U)|0,le=(le=le+Math.imul(O,C)|0)+Math.imul(B,U)|0,be=be+Math.imul(B,C)|0,ue=ue+Math.imul(q,Y)|0,le=(le=le+Math.imul(q,H)|0)+Math.imul(N,Y)|0,be=be+Math.imul(N,H)|0,ue=ue+Math.imul(E,V)|0,le=(le=le+Math.imul(E,$)|0)+Math.imul(A,V)|0,be=be+Math.imul(A,$)|0,ue=ue+Math.imul(S,W)|0,le=(le=le+Math.imul(S,Q)|0)+Math.imul(I,W)|0,be=be+Math.imul(I,Q)|0,ue=ue+Math.imul(v,te)|0,le=(le=le+Math.imul(v,re)|0)+Math.imul(y,te)|0,be=be+Math.imul(y,re)|0,ue=ue+Math.imul(p,ne)|0,le=(le=le+Math.imul(p,se)|0)+Math.imul(g,ne)|0,be=be+Math.imul(g,se)|0,ue=ue+Math.imul(l,de)|0,le=(le=le+Math.imul(l,oe)|0)+Math.imul(b,de)|0,be=be+Math.imul(b,oe)|0;let Ae=(me+(ue=ue+Math.imul(a,ae)|0)|0)+((8191&(le=(le=le+Math.imul(a,ce)|0)+Math.imul(c,ae)|0))<<13)|0;me=((be=be+Math.imul(c,ce)|0)+(le>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,ue=Math.imul(R,U),le=(le=Math.imul(R,C))+Math.imul(P,U)|0,be=Math.imul(P,C),ue=ue+Math.imul(O,Y)|0,le=(le=le+Math.imul(O,H)|0)+Math.imul(B,Y)|0,be=be+Math.imul(B,H)|0,ue=ue+Math.imul(q,V)|0,le=(le=le+Math.imul(q,$)|0)+Math.imul(N,V)|0,be=be+Math.imul(N,$)|0,ue=ue+Math.imul(E,W)|0,le=(le=le+Math.imul(E,Q)|0)+Math.imul(A,W)|0,be=be+Math.imul(A,Q)|0,ue=ue+Math.imul(S,te)|0,le=(le=le+Math.imul(S,re)|0)+Math.imul(I,te)|0,be=be+Math.imul(I,re)|0,ue=ue+Math.imul(v,ne)|0,le=(le=le+Math.imul(v,se)|0)+Math.imul(y,ne)|0,be=be+Math.imul(y,se)|0,ue=ue+Math.imul(p,de)|0,le=(le=le+Math.imul(p,oe)|0)+Math.imul(g,de)|0,be=be+Math.imul(g,oe)|0;let xe=(me+(ue=ue+Math.imul(l,ae)|0)|0)+((8191&(le=(le=le+Math.imul(l,ce)|0)+Math.imul(b,ae)|0))<<13)|0;me=((be=be+Math.imul(b,ce)|0)+(le>>>13)|0)+(xe>>>26)|0,xe&=67108863,ue=Math.imul(R,Y),le=(le=Math.imul(R,H))+Math.imul(P,Y)|0,be=Math.imul(P,H),ue=ue+Math.imul(O,V)|0,le=(le=le+Math.imul(O,$)|0)+Math.imul(B,V)|0,be=be+Math.imul(B,$)|0,ue=ue+Math.imul(q,W)|0,le=(le=le+Math.imul(q,Q)|0)+Math.imul(N,W)|0,be=be+Math.imul(N,Q)|0,ue=ue+Math.imul(E,te)|0,le=(le=le+Math.imul(E,re)|0)+Math.imul(A,te)|0,be=be+Math.imul(A,re)|0,ue=ue+Math.imul(S,ne)|0,le=(le=le+Math.imul(S,se)|0)+Math.imul(I,ne)|0,be=be+Math.imul(I,se)|0,ue=ue+Math.imul(v,de)|0,le=(le=le+Math.imul(v,oe)|0)+Math.imul(y,de)|0,be=be+Math.imul(y,oe)|0;let qe=(me+(ue=ue+Math.imul(p,ae)|0)|0)+((8191&(le=(le=le+Math.imul(p,ce)|0)+Math.imul(g,ae)|0))<<13)|0;me=((be=be+Math.imul(g,ce)|0)+(le>>>13)|0)+(qe>>>26)|0,qe&=67108863,ue=Math.imul(R,V),le=(le=Math.imul(R,$))+Math.imul(P,V)|0,be=Math.imul(P,$),ue=ue+Math.imul(O,W)|0,le=(le=le+Math.imul(O,Q)|0)+Math.imul(B,W)|0,be=be+Math.imul(B,Q)|0,ue=ue+Math.imul(q,te)|0,le=(le=le+Math.imul(q,re)|0)+Math.imul(N,te)|0,be=be+Math.imul(N,re)|0,ue=ue+Math.imul(E,ne)|0,le=(le=le+Math.imul(E,se)|0)+Math.imul(A,ne)|0,be=be+Math.imul(A,se)|0,ue=ue+Math.imul(S,de)|0,le=(le=le+Math.imul(S,oe)|0)+Math.imul(I,de)|0,be=be+Math.imul(I,oe)|0;let Ne=(me+(ue=ue+Math.imul(v,ae)|0)|0)+((8191&(le=(le=le+Math.imul(v,ce)|0)+Math.imul(y,ae)|0))<<13)|0;me=((be=be+Math.imul(y,ce)|0)+(le>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,ue=Math.imul(R,W),le=(le=Math.imul(R,Q))+Math.imul(P,W)|0,be=Math.imul(P,Q),ue=ue+Math.imul(O,te)|0,le=(le=le+Math.imul(O,re)|0)+Math.imul(B,te)|0,be=be+Math.imul(B,re)|0,ue=ue+Math.imul(q,ne)|0,le=(le=le+Math.imul(q,se)|0)+Math.imul(N,ne)|0,be=be+Math.imul(N,se)|0,ue=ue+Math.imul(E,de)|0,le=(le=le+Math.imul(E,oe)|0)+Math.imul(A,de)|0,be=be+Math.imul(A,oe)|0;let ze=(me+(ue=ue+Math.imul(S,ae)|0)|0)+((8191&(le=(le=le+Math.imul(S,ce)|0)+Math.imul(I,ae)|0))<<13)|0;me=((be=be+Math.imul(I,ce)|0)+(le>>>13)|0)+(ze>>>26)|0,ze&=67108863,ue=Math.imul(R,te),le=(le=Math.imul(R,re))+Math.imul(P,te)|0,be=Math.imul(P,re),ue=ue+Math.imul(O,ne)|0,le=(le=le+Math.imul(O,se)|0)+Math.imul(B,ne)|0,be=be+Math.imul(B,se)|0,ue=ue+Math.imul(q,de)|0,le=(le=le+Math.imul(q,oe)|0)+Math.imul(N,de)|0,be=be+Math.imul(N,oe)|0;let Oe=(me+(ue=ue+Math.imul(E,ae)|0)|0)+((8191&(le=(le=le+Math.imul(E,ce)|0)+Math.imul(A,ae)|0))<<13)|0;me=((be=be+Math.imul(A,ce)|0)+(le>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,ue=Math.imul(R,ne),le=(le=Math.imul(R,se))+Math.imul(P,ne)|0,be=Math.imul(P,se),ue=ue+Math.imul(O,de)|0,le=(le=le+Math.imul(O,oe)|0)+Math.imul(B,de)|0,be=be+Math.imul(B,oe)|0;let Be=(me+(ue=ue+Math.imul(q,ae)|0)|0)+((8191&(le=(le=le+Math.imul(q,ce)|0)+Math.imul(N,ae)|0))<<13)|0;me=((be=be+Math.imul(N,ce)|0)+(le>>>13)|0)+(Be>>>26)|0,Be&=67108863,ue=Math.imul(R,de),le=(le=Math.imul(R,oe))+Math.imul(P,de)|0,be=Math.imul(P,oe);let je=(me+(ue=ue+Math.imul(O,ae)|0)|0)+((8191&(le=(le=le+Math.imul(O,ce)|0)+Math.imul(B,ae)|0))<<13)|0;me=((be=be+Math.imul(B,ce)|0)+(le>>>13)|0)+(je>>>26)|0,je&=67108863;let Re=(me+(ue=Math.imul(R,ae))|0)+((8191&(le=(le=Math.imul(R,ce))+Math.imul(P,ae)|0))<<13)|0;return me=((be=Math.imul(P,ce))+(le>>>13)|0)+(Re>>>26)|0,Re&=67108863,s[0]=pe,s[1]=ge,s[2]=we,s[3]=ve,s[4]=ye,s[5]=Me,s[6]=Se,s[7]=Ie,s[8]=_e,s[9]=Ee,s[10]=Ae,s[11]=xe,s[12]=qe,s[13]=Ne,s[14]=ze,s[15]=Oe,s[16]=Be,s[17]=je,s[18]=Re,0!==me&&(s[19]=me,r.length+=1),r}Math.imul||(Y=C),g.Red=A,i.exports=g}],["bcrypto","/lib/internal/custom-browser.js",function(e,t,r,i,n,s){"use strict";e.custom="inspect"}],["bcrypto","/lib/internal/asn1.js",function(e,t,r,i,n,s){"use strict";const f=o(14,r),d=o(10,r);function h(e,t,r){if(f(null!=e&&!0===e._isBuffer),f(t>>>0===t),f("boolean"==typeof r),t>=e.length)throw new Error("Invalid size.");const i=e[t],n=127&i;if(t+=1,0==(128&i))return[n,t];if(r&&0===n)throw new Error("Indefinite length.");let s=0;for(let i=0;i<n;i++){f(t<e.length);const i=e[t];if(t+=1,s>=1<<24)throw new Error("Length too large.");if(s*=256,s+=i,r&&0===s)throw new Error("Unexpected leading zeroes.")}if(r&&s<128)throw new Error("Non-minimal length.");return[s,t]}function a(e,t,r=!0){if(f(null!=e&&!0===e._isBuffer),f(t>>>0===t),f("boolean"==typeof r),t>=e.length||2!==e[t])throw new Error("Invalid integer tag.");let i;if(t+=1,[i,t]=h(e,t,r),t+i>e.length)throw new Error("Integer body out of bounds.");if(r){if(0===i)throw new Error("Zero length integer.");if(128&e[t])throw new Error("Integers must be positive.");if(i>1&&0===e[t]&&0==(128&e[t+1]))throw new Error("Unexpected leading zeroes.")}for(;i>0&&0===e[t];)t+=1,i-=1;if(i>2048)throw new Error("Invalid integer size.");return[d.decode(e.slice(t,t+i)),t+=i]}function c(e){return f(e>>>0===e),e<=127?1:e<=255?2:(f(e<=65535),3)}function u(e,t,r){return f(null!=e&&!0===e._isBuffer),f(t>>>0===t),f(r>>>0===r),r<=127?e[t++]=r:r<=255?(e[t++]=129,e[t++]=r):(f(r<=65535),e[t++]=130,e[t++]=r>>8,e[t++]=255&r),f(t<=e.length),t}e.readSize=h,e.readSeq=function(e,t,r=!0){if(f(null!=e&&!0===e._isBuffer),f(t>>>0===t),f("boolean"==typeof r),t>=e.length||48!==e[t])throw new Error("Invalid sequence tag.");let i;if(t+=1,[i,t]=h(e,t,r),r&&t+i!==e.length)throw new Error("Trailing bytes.");return t},e.readInt=a,e.readVersion=function(e,t,r,i=!0){let n;if(f(null!=e&&!0===e._isBuffer),f(t>>>0===t),f((255&r)===r),f("boolean"==typeof i),[n,t]=a(e,t,i),0!==n.cmpn(r))throw new Error("Invalid version.");return t},e.sizeSize=c,e.sizeSeq=function(e){return 1+c(e)+e},e.sizeInt=function(e){f(e instanceof d);const t=e.bitLength();let r=t+7>>>3;return t>0&&0==(7&t)&&(r+=e.testn(t-1)),0===t&&(r=1),1+c(r)+r},e.sizeVersion=function(e){return f((255&e)===e),3},e.writeSize=u,e.writeSeq=function(e,t,r){return f(null!=e&&!0===e._isBuffer),f(t>>>0===t),e[t++]=48,u(e,t,r)},e.writeInt=function(e,t,r){f(null!=e&&!0===e._isBuffer),f(t>>>0===t),f(r instanceof d);const i=r.bitLength();let n=i+7>>>3,s=0;return i>0&&0==(7&i)&&(s=r.testn(i-1)),0===i&&(n=1),e[t++]=2,t=u(e,t,s+n),s&&(e[t++]=0),0!==i?r.encode().copy(e,t):e[t]=0,f((t+=n)<=e.length),t},e.writeVersion=function(e,t,r){return f(null!=e&&!0===e._isBuffer),f(t>>>0===t),f((255&r)===r),f(t+3<=e.length),e[t++]=2,e[t++]=1,e[t++]=r,t}}],["bpkg","/lib/builtins/assert.js",function(e,r,i,n,s,f){"use strict";var d=o(15,i),h=o(16,i),a=h.isDeepEqual,c=h.isDeepStrictEqual,u={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},l={};function b(e){if("object"!=typeof e||null===e)throw new d.ArgError("options",e,"Object");var t=null,r="fail";null!=e.message&&(t=String(e.message)),"string"==typeof e.operator&&(r=e.operator),null==t&&(t="fail"===r?"Assertion failed.":u[r]+" "+d.stringify(e.actual)+" "+r+" "+d.stringify(e.expected)),Error.call(this,t);var i=b;"function"==typeof e.stackStartFn&&(i=e.stackStartFn),this.name="AssertionError [ERR_ASSERTION]",this.code="ERR_ASSERTION",this.message=t,this.generatedMessage=!e.message,this.actual=e.actual,this.expected=e.expected,this.operator=r,Error.captureStackTrace&&Error.captureStackTrace(this,i)}d.inherits(b,Error);var m=function e(t,r){g(e,arguments.length,t,r)};function p(e){if(e.message instanceof Error)throw e.message;throw new b(e)}function g(e,t,r,i){if(!r){var n=!1;if(0===t)n=!0,i="No value argument passed to `assert.ok()`";else if(null==i)n=!0,i="Assertion failed.";else if(i instanceof Error)throw i;var s=new b({actual:r,expected:!0,message:i,operator:"==",stackStartFn:e});throw s.generatedMessage=n,s}}function w(e,r,i){for(var n=0;n<r.length;n++){var s=r[n];s in e&&(i!==t&&"string"==typeof i[s]&&e[s]instanceof RegExp&&e[s].test(i[s])?this[s]=i[s]:this[s]=e[s])}}function v(e,t,r,i,n){if(!(r in e&&c(e[r],t[r]))){if(!i){var s=new b({actual:new w(e,n),expected:new w(t,n,e),operator:"deepStrictEqual",stackStartFn:m.throws});throw s.actual=e,s.expected=t,s.operator="throws",s}p({actual:e,expected:t,message:i,operator:"throws",stackStartFn:m.throws})}}function y(e,r,i){if("function"!=typeof r){if(r instanceof RegExp)return r.test(e);if(2===arguments.length)throw new d.ArgError("expected",r,["Function","RegExp"]);if("object"!=typeof e||null===e){var n=new b({actual:e,expected:r,message:i,operator:"deepStrictEqual",stackStartFn:m.throws});throw n.operator="throws",n}var s=d.getOwnKeys(r);if(r instanceof Error)s.push("name","message");else if(0===s.length)throw new d.ArgError("error",r,"may not be an empty object");for(var f=0;f<s.length;f++){var o=s[f];"string"==typeof e[o]&&r[o]instanceof RegExp&&r[o].test(e[o])||v(e,r,o,i,s)}return!0}return r.prototype!==t&&e instanceof r||!(r.prototype instanceof Error)&&!0===r.call({},e)}function M(e){if("function"!=typeof e)throw new d.ArgError("fn",e,"Function");try{e()}catch(e){return e}return l}function S(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch}function I(e){return new Promise(function(t,r){try{var i;if("function"==typeof e){if(!S(i=e()))throw new d.ArgError("promiseFn",i,"instance of Promise")}else{if(!S(e))throw new d.ArgError("promiseFn",e,["Function","Promise"]);i=e}i.then(function(){t(l)},t)}catch(e){t(e)}})}function _(e,r,i,n){if("string"==typeof i){if(4===arguments.length)throw new d.ArgError("error",i,["Object","Error","Function","RegExp"]);if("object"==typeof r&&null!==r){if(r.message===i)throw new d.NodeError("ERR_AMBIGUOUS_ARGUMENT",'The error message "'+r.message+'" is identical to the message.')}else if(r===i)throw new d.NodeError("ERR_AMBIGUOUS_ARGUMENT",'The error "'+r+'" is identical to the message.');n=i,i=t}else if(null!=i&&"object"!=typeof i&&"function"!=typeof i)throw new d.ArgError("error",i,["Object","Error","Function","RegExp"]);if(r===l){var s="";i&&i.name&&(s+=" ("+i.name+")"),s+=n?": "+n:".";var f="rejects"===e.name?"rejection":"exception";p({actual:t,expected:i,operator:e.name,message:"Missing expected "+f+s,stackStartFn:e})}if(i&&!1===y(r,i,n))throw r}function E(e,r,i,n){if(r!==l){if("string"==typeof i&&(n=i,i=t),!i||y(r,i)){var s=n?": "+n:".",f="doesNotReject"===e.name?"rejection":"exception";p({actual:r,expected:i,operator:e.name,message:"Got unwanted "+f+s+'\nActual message: "'+(r&&r.message)+'"',stackStartFn:e})}throw r}}m.AssertionError=b,m.ok=m,m.fail=function e(r,i,n,s,f){var d,o=arguments.length;if(0===o?d="Failed":1===o?(n=r,r=t):2===o&&(s="!="),n instanceof Error)throw n;var h={actual:r,expected:i,operator:s===t?"fail":s,stackStartFn:f||e};n!==t&&(h.message=n);var a=new b(h);throw d&&(a.message=d,a.generatedMessage=!0),a},m.equal=function e(t,r,i){t!=r&&p({actual:t,expected:r,message:i,operator:"==",stackStartFn:e})},m.notEqual=function e(t,r,i){t==r&&p({actual:t,expected:r,message:i,operator:"!=",stackStartFn:e})},m.deepEqual=function e(t,r,i){a(t,r)||p({actual:t,expected:r,message:i,operator:"deepEqual",stackStartFn:e})},m.notDeepEqual=function e(t,r,i){a(t,r)&&p({actual:t,expected:r,message:i,operator:"notDeepEqual",stackStartFn:e})},m.deepStrictEqual=function e(t,r,i){c(t,r)||p({actual:t,expected:r,message:i,operator:"deepStrictEqual",stackStartFn:e})},m.notDeepStrictEqual=function e(t,r,i){c(t,r)&&p({actual:t,expected:r,message:i,operator:"notDeepStrictEqual",stackStartFn:e})},m.strictEqual=function e(t,r,i){d.equals(t,r)||p({actual:t,expected:r,message:i,operator:"strictEqual",stackStartFn:e})},m.notStrictEqual=function e(t,r,i){d.equals(t,r)&&p({actual:t,expected:r,message:i,operator:"notStrictEqual",stackStartFn:e})},m.throws=function e(t,r,i){_(e,M(t),r,i)},m.rejects=function e(t,r,i){return new Promise(function(n,s){I(t).then(function(t){try{_(e,t,r,i)}catch(e){return void s(e)}n()})})},m.doesNotThrow=function e(t,r,i){E(e,M(t),r,i)},m.doesNotReject=function e(t,r,i){return new Promise(function(n,s){I(t).then(function(t){try{E(e,t,r,i)}catch(e){return void s(e)}n()})})},m.ifError=function e(r){if(null!==r&&r!==t){var i="ifError got unwanted exception: ";"object"==typeof r&&"string"==typeof r.message?0===r.message.length&&r.constructor?i+=r.constructor.name:i+=r.message:i+=d.stringify(r);var n=new b({actual:r,expected:null,operator:"ifError",message:i,stackStartFn:e}),s=r.stack;if("string"==typeof s){var f=s.split("\n");f.shift();for(var o=n.stack.split("\n"),h=0;h<f.length;h++){var a=o.indexOf(f[h]);if(-1!==a){o=o.slice(0,a);break}}n.stack=o.join("\n")+"\n"+f.join("\n")}throw n}},m.strict=d.assign(function e(t,r){g(e,arguments.length,t,r)},m,{equal:m.strictEqual,deepEqual:m.deepStrictEqual,notEqual:m.notStrictEqual,notDeepEqual:m.notDeepStrictEqual}),m.strict.strict=m.strict,i.exports=m}],["bpkg","/lib/builtins/internal/util.js",function(e,r,i,n,s,f){"use strict";var d="function"==typeof ArrayBuffer,o="function"==typeof SharedArrayBuffer,h="function"==typeof BigInt,a="function"==typeof Symbol,c="function"==typeof Float32Array,u="function"==typeof Float64Array,l="function"==typeof Map,b="function"==typeof Set,m=1==={__proto__:{a:1}}.a;function p(e){var t;try{t=e.name}catch(e){}return"string"!=typeof t||0===t.length?"Function":"Function: "+t}function g(e){if(Object.keys)return Object.keys(e);var t,r=[];for(t in e)y.call(e,t)&&r.push(t);return r}function w(e){return Object.getOwnPropertyNames?Object.getOwnPropertyNames(e):g(e)}function v(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]}function y(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function M(e){return!!(d&&e instanceof ArrayBuffer)||!!(o&&e instanceof SharedArrayBuffer)}function S(e){return Array.isArray?Array.isArray(e):e instanceof Array}function I(e){return h&&e instanceof BigInt}function _(e){return e instanceof Boolean}function E(e){return e instanceof Number}function A(e){return e instanceof String}function x(e){return a&&e instanceof Symbol}function q(e,t){if(Object.setPrototypeOf)return Object.setPrototypeOf(e,t),void Object.setPrototypeOf(e.prototype,t.prototype);if(m)return e.__proto__=t,void(e.prototype.__proto__=t.prototype);if(Object.create)e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});else{var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}function N(e,t){if(!Object.getOwnPropertyDescriptor)return y(e,t);var r=Object.getOwnPropertyDescriptor(e,t);return null!=r&&!0===r.enumerable}function z(e){return O(e).slice(8,-1)}function O(e){return e===t?"[object Undefined]":null===e?"[object Null]":Object.prototype.toString.call(e)}function B(e,t,r){var i;if(S(r)&&1===r.length&&(r=r[0]),S(r)){var n=r.pop();i='The "'+e+'" argument must be one of type '+r.join(", ")+", or "+n+". Received type "+typeof t}else i='The "'+e+'" argument must be of type '+r+". Received type "+typeof t;TypeError.call(this,i),this.name="TypeError [ERR_INVALID_ARG_TYPE]",this.code="ERR_INVALID_ARG_TYPE",this.message=i,Error.captureStackTrace&&Error.captureStackTrace(this,B)}function j(e,t){Error.call(this,t),this.name="Error ["+e+"]",this.code=e,this.message=t,Error.captureStackTrace&&Error.captureStackTrace(this,j)}q(B,TypeError),q(j,Error),e.assign=function(e){if(Object.assign)return Object.assign.apply(Object,arguments);for(var t=1;t<arguments.length;t++){var r=arguments[t];if(null!==r&&"object"==typeof r)for(var i=g(r),n=0;n<i.length;n++)e[i[n]]=r[i[n]]}return e},e.equals=function(e,t){return Object.is?Object.is(e,t):e===t?0!==e||1/e==1/t:e!=e&&t!=t},e.filter=function(e,t){if(e.filter)return e.filter(t);for(var r=[],i=0;i<e.length;i++)t(e[i])&&r.push(e[i]);return r},e.funcName=p,e.getOwnKeys=g,e.getOwnNonIndexProperties=function(e,t){var r,i,n,s=e.length>>>0===e.length,f=t?g(e):w(e),d=[];for(r=0;r<f.length;r++)i=f[r],s&&/^\d+$/.test(i)&&i>>>0<e.length||d.push(i);for(n=v(e),r=0;r<n.length;r++)i=n[r],t&&!N(e,i)||d.push(i);return d},e.getOwnPropertyNames=w,e.getOwnPropertySymbols=v,e.getPrototypeOf=function(e){return Object.getPrototypeOf?Object.getPrototypeOf(e):null==e?t:m?e.__proto__:e.constructor?e.constructor.prototype:t},e.hasOwnProperty=y,e.isAnyArrayBuffer=M,e.isArray=S,e.isArrayBufferView=function(e){return!!d&&null!=e&&(ArrayBuffer.isView?ArrayBuffer.isView(e):M(e.buffer))},e.isBigIntObject=I,e.isBooleanObject=_,e.isBoxedPrimitive=function(e){return null!==e&&"object"==typeof e&&(E(e)||A(e)||_(e)||I(e)||x(e))},e.isDate=function(e){return e instanceof Date},e.isFloat32Array=function(e){return c&&e instanceof Float32Array},e.isFloat64Array=function(e){return u&&e instanceof Float64Array},e.isMap=function(e){return l&&e instanceof Map},e.isNaN=function(e){return e!=e},e.isNumberObject=E,e.isRegExp=function(e){return e instanceof RegExp},e.isSet=function(e){return b&&e instanceof Set},e.isStringObject=A,e.isSymbolObject=x,e.inherits=q,e.propertyIsEnumerable=N,e.stringify=function(e){switch(typeof e){case"undefined":case"boolean":case"number":case"symbol":return String(e);case"bigint":return e+"n";case"string":return e.length>20&&(e=e.substring(0,17)+"..."),'"'+e+'"';case"object":return null===e?"null":"["+z(e)+"]";case"function":return"["+p(e)+"]";default:return"["+typeof e+"]"}},e.toName=z,e.toString=O,e.ArgError=B,e.NodeError=j}],["bpkg","/lib/builtins/internal/comparisons.js",function(e,r,i,n,s,f){"use strict";var d=o(15,i),h=!0,a=!1,c=0,u=1,l=2,b=3;function m(e,t,r,i){if(e===t)return 0!==e||(!r||d.equals(e,t));if(r){if("object"!=typeof e)return"number"==typeof e&&d.isNaN(e)&&d.isNaN(t);if("object"!=typeof t||null===e||null===t)return!1;if(d.getPrototypeOf(e)!==d.getPrototypeOf(t))return!1}else{if(null===e||"object"!=typeof e)return(null===t||"object"!=typeof t)&&e==t;if(null===t||"object"!=typeof t)return!1}var n,s,f,o,h,a,m=d.toString(e);if(m!==d.toString(t))return!1;if(d.isArray(e))return e.length===t.length&&(n=d.getOwnNonIndexProperties(e,!0),s=d.getOwnNonIndexProperties(t,!0),n.length===s.length&&p(e,t,r,i,u,n));if("[object Object]"===m)return p(e,t,r,i,c);if(d.isDate(e)){if(e.getTime()!==t.getTime())return!1}else if(d.isRegExp(e)){if(a=t,(h=e).source!==a.source||h.flags!==a.flags)return!1}else if(e instanceof Error){if(e.message!==t.message||e.name!==t.name)return!1}else{if(d.isArrayBufferView(e)){if(r||!d.isFloat32Array(e)&&!d.isFloat64Array(e)){if(!function(e,t){return e.byteLength===t.byteLength&&I(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}(e,t))return!1}else if(!function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e,t))return!1;return n=d.getOwnNonIndexProperties(e,!0),s=d.getOwnNonIndexProperties(t,!0),n.length===s.length&&p(e,t,r,i,c,n)}if(d.isSet(e))return!(!d.isSet(t)||e.size!==t.size)&&p(e,t,r,i,l);if(d.isMap(e))return!(!d.isMap(t)||e.size!==t.size)&&p(e,t,r,i,b);if(d.isAnyArrayBuffer(e)){if(o=t,(f=e).byteLength!==o.byteLength||!I(new Uint8Array(f),new Uint8Array(o)))return!1}else if(d.isBoxedPrimitive(e)&&!function(e,t){if(d.isNumberObject(e))return d.isNumberObject(t)&&d.equals(e,t);if(d.isStringObject(e))return d.isStringObject(t)&&e.valueOf()===t.valueOf();if(d.isBooleanObject(e))return d.isBooleanObject(t)&&e.valueOf()===t.valueOf();return d.isBigIntObject(e)?d.isBigIntObject(t)&&e.valueOf()===t.valueOf():d.isSymbolObject(t)&&e.valueOf()===t.valueOf()}(e,t))return!1}return p(e,t,r,i,c)}function p(e,r,i,n,s,f){if(5===arguments.length){f=d.getOwnKeys(e);var o=d.getOwnKeys(r);if(f.length!==o.length)return!1}for(var h=0;h<f.length;h++)if(!d.hasOwnProperty(r,f[h]))return!1;if(i&&5===arguments.length){var a,p=d.getOwnPropertySymbols(e);if(0!==p.length){var S=0;for(h=0;h<p.length;h++){var I=p[h];if(d.propertyIsEnumerable(e,I)){if(!d.propertyIsEnumerable(r,I))return!1;f.push(I),S++}else if(d.propertyIsEnumerable(r,I))return!1}if(a=d.getOwnPropertySymbols(r),p.length!==a.length&&g(r,a).length!==S)return!1}else if(0!==(a=d.getOwnPropertySymbols(r)).length&&0!==g(r,a).length)return!1}if(0===f.length&&(s===c||s===u&&0===e.length||0===e.size))return!0;if(n===t)n={val1:_(),val2:_(),position:0};else{var E=n.val1.get(e);if(E!==t){var A=n.val2.get(r);if(A!==t)return E===A}n.position++}n.val1.set(e,n.position),n.val2.set(r,n.position);var x=function(e,r,i,n,s,f){var o,h=0;if(f===l){if(!function(e,t,r,i){var n,s,f,d=null;for(n=e.keys();!(s=n.next()).done;)if("object"==typeof(f=s.value)&&null!==f)null===d&&(d=new Set),d.add(f);else if(!t.has(f)){if(r)return!1;if(!v(e,t,f))return!1;null===d&&(d=new Set),d.add(f)}if(null!==d){for(n=t.keys();!(s=n.next()).done;)if("object"==typeof(f=s.value)&&null!==f){if(!w(d,f,r,i))return!1}else if(!r&&!e.has(f)&&!w(d,f,r,i))return!1;return 0===d.size}return!0}(e,r,i,s))return!1}else if(f===b){if(!function(e,r,i,n){var s,f,d=null;for(s=e.entries();!(f=s.next()).done;){var o=f.value[0],h=f.value[1];if("object"==typeof o&&null!==o)null===d&&(d=new Set),d.add(o);else{var a=r.get(o);if(a===t&&!r.has(o)||!m(h,a,i,n)){if(i)return!1;if(!y(e,r,o,h,n))return!1;null===d&&(d=new Set),d.add(o)}}}if(null!==d){for(s=r.entries();!(f=s.next()).done;){var c=f.value[0],u=f.value[1];if("object"==typeof c&&null!==c){if(!M(d,e,c,u,i,n))return!1}else if(!(i||e.has(c)&&m(e.get(c),u,!1,n)||M(d,e,c,u,!1,n)))return!1}return 0===d.size}return!0}(e,r,i,s))return!1}else if(f===u)for(;h<e.length;h++){if(!d.hasOwnProperty(e,h)){if(d.hasOwnProperty(r,h))return!1;for(var a=d.getOwnKeys(e);h<a.length;h++)if(o=a[h],!d.hasOwnProperty(r,o)||!m(e[o],r[o],i,s))return!1;return a.length===d.getOwnKeys(r).length}if(!d.hasOwnProperty(r,h)||!m(e[h],r[h],i,s))return!1}for(h=0;h<n.length;h++)if(o=n[h],!m(e[o],r[o],i,s))return!1;return!0}(e,r,i,f,n,s);return n.val1.delete(e),n.val2.delete(r),x}function g(e,t){return d.filter(t,function(t){return d.propertyIsEnumerable(e,t)})}function w(e,t,r,i){for(var n=e.keys();;){var s=n.next();if(s.done)break;var f=s.value;if(m(t,f,r,i))return e.delete(f),!0}return!1}function v(e,t,r){var i=S(r);return null!=i?i:t.has(i)&&!e.has(i)}function y(e,r,i,n,s){var f=S(i);if(null!=f)return f;var d=r.get(f);return!(d===t&&!r.has(f)||!m(n,d,!1,s))&&(!e.has(f)&&m(n,d,!1,s))}function M(e,t,r,i,n,s){for(var f=e.keys();;){var d=f.next();if(d.done)break;var o=d.value;if(m(r,o,n,s)&&m(i,t.get(o),n,s))return e.delete(o),!0}return!1}function S(e){switch(typeof e){case"undefined":return null;case"object":return t;case"symbol":return!1;case"string":e=Number(e);case"number":if(d.isNaN(e))return!1}return!0}function I(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function _(){return"function"==typeof Map?new Map:new E}function E(){this.keys=[],this.values=[]}E.prototype.get=function(e){var r=this.keys.indexOf(e);return-1!==r?this.values[r]:t},E.prototype.set=function(e,t){var r=this.keys.indexOf(e);if(-1===r)return this.keys.push(e),void this.values.push(t);this.values[r]=t},E.prototype.delete=function(e){var t=this.keys.indexOf(e);-1!==t&&(this.keys.splice(t,1),this.values.splice(t,1))},e.isDeepEqual=function(e,t){return m(e,t,a)},e.isDeepStrictEqual=function(e,t){return m(e,t,h)}}],["bcrypto","/lib/js/schnorr-legacy.js",function(e,t,i,n,s,f){"use strict";const d=o(3,i),h=o(18,i),a=o(10,i);i.exports=class{constructor(e,t){this.curve=e,this.hash=t,this.rng=new h(this.curve,this.encode.bind(this))}check(){if(3!==this.curve.p.andln(3))throw new Error(`Schnorr is not supported for ${this.curve.id}.`)}encode(e){d(null!=e&&!0===e._isBuffer);const{fieldSize:t}=this.curve;if(e.length===1+t)return e;if(e.length!==1+2*t)throw new Error("Invalid point.");const i=r.alloc(1+t);return i[0]=2|1&e[e.length-1],e.copy(i,1,1,1+t),i}hashInt(...e){const t=new this.hash;t.init();for(const r of e)t.update(r);let r=t.final();return r.length>this.curve.scalarSize&&(r=r.slice(0,this.curve.scalarSize)),a.decode(r,this.curve.endian).imod(this.curve.n)}hashNonce(e,t){return this.hashInt(e,t)}hashChallenge(e,t,r){return this.hashInt(e,this.encode(t),r)}sign(e,t){return d(null!=e&&!0===e._isBuffer),this.check(),this._sign(e,t)}_sign(e,t){const{n:i}=this.curve,n=this.curve.g,s=this.curve.decodeScalar(t);if(s.isZero()||s.cmp(i)>=0)throw new Error("Invalid private key.");const f=n.mulBlind(s),d=this.hashNonce(t,e);if(d.isZero())throw new Error("Signing failed (k' = 0).");const o=n.mulBlind(d);o.isSquare()||d.ineg().imod(i);const h=o.encodeX(),a=f.encode(),c=this.hashChallenge(h,a,e),u=d.add(c.mul(s)).imod(i);return r.concat([h,this.curve.encodeScalar(u)])}verify(e,t,r){if(d(null!=e&&!0===e._isBuffer),d(null!=t&&!0===t._isBuffer),d(null!=r&&!0===r._isBuffer),this.check(),t.length!==this.curve.fieldSize+this.curve.scalarSize)return!1;try{return this._verify(e,t,r)}catch(e){return!1}}_verify(e,t,r){const{p:i,n:n}=this.curve,s=this.curve.g,f=t.slice(0,this.curve.fieldSize),d=t.slice(this.curve.fieldSize),o=this.curve.decodeField(f),h=this.curve.decodeScalar(d),a=this.curve.decodePoint(r);if(o.cmp(i)>=0||h.cmp(n)>=0)return!1;const c=this.hashChallenge(f,r,e),u=s.jmulAdd(h,a,c.ineg().imod(n));return!!u.isSquare()&&!!u.eqX(o)}verifyBatch(e){d(Array.isArray(e)),this.check();for(const t of e){d(Array.isArray(t)&&3===t.length);const[e,r,i]=t;if(d(null!=e&&!0===e._isBuffer),d(null!=r&&!0===r._isBuffer),d(null!=i&&!0===i._isBuffer),r.length!==this.curve.fieldSize+this.curve.scalarSize)return!1}try{return this._verifyBatch(e)}catch(e){return!1}}_verifyBatch(e){const{n:t}=this.curve,r=this.curve.g,i=new Array(1+2*e.length),n=new Array(1+2*e.length),s=new a(0);this.rng.init(e),i[0]=r,n[0]=s;for(let r=0;r<e.length;r++){const[f,d,o]=e[r],h=d.slice(0,this.curve.fieldSize),a=d.slice(this.curve.fieldSize),c=this.curve.decodeSquare(h),u=this.curve.decodeScalar(a),l=this.curve.decodePoint(o);if(u.cmp(t)>=0)return!1;const b=this.hashChallenge(h,o,f),m=this.rng.generate(r),p=b.mul(m).imod(t);s.iadd(u.mul(m)).imod(t),i[1+2*r+0]=c,n[1+2*r+0]=m,i[1+2*r+1]=l,n[1+2*r+1]=p}return s.ineg().imod(t),this.curve.jmulAll(i,n).isInfinity()}}}],["bcrypto","/lib/js/batch-rng.js",function(e,t,i,n,s,f){"use strict";const d=o(3,i),h=o(10,i),a=o(19,i),c=o(4,i);i.exports=class{constructor(e,t=(e=>e)){this.curve=e,this.encode=t,this.hash=new c,this.chacha=new a,this.key=r.alloc(32,0),this.iv=r.alloc(8,0),this.cache=[new h(1),new h(1)]}init(e){d(Array.isArray(e)),this.hash.init();for(const[t,r,i]of e)this.hash.update(c.digest(t)),this.hash.update(r),this.hash.update(this.encode(i));return this.key=this.hash.final(),this.cache[0]=new h(1),this.cache[1]=new h(1),this}encrypt(e){const t=2*this.curve.scalarSize,i=r.alloc(t,0),n=i.slice(0,this.curve.scalarSize),s=i.slice(this.curve.scalarSize);return this.chacha.init(this.key,this.iv,e),this.chacha.encrypt(i),[this.curve.decodeScalar(n),this.curve.decodeScalar(s)]}refresh(e){let t=0;for(;;){this.iv[4]=t,this.iv[5]=t>>>8,this.iv[6]=t>>>16,this.iv[7]=t>>>24,t+=1;const[r,i]=this.encrypt(e);if(!(r.isZero()||r.cmp(this.curve.n)>=0||i.isZero()||i.cmp(this.curve.n)>=0)){this.cache[0]=r,this.cache[1]=i;break}}}generate(e){return d(e>>>0===e),1&e&&this.refresh(e>>>1),this.cache[1&e]}}}],["bcrypto","/lib/chacha20-browser.js",function(e,t,r,i,n,s){"use strict";r.exports=o(20,r)}],["bcrypto","/lib/js/chacha20.js",function(e,t,i,n,s,f){"use strict";const d=o(3,i),h=0===new Int8Array(new Int16Array([1]).buffer)[0];class a{constructor(){this.state=new Uint32Array(16),this.stream=new Uint32Array(16),this.bytes=new Uint8Array(this.stream.buffer),this.pos=-1,h&&(this.bytes=r.alloc(64))}init(e,t,r){if(null==r&&(r=0),d(null!=e&&!0===e._isBuffer),d(null!=t&&!0===t._isBuffer),d(Number.isSafeInteger(r)),16!==e.length&&32!==e.length)throw new RangeError("Invalid key size.");if(t.length>=24&&(e=a.derive(e,t.slice(0,16)),t=t.slice(16)),this.state[0]=1634760805,this.state[1]=e.length<32?824206446:857760878,this.state[2]=e.length<32?2036477238:2036477234,this.state[3]=1797285236,this.state[4]=l(e,0),this.state[5]=l(e,4),this.state[6]=l(e,8),this.state[7]=l(e,12),this.state[8]=l(e,16%e.length),this.state[9]=l(e,20%e.length),this.state[10]=l(e,24%e.length),this.state[11]=l(e,28%e.length),this.state[12]=r>>>0,8===t.length)this.state[13]=r/4294967296>>>0,this.state[14]=l(t,0),this.state[15]=l(t,4);else if(12===t.length)this.state[13]=l(t,0),this.state[14]=l(t,4),this.state[15]=l(t,8);else{if(16!==t.length)throw new RangeError("Invalid nonce size.");this.state[12]=l(t,0),this.state[13]=l(t,4),this.state[14]=l(t,8),this.state[15]=l(t,12)}return this.pos=0,this}encrypt(e){if(d(null!=e&&!0===e._isBuffer),-1===this.pos)throw new Error("Context is not initialized.");for(let t=0;t<e.length;t++)0==(63&this.pos)&&(this._block(),this.pos=0),e[t]^=this.bytes[this.pos++];return e}_block(){for(let e=0;e<16;e++)this.stream[e]=this.state[e];for(let e=0;e<10;e++)c(this.stream,0,4,8,12),c(this.stream,1,5,9,13),c(this.stream,2,6,10,14),c(this.stream,3,7,11,15),c(this.stream,0,5,10,15),c(this.stream,1,6,11,12),c(this.stream,2,7,8,13),c(this.stream,3,4,9,14);for(let e=0;e<16;e++)this.stream[e]+=this.state[e];if(h)for(let e=0;e<16;e++)b(this.bytes,this.stream[e],4*e);this.state[12]+=1,0===this.state[12]&&(this.state[13]+=1)}destroy(){for(let e=0;e<16;e++)this.state[e]=0,this.stream[e]=0;if(h)for(let e=0;e<64;e++)this.bytes[e]=0;return this.pos=-1,this}static derive(e,t){if(d(null!=e&&!0===e._isBuffer),d(null!=t&&!0===t._isBuffer),16!==e.length&&32!==e.length)throw new RangeError("Invalid key size.");if(16!==t.length)throw new RangeError("Invalid nonce size.");const i=new Uint32Array(16);i[0]=1634760805,i[1]=e.length<32?824206446:857760878,i[2]=e.length<32?2036477238:2036477234,i[3]=1797285236,i[4]=l(e,0),i[5]=l(e,4),i[6]=l(e,8),i[7]=l(e,12),i[8]=l(e,16%e.length),i[9]=l(e,20%e.length),i[10]=l(e,24%e.length),i[11]=l(e,28%e.length),i[12]=l(t,0),i[13]=l(t,4),i[14]=l(t,8),i[15]=l(t,12);for(let e=0;e<10;e++)c(i,0,4,8,12),c(i,1,5,9,13),c(i,2,6,10,14),c(i,3,7,11,15),c(i,0,5,10,15),c(i,1,6,11,12),c(i,2,7,8,13),c(i,3,4,9,14);const n=r.alloc(32);return b(n,i[0],0),b(n,i[1],4),b(n,i[2],8),b(n,i[3],12),b(n,i[12],16),b(n,i[13],20),b(n,i[14],24),b(n,i[15],28),n}}function c(e,t,r,i,n){e[t]+=e[r],e[n]=u(e[n]^e[t],16),e[i]+=e[n],e[r]=u(e[r]^e[i],12),e[t]+=e[r],e[n]=u(e[n]^e[t],8),e[i]+=e[n],e[r]=u(e[r]^e[i],7)}function u(e,t){return e<<t|e>>>32-t}function l(e,t){return e[t++]+256*e[t++]+65536*e[t++]+16777216*e[t]}function b(e,t,r){return e[r++]=t,t>>>=8,e[r++]=t,t>>>=8,e[r++]=t,t>>>=8,e[r++]=t,r}a.native=0,i.exports=a}],["bcrypto","/lib/hmac-drbg-browser.js",function(e,t,r,i,n,s){"use strict";r.exports=o(22,r)}],["bcrypto","/lib/js/hmac-drbg.js",function(e,t,i,n,s,f){"use strict";const d=o(3,i),h=281474976710656,a=r.from([0]),c=r.from([1]);class u{constructor(e,t,i,n){d(e&&"string"==typeof e.id),this.hash=e,this.minEntropy="SHA1"===e.id?10:24,this.K=r.alloc(e.size),this.V=r.alloc(e.size),this.rounds=0,t&&this.init(t,i,n)}init(e,t,i){null==t&&(t=r.alloc(0)),null==i&&(i=r.alloc(0)),d(null!=e&&!0===e._isBuffer),d(null!=t&&!0===t._isBuffer),d(null!=i&&!0===i._isBuffer);for(let e=0;e<this.V.length;e++)this.K[e]=0,this.V[e]=1;const n=r.concat([e,t,i]);if(n.length<this.minEntropy)throw new Error("Not enough entropy.");return this.update(n),this.rounds=1,this}reseed(e,t){if(null==t&&(t=r.alloc(0)),d(null!=e&&!0===e._isBuffer),d(null!=t&&!0===t._isBuffer),0===this.rounds)throw new Error("DRBG not initialized.");const i=r.concat([e,t]);if(i.length<this.minEntropy)throw new Error("Not enough entropy.");return this.update(i),this.rounds=1,this}generate(e,t){if(d(e>>>0===e),d(null==t||null!=t&&!0===t._isBuffer),0===this.rounds)throw new Error("DRBG not initialized.");if(this.rounds>h)throw new Error("Reseed is required.");t&&t.length>0&&this.update(t);const i=Math.ceil(e/this.hash.size),n=r.alloc(i*this.hash.size);for(let e=0;e<i;e++)this.V=this.mac(this.V),this.V.copy(n,e*this.hash.size);return this.update(t),this.rounds+=1,n.slice(0,e)}randomBytes(e){return this.generate(e)}mac(e){return this.hash.mac(e,this.K)}hmac(){return this.hash.hmac().init(this.K)}update(e){d(null==e||null!=e&&!0===e._isBuffer);const t=this.hmac();if(t.update(this.V),t.update(a),e&&t.update(e),this.K=t.final(),this.V=this.mac(this.V),e&&e.length>0){const t=this.hmac();t.update(this.V),t.update(c),t.update(e),this.K=t.final(),this.V=this.mac(this.V)}return this}}u.native=0,i.exports=u}],["bcrypto","/lib/js/elliptic.js",function(e,i,n,s,f,d){"use strict";const{custom:h}=o(12,n),a=o(10,n),c={AFFINE:0,JACOBIAN:1,PROJECTIVE:2,EXTENDED:3},u=[-3,-1,-5,-7,0,7,5,1,3],l=!1;let b=0;class m{constructor(e,t,r){this.Point=null,this.id=null,this.uid=b++,this.ossl=null,this.type="base",this.endian="be",this.hash=null,this.prefix=null,this.context=!1,this.prime=null,this.p=null,this.red=null,this.fieldSize=0,this.fieldBits=0,this.adjustedSize=0,this.signBit=0,this.mask=0,this.n=null,this.h=null,this.q=null,this.z=null,this.g=null,this.nh=null,this.scalarSize=0,this.scalarBits=0,this.zero=null,this.one=null,this.two=null,this.three=null,this.four=null,this.i2=null,this.i3=null,this.i4=null,this.i6=null,this.torsion=null,this.endo=null,this.hi=null,this._init(e,t,r)}_init(e,t,i){J("function"==typeof e),J("string"==typeof t),J(i&&"object"==typeof i),J(null==i.red||i.red instanceof a.Red),J(null!=i.p,"Must pass a prime."),J(null==i.id||"string"==typeof i.id),J(null==i.ossl||"string"==typeof i.ossl),J(null==i.endian||"string"==typeof i.endian),J(null==i.hash||"string"==typeof i.hash),J(null==i.prefix||"string"==typeof i.prefix),J(null==i.context||"boolean"==typeof i.context),J(null==i.prime||"string"==typeof i.prime),J(null==i.torsion||Array.isArray(i.torsion)),this.Point=e,this.id=i.id||null,this.ossl=i.ossl||null,this.type=t,this.endian=i.endian||("short"===t?"be":"le"),this.hash=i.hash||null,this.prefix=i.prefix?r.from(i.prefix,"binary"):null,this.context=i.context||!1,this.prime=i.prime||null,this.p=a.fromJSON(i.p),i.red?this.red=i.red:(this.red=i.prime?a.red(i.prime):a.mont(this.p),this.red.precompute()),this.fieldSize=this.p.byteLength(),this.fieldBits=this.p.bitLength(),this.adjustedSize=this.fieldSize+(0==(7&this.fieldBits)),this.signBit=8*this.adjustedSize-1,this.mask=255,0!=(7&this.fieldBits)&&(this.mask=(1<<(7&this.fieldBits))-1),this.n=a.fromJSON(i.n||"0"),this.h=a.fromJSON(i.h||"1"),this.q=this.n.mul(this.h),this.z=a.fromJSON(i.z||"0").toRed(this.red),this.g=null,this.nh=this.n.ushrn(1),this.scalarSize=this.n.byteLength(),this.scalarBits=this.n.bitLength(),this.zero=new a(0).toRed(this.red),this.one=new a(1).toRed(this.red),this.two=new a(2).toRed(this.red),this.three=new a(3).toRed(this.red),this.four=new a(4).toRed(this.red),this.i2=this.two.redInvert(),this.i3=this.three.redInvert(),this.i4=this.i2.redSqr(),this.i6=this.i2.redMul(this.i3),this.torsion=new Array(this.h.word(0));for(let e=0;e<this.torsion.length;e++)this.torsion[e]=this.point();return this.endo=null,this.hi=null,this._scale=T(this._scale,this),this.isIsomorphic=T(this.isIsomorphic,this),this.isIsogenous=T(this.isIsogenous,this),J(this.p.sign()>0&&this.p.isOdd()),J(this.n.sign()>=0),J(this.h.sign()>0&&this.h.cmpn(255)<=0),J("be"===this.endian||"le"===this.endian),this}_finalize(e){if(J(e&&"object"==typeof e),this.g=e.g?this.pointFromJSON(e.g):this.point(),e.torsion){J(e.torsion.length===this.torsion.length);for(let t=0;t<this.torsion.length;t++)this.torsion[t]=this.pointFromJSON(e.torsion[t])}return this}_findTorsion(){J(!this.n.isZero());const e=this.h.word(0),t=this.one.redNeg(),r=[this.point()],i=new Set;let n=e;for(;r.length<n;){let e;t.redIAdd(this.one);try{e=this.pointFromX(t.clone())}catch(e){continue}try{e=e.mul(this.n)}catch(e){n=2;continue}if(!e.isInfinity()){e.normalize();for(const t of[e,e.neg()]){const e=t.key();i.has(e)||(r.push(t),i.add(e))}}}for(r.sort((e,t)=>e.cmp(t));r.length<e;)r.push(this.point());return r}_simpleMul(e,t){J(e instanceof p),J(t instanceof a),J(!t.red);const r=t.bitLength();t.isNeg()&&(e=e.neg());let i=this.jpoint();for(let n=r-1;n>=0;n--){const r=t.bit(n);i=i.dbl(),1===r&&(i=i.add(e))}return i}_simpleMulAdd(e,t){J(Array.isArray(e)),J(Array.isArray(t)),J(e.length===t.length);const r=e.length,i=new Array(r),n=t;let s=0;for(let n=0;n<r;n++){const r=e[n],f=t[n];if(J(r instanceof p),J(f instanceof a),J(!f.red),n>0&&r.type!==e[n-1].type)throw new Error("Cannot mix points.");i[n]=f.isNeg()?r.neg():r,s=Math.max(s,f.bitLength())}let f=this.jpoint();for(let e=s-1;e>=0;e--){f=f.dbl();for(let t=0;t<r;t++){const r=i[t];1===n[t].bit(e)&&(f=f.add(r))}}return f}_constMul(e,t,r){return J(e instanceof p),this.n.isZero()?this._simpleMul(e,t):"short"===this.type&&0===this.h.cmpn(1)?this._coZLadderMul(e,t):this._ladderMul(e,t)}_ladderMul(e,t){J(e instanceof p),J(t instanceof a),J(!t.red);const[r,i,n]=function(e,t){J(e instanceof a),J(t instanceof a);const r=e.abs().add(t),i=r.add(t),n=r.bitLength(),s=t.bitLength();r.cinject(i,n-s-1>>>31);const f=1&e.isNeg(),d=r.bitLength(),o=r.toArray("le");return[f,d,o]}(t,this.q);let s=e.toJ().clone(),f=this.jpoint().clone(),d=0;for(let e=i-1;e>=0;e--){const t=n[e>>3]>>(7&e)&1;s.swap(f,d^t),s=s.uadd(f),f=f.udbl(),d=t}return s.swap(f,d),f.swap(f.neg(),r),f}_coZLadderMul(e,t){J(e instanceof p),J(t instanceof a),J(!t.red);const r=e.toJ().clone(),[i,n,s,f]=function(e,t){J(e instanceof a),J(t instanceof a);const r=e.mod(t),i=t.sub(r),n=r.bitLength(),s=i.bitLength(),f=n-s>>>31;r.cinject(i,f);const d=r.bitLength(),o=r.toArray("le"),h=r.ceq(t.subn(1));return[f,d,o,h]}(t,this.n);let[d,o]=r.zdblu(),h=0;for(let e=n-2;e>=0;e--){const t=s[e>>3]>>(7&e)&1;d.swap(o,h^t),[d,o]=o.zaddc(d),[o,d]=d.zaddu(o),h=t}return d.swap(o,h),o.swap(r.neg(),f),o.swap(o.neg(),i),o}_fixedMul(e,t){J(e instanceof p),J(t instanceof a),J(e.pre&&e.pre.windows);const{width:r,bits:i,points:n}=e._getWindows(0,0),s=1<<r,f=(i+r-1)/r>>>0;let d=this.jpoint();for(let e=0;e<f;e++){const i=t.bits(e*r,r);d=d.add(n[e*s+i])}return t.isNeg()&&(d=d.neg()),d}_fixedNafMul(e,t){J(e instanceof p),J(t instanceof a),J(e.pre&&e.pre.doubles);const{step:r,points:i}=e._getDoubles(0,0),n=function(e,t,r,i){J(i>>>0===i);const n=R(e,t,r),s=Math.ceil(n.length/i),f=new Array(s);let d=0;for(let e=0;e<n.length;e+=i){let t=0;for(let r=e+i-1;r>=e;r--)t=(t<<1)+n[r];f[d++]=t}return J(d===s),f}(t,2,t.bitLength()+1,r),s=((1<<r+1)-(r%2==0?2:1))/3;let f=this.jpoint(),d=this.jpoint();for(let e=s;e>0;e--){for(let t=0;t<n.length;t++){const r=n[t];r===e?d=d.add(i[t]):r===-e&&(d=d.sub(i[t]))}f=f.add(d)}return f}_windowMul(e,t,r){J(e>>>0===e),J(t instanceof p),J(r instanceof a);const i=1<<e,n=(Math.max(r.bitLength(),this.n.bitLength())+e-1)/e>>>0,s=new Array(i),f=t.toJ();s[0]=this.jpoint(),s[1]=f;for(let e=2;e<i;e+=2)s[e+0]=s[e>>1].dbl(),s[e+1]=s[e].add(f);let d=this.jpoint();for(let t=n-1;t>=0;t--){const i=r.bits(t*e,e);d=t===n-1?s[i]:(d=d.dblp(e)).add(s[i])}return r.isNeg()&&(d=d.neg()),d}_slideMul(e,t,r){J(e>>>0===e),J(t instanceof p),J(r instanceof a);const i=1<<e-1,n=new Array(i),s=t.toJ();n[0]=s.dblp(e-1);for(let e=1;e<i;e++)n[e]=n[e-1].add(s);let f=r.bitLength(),d=this.jpoint();for(;f>=e;){const t=f-e,s=r.bits(t,e);s<i?(d=d.dbl(),f-=1):(d=(d=d.dblp(e)).add(n[s&~i]),f=t)}if(f>0){const e=r.bits(0,f);for(;f--;)d=d.dbl(),e>>f&1&&(d=d.add(t))}return r.isNeg()&&(d=d.neg()),d}_wnafMul(e,t,r){J(t instanceof p),J(r instanceof a);const{width:i,points:n}=t._safeNAF(e),s=R(r,i,r.bitLength()+1);let f=this.jpoint();for(let e=s.length-1;e>=0;e--){const t=s[e];e!==s.length-1&&(f=f.dbl()),t>0?f=f.add(n[t-1>>1]):t<0&&(f=f.sub(n[-t-1>>1]))}return f}_wnafMulAdd(e,t,r){J(e>>>0===e),J(Array.isArray(t)),J(Array.isArray(r)),J(t.length===r.length);const i=t.length,n=new Array(i),s=new Array(i);let f=0;for(let e=0;e<i;e++){const i=t[e],d=r[e];if(J(i instanceof p),J(d instanceof a),e>0&&i.type!==t[e-1].type)throw new Error("Cannot mix points.");n[e]=null,s[e]=null,f=Math.max(f,d.bitLength()+1)}let d=null,o=null,h=0;for(let e=0;e<i;e++){const i=t[e],a=r[e],c=i._getNAF(0);c?(n[h]=c.points,s[h]=R(a,c.width,f),h+=1):d?(n[h]=d._getJNAF(i),s[h]=P(o,a,f),d=null,o=null,h+=1):(d=i,o=a)}if(d){const t=d._safeNAF(e);n[h]=t.points,s[h]=R(o,t.width,f),h+=1}let c=this.jpoint();for(let e=f-1;e>=0;e--){e!==f-1&&(c=c.dbl());for(let t=0;t<h;t++){const r=s[t][e];r>0?c=c.add(n[t][r-1>>1]):r<0&&(c=c.sub(n[t][-r-1>>1]))}}return c}_endoWnafMulAdd(e,t){throw new Error("Not implemented.")}_scale(e,t){switch(J(e instanceof m),J(e.p.eq(this.p)),e.type){case"short":return this._scaleShort(e,t);case"mont":return this._scaleMont(e,t);case"edwards":return this._scaleEdwards(e,t);default:throw new Error("Not implemented.")}}_scaleShort(e,t){throw new Error("Not implemented.")}_scaleMont(e,t){throw new Error("Not implemented.")}_scaleEdwards(e,t){throw new Error("Not implemented.")}isElliptic(){throw new Error("Not implemented.")}jinv(){throw new Error("Not implemented.")}isComplete(){return!1}precompute(e){return J(!this.g.isInfinity(),"Must have base point."),J(!this.n.isZero(),"Must have order."),this.g.precompute(this.n.bitLength(),e),this}scalar(e,t,r){const i=new a(e,t,r);return J(!i.red),this.n.isZero()?i:i.imod(this.n)}field(e,t,r){const i=a.cast(e,t,r);return i.red?i.forceRed(this.red):i.toRed(this.red)}point(e,t){throw new Error("Not implemented.")}jpoint(e,t,r){throw new Error("Not implemented.")}xpoint(e,t){throw new Error("Not implemented.")}cpoint(e,t,r,i){if(J(e instanceof a),J(t instanceof a),J(r instanceof a),J(i instanceof a),t.isZero()||i.isZero())return this.point();const n=t.redMul(i).redInvert(),s=e.redMul(i).redMul(n),f=r.redMul(t).redMul(n);return this.point(s,f)}solveX2(e){throw new Error("Not implemented.")}solveX(e){return this.solveX2(e).redSqrt()}solveY2(e){throw new Error("Not implemented.")}solveY(e){return this.solveY2(e).redSqrt()}validate(e){throw new Error("Not implemented.")}pointFromX(e,t){throw new Error("Not implemented.")}pointFromY(e,t){throw new Error("Not implemented.")}isIsomorphic(e){throw new Error("Not implemented.")}isIsogenous(e){throw new Error("Not implemented.")}pointFromShort(e){throw new Error("Not implemented.")}pointFromMont(e,t){throw new Error("Not implemented.")}pointFromEdwards(e){throw new Error("Not implemented.")}pointFromUniform(e){throw new Error("Not implemented.")}pointToUniform(e){throw new Error("Not implemented.")}pointFromHash(e,t=!1){if(J(null!=e&&!0===e._isBuffer),J("boolean"==typeof t),e.length!==2*this.fieldSize)throw new Error("Invalid hash size.");const r=e.slice(0,this.fieldSize),i=e.slice(this.fieldSize),n=this.decodeUniform(r),s=this.decodeUniform(i),f=this.pointFromUniform(n),d=this.pointFromUniform(s),o=f.uadd(d);return t?o.mulH():o}pointToHash(e,t,i){J(e instanceof this.Point),J(t>>>0===t);const n=t%this.torsion.length,s=e.add(this.torsion[n]);for(;;){const e=this.randomField(i),t=this.pointFromUniform(e);if(t.neg().eq(t))continue;const n=s.usub(t),f=D(i);let d;try{d=this.pointToUniform(n,15&f)}catch(e){if("Invalid point."===e.message)continue;throw e}const o=this.encodeUniform(e,f>>>8),h=this.encodeUniform(d,f>>>16);return r.concat([o,h])}}randomScalar(e){const t=this.n.isZero()?this.p:this.n;return a.random(e,1,t)}randomField(e){return a.random(e,1,this.p).toRed(this.red)}randomPoint(e){let t;for(;;){const r=this.randomField(e),i=0!=(1&D(e));try{t=this.pointFromX(r,i)}catch(e){continue}return J(t.validate()),t.mulH()}}mulAll(e,t){return this.jmulAll(e,t)}mulAllSimple(e,t){return this.jmulAllSimple(e,t)}jmulAll(e,t){return J(Array.isArray(e)),J(0===e.length||e[0]instanceof p),this.endo&&e.length>0&&e[0].type===c.AFFINE?this._endoWnafMulAdd(e,t):this._wnafMulAdd(5,e,t)}jmulAllSimple(e,t){return this._simpleMulAdd(e,t)}mulH(e){return J(e instanceof a),this.imulH(e.clone())}imulH(e){J(e instanceof a),J(!e.red);const t=this.h.word(0);if(0==(t&t-1)){const t=this.h.bitLength();return e.iushln(t-1).imod(this.n)}return e.imuln(t).imod(this.n)}clamp(e){J(null!=e&&!0===e._isBuffer),J(e.length===this.scalarSize),J(this.scalarSize<=this.fieldSize);let t=7&this.fieldBits||8,r=0,i=this.scalarSize-1;return"be"===this.endian&&([r,i]=[i,r]),this.scalarSize<this.fieldSize&&(t=8),e[r]&=255&-this.h.word(0),e[i]&=(1<<t)-1,e[i]|=1<<t-1,e}splitHash(e){J(null!=e&&!0===e._isBuffer),J(e.length===2*this.adjustedSize),J(this.scalarSize<=this.adjustedSize);let t=0;"be"===this.endian&&(t=this.adjustedSize-this.scalarSize);const r=e.slice(t,t+this.scalarSize),i=e.slice(this.adjustedSize);return this.clamp(r),[r,i]}encodeField(e){return J(e instanceof a),J(!e.red),e.encode(this.endian,this.fieldSize)}decodeField(e){if(J(null!=e&&!0===e._isBuffer),e.length!==this.fieldSize)throw new Error("Invalid field element size.");return a.decode(e,this.endian)}encodeAdjusted(e){return J(e instanceof a),J(!e.red),e.encode(this.endian,this.adjustedSize)}decodeAdjusted(e){if(J(null!=e&&!0===e._isBuffer),e.length!==this.adjustedSize)throw new Error("Invalid field element size.");return a.decode(e,this.endian)}encodeScalar(e){return J(e instanceof a),J(!e.red),e.encode(this.endian,this.scalarSize)}decodeScalar(e){if(J(null!=e&&!0===e._isBuffer),e.length!==this.scalarSize)throw new Error("Invalid scalar size.");return a.decode(e,this.endian)}encodeClamped(e){return this.clamp(this.encodeScalar(e))}decodeClamped(e){if(J(null!=e&&!0===e._isBuffer),e.length!==this.scalarSize)throw new Error("Invalid scalar size.");const t=this.clamp(r.from(e));return a.decode(t,this.endian)}encodeUniform(e,t){J(e instanceof a),J(t>>>0===t);const r="le"===this.endian?this.fieldSize-1:0,i=e.fromRed().encode(this.endian,this.fieldSize);return i[r]|=t&~this.mask&255,i}decodeUniform(e){if(J(null!=e&&!0===e._isBuffer),e.length!==this.fieldSize)throw new Error("Invalid field size.");const t=a.decode(e,this.endian);return t.iumaskn(this.fieldBits),t.toRed(this.red)}encodePoint(e,t){return J(e instanceof p),e.encode(t)}decodePoint(e){throw new Error("Not implemented.")}encodeX(e){throw new Error("Not implemented.")}decodeX(e){throw new Error("Not implemented.")}decodeEven(e){throw new Error("Not implemented.")}decodeSquare(e){throw new Error("Not implemented.")}toShort(){throw new Error("Not implemented.")}toMont(e){throw new Error("Not implemented.")}toEdwards(e){throw new Error("Not implemented.")}pointToJSON(e,t){return J(e instanceof p),e.toJSON(t)}pointFromJSON(e){throw new Error("Not implemented.")}toJSON(e){let r,i,n,s,f;return"edwards"===this.type&&(r=this.prefix?this.prefix.toString():null,i=this.context),this.n.isZero()||(n=this.n.toJSON()),this.z.isZero()||(s=this.z.fromRed(),this.z.redIsHigh()&&s.isub(this.p),s=s.toString(16)),this.endo&&(f=this.endo.toJSON()),{id:this.id,ossl:this.ossl,type:this.type,endian:this.endian,hash:this.hash,prefix:r,context:i,prime:this.prime,p:this.p.toJSON(),a:t,b:t,d:t,n:n,h:this.h.toString(16),s:t,z:s,c:t,g:this.g.toJSON(e),endo:f}}static fromJSON(e){return new this(e)}}class p{constructor(e,t){J(e instanceof m),J(t>>>0===t),this.curve=e,this.type=t,this.pre=null}_init(){throw new Error("Not implemented.")}_getNAF(e){if(J(e>>>0===e),this.pre&&this.pre.naf)return this.pre.naf;if(0===e)return null;const t=1<<e-2,r=new Array(t),i=1===t?null:this.dbl();r[0]=this;for(let e=1;e<t;e++)r[e]=r[e-1].add(i);return new A(e,r)}_safeNAF(e){return this._getNAF(e)}_getWindows(e,t){if(J(e>>>0===e),J(t>>>0===t),this.pre&&this.pre.windows)return this.pre.windows;if(0===e)return null;const r=1<<e,i=(t+e-1)/e>>>0,n=new Array(i*r);let s=this.toP();for(let t=0;t<i;t++){n[t*r]=this.curve.point();for(let e=1;e<r;e++)n[t*r+e]=n[t*r+e-1].add(s);s=s.dblp(e)}return new x(e,t,n)}_getDoubles(e,t){if(J(e>>>0===e),J(t>>>0===t),this.pre&&this.pre.doubles)return this.pre.doubles;if(0===e)return null;const r=Math.ceil(t/e)+1,i=new Array(r);let n=this,s=0;i[s++]=n;for(let r=0;r<t;r+=e){for(let t=0;t<e;t++)n=n.dbl();i[s++]=n}return J(s===r),new q(e,i)}_getBeta(){return null}_getBlinding(e){if(this.pre&&this.pre.blinding)return this.pre.blinding;if(!e)return null;if(this.curve.n.isZero())return null;const t=this.curve.randomScalar(e),r=this.mul(t);return new N(t,r)}_hasWindows(e){if(J(e instanceof a),!this.pre||!this.pre.windows)return!1;const{bits:t}=this.pre.windows;return t>=e.bitLength()}_hasDoubles(e){if(J(e instanceof a),!this.pre||!this.pre.doubles)return!1;const{step:t,points:r}=this.pre.doubles,i=e.bitLength()+1;return r.length>=Math.ceil(i/t)+1}_getJNAF(e){return J(e instanceof p),J(e.type===this.type),[this,this.add(e),this.sub(e),e]}_blind(e,t){if(J(e instanceof a),J(!e.red),this.pre&&this.pre.blinding){const{blind:t,unblind:r}=this.pre.blinding;return[this,e.sub(t),r]}if(!t)return[this,e,null];if(this.pre){if(this.curve.n.isZero())return[this,e,null];return[this,this.curve.randomScalar(t).mul(this.curve.n).iadd(e),null]}return[this.randomize(t),e,null]}clone(){throw new Error("Not implemented.")}swap(e,t){throw new Error("Not implemented.")}precompute(e,t){return J(e>>>0===e),this.pre||(this.pre=new E),this.pre.naf||(this.pre.naf=this._getNAF(9)),l&&!this.pre.windows&&(this.pre.windows=this._getWindows(4,e)),this.pre.doubles||(this.pre.doubles=this._getDoubles(4,e+1)),this.pre.beta||(this.pre.beta=this._getBeta()),this.pre.blinding||(this.pre.blinding=this._getBlinding(t)),this}validate(){return this.curve.validate(this)}normalize(){return this}scale(e){throw new Error("Not implemented.")}randomize(e){const t=this.curve.randomField(e);return this.scale(t)}neg(){throw new Error("Not implemented.")}add(e){throw new Error("Not implemented.")}sub(e){return J(e instanceof p),this.add(e.neg())}dbl(){throw new Error("Not implemented.")}dblp(e){J(e>>>0===e);let t=this;for(let r=0;r<e;r++)t=t.dbl();return t}uadd(e){throw new Error("Not implemented.")}usub(e){return J(e instanceof p),this.uadd(e.neg())}udbl(){throw new Error("Not implemented.")}zaddu(e){throw new Error("Not implemented.")}zaddc(e){throw new Error("Not implemented.")}zdblu(){throw new Error("Not implemented.")}diffAdd(e,t){throw new Error("Not implemented.")}diffAddDbl(e,t){throw new Error("Not implemented.")}recover(){throw new Error("Not implemented.")}getX(){throw new Error("Not implemented.")}getY(){throw new Error("Not implemented.")}eq(e){throw new Error("Not implemented.")}cmp(e){throw new Error("Not implemented.")}isInfinity(){throw new Error("Not implemented.")}isOrder2(){throw new Error("Not implemented.")}isOdd(){throw new Error("Not implemented.")}isEven(){throw new Error("Not implemented.")}isSquare(){throw new Error("Not implemented.")}eqX(e){throw new Error("Not implemented.")}eqR(e){throw new Error("Not implemented.")}isSmall(){return!this.isInfinity()&&this.jmulH().isInfinity()}hasTorsion(){return!this.isInfinity()&&!this.jmul(this.curve.n).isInfinity()}order(){const{h:e,n:t}=this.curve;let r=this.toJ(),i=new a(1);for(;!r.isInfinity();){if(i.iaddn(1),i.cmp(e)>0){i=t.clone();break}r=r.add(this)}return i}mul(e){return this.jmul(e)}muln(e){return this.jmuln(e)}mulSimple(e){return this.jmulSimple(e)}mulBlind(e,t){return this.jmulBlind(e,t)}mulConst(e,t){return this.jmulConst(e,t)}mulAdd(e,t,r){return this.jmulAdd(e,t,r)}mulAddSimple(e,t,r){return this.jmulAddSimple(e,t,r)}mulH(){return this.jmulH()}div(e){return this.jdiv(e)}divn(e){return this.jdivn(e)}divH(){return this.jdivH()}jmul(e){return l&&this._hasWindows(e)?this.curve._fixedMul(this,e):this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo&&this.type===c.AFFINE?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(5,this,e)}jmuln(e){return J((0|e)===e),this.jmulSimple(new a(e))}jmulSimple(e){return this.curve._simpleMul(this,e)}jmulBlind(e,t=null){const[r,i,n]=this._blind(e,t),s=r.jmul(i);return n?s.add(n):s}jmulConst(e,t=null){const[r,i,n]=this._blind(e,t),s=this.curve._constMul(r,i,t);return n?s.uadd(n):s}jmulAdd(e,t,r){return this.curve.endo&&this.type===c.AFFINE?this.curve._endoWnafMulAdd([this,t],[e,r]):this.curve._wnafMulAdd(5,[this,t],[e,r])}jmulAddSimple(e,t,r){return this.curve._simpleMulAdd([this,t],[e,r])}jmulH(){const e=this.curve.h.word(0);if(0==(e&e-1)){const e=this.curve.h.bitLength();return this.toJ().dblp(e-1)}return this.jmulSimple(this.curve.h)}jdiv(e){return J(e instanceof a),J(!e.red),this.jmul(e.invert(this.curve.n))}jdivn(e){return J(!this.curve.n.isZero()),0===this.curve.h.cmpn(e)?this.jdivH():this.jdiv(new a(e))}jdivH(){return this.curve.n.isZero()?this.toJ():0===this.curve.h.cmpn(1)?this.toJ():(null===this.curve.hi&&(this.curve.hi=this.curve.h.invert(this.curve.n)),this.jmul(this.curve.hi))}ladder(e){throw new Error("Not implemented.")}ladderSimple(e){throw new Error("Not implemented.")}ladderBlind(e,t){throw new Error("Not implemented.")}ladderConst(e,t){throw new Error("Not implemented.")}toP(){return this.normalize()}toJ(){return this}toX(){return this}key(){if(this.isInfinity())return`${this.curve.uid}:oo`;this.normalize();const e=this.getX().toString(16),t=this.getY().toString(16);return`${this.curve.uid}:${e},${t}`}encode(e){throw new Error("Not implemented.")}static decode(e,t){throw new Error("Not implemented.")}encodeX(){throw new Error("Not implemented.")}static decodeX(e,t){throw new Error("Not implemented.")}static decodeEven(e,t){throw new Error("Not implemented.")}static decodeSquare(e,t){throw new Error("Not implemented.")}toJSON(e){throw new Error("Not implemented.")}static fromJSON(e,t){throw new Error("Not implemented.")}[h](){return"<Point>"}}class g extends m{constructor(e){super(w,"short",e),this.a=a.fromJSON(e.a).toRed(this.red),this.b=a.fromJSON(e.b).toRed(this.red),this.c=a.fromJSON(e.c||"0").toRed(this.red),this.ai=this.a.isZero()?this.zero:this.a.redInvert(),this.zi=this.z.isZero()?this.zero:this.z.redInvert(),this.zeroA=this.a.isZero(),this.threeA=this.a.eq(this.three.redNeg()),this.redN=this.n.toRed(this.red),this.pmodn=this.p.clone(),this.highOrder=this.n.cmp(this.p)>=0,this.smallGap=!1,this._finalize(e)}_finalize(e){return super._finalize(e),null!=e.endo?this.endo=z.fromJSON(this,e.endo):this.endo=this._getEndomorphism(),this.n.isZero()||(this.pmodn=this.p.mod(this.n),this.smallGap=this.p.div(this.n).cmpn(1)<=0),this}static _isomorphism(e,t,r,i){if(J(e instanceof a),J(t instanceof a),J(r instanceof a),J(null==i||"boolean"==typeof i),J(!e.isZero()||!t.isZero()),r.isZero())throw new Error("Invalid coefficient.");if(e.isZero()){const i=r;return J(1===L(i.redDiv(t)).redJacobi()),[e.clone(),i.clone()]}if(t.isZero()){const i=r,n=i.redDiv(e).redSqrt();if(1!==n.redJacobi()&&n.redINeg(),1!==n.redJacobi())throw new Error("Invalid `a` coefficient.");return[i.clone(),t.clone()]}const n=r,s=n.redDiv(e),f=s.redSqrt();if(null!=i?f.redIsOdd()!==i&&f.redINeg():1!==f.redJacobi()&&f.redINeg(),1!==f.redJacobi())throw new Error("Invalid `a` coefficient.");const d=s.redMul(f),o=e.redMul(s),h=t.redMul(d);return J(o.eq(n)),[o,h]}_short(e,t){return g._isomorphism(this.a,this.b,e,t)}_mont(e,t){const[r,i]=this._findRS(t),n=i.redInvert(),s=r.redMuln(3).redMul(n);return null!=e?y._isomorphism(s,n,e):[s,n]}_edwards(e,t){const[r,i]=this._findRS(t),n=r.redMuln(3),s=i.redMuln(2),f=n.redAdd(s),d=n.redSub(s);return null!=e?I._isomorphism(f,d,e):[f,d]}_findRS(e){J(null==e||"boolean"==typeof e),J(this.h.word(0)>=4),J(!this.n.isZero());const t=this.one.redNeg();let r;for(;;){t.redIAdd(this.one);try{r=this.pointFromX(t.clone())}catch(e){continue}if(!(r=r.mul(this.n)).isInfinity()&&r.y.isZero())break}const i=r.x,n=i.redSqr().redMuln(3).redIAdd(this.a).redSqrt();return null!=e&&n.redIsOdd()!==e&&n.redINeg(),[i,n]}_scale0(e,t){if(J(this.a.isZero()===e.isZero()),J(this.b.isZero()===t.isZero()),this.a.isZero()){const e=this.b.redDiv(this.field(t)),r=L(e),i=r.redSqrt(),n=r.redMul(i);return J(n.redSqr().eq(e)),J(!i.isZero()),[r,n]}if(this.b.isZero()){const t=this.a.redDiv(this.field(e)),r=t.redSqrt();1!==r.redJacobi()&&r.redINeg();const i=r.redSqrt(),n=r.redMul(i);return J(n.redMul(i).eq(t)),J(!i.isZero()),[r,n]}const r=this.a.redDiv(this.field(e)),i=this.b.redDiv(this.field(t)),n=r.redSqrt();r.redMul(n).eq(i)||n.redINeg(),J(r.redMul(n).eq(i));const s=n.redSqrt(),f=n.redMul(s);return J(!s.isZero()),[n,f]}_scale1(e,t){const r=this.g.x.redDiv(this.field(e)),i=this.g.y.redDiv(this.field(t)),n=r.redSqrt();return r.redMul(n).eq(i)||n.redINeg(),J(r.redMul(n).eq(i)),J(!n.isZero()),[r,i]}_scaleShort(e){return J(e instanceof g),this.g.isInfinity()||e.g.isInfinity()?this._scale0(e.a,e.b):this._scale1(e.g.x,e.g.y)}_scaleMont(e){if(J(e instanceof y),this.g.isInfinity()||e.g.isInfinity()){const[t,r]=e._short();return this._scale0(t,r)}const{x:t,y:r}=e.g,i=t.redAdd(e.a3).redMul(e.bi),n=r.redMul(e.bi);return this._scale1(i,n)}_scaleEdwards(e){if(J(e instanceof I),this.g.isInfinity()||e.g.isInfinity()){const[t,r]=e._short();return this._scale0(t,r)}const{x:t,y:r,z:i}=e.g,n=e.a.redMuln(5),s=e.d.redMuln(5),f=e.d.redSub(e.a),d=s.redSub(e.a),o=e.d.redSub(n),h=r.redAdd(i),a=r.redSub(i),c=d.redMul(r).redIAdd(o.redMul(i)),u=a.redMuln(12),l=f.redMul(h).redMul(i),b=a.redMul(t).redIMuln(4),m=u.redMul(b).redInvert(),p=c.redMul(b).redMul(m),g=l.redMul(u).redMul(m);return this._scale1(p,g)}_getEndomorphism(e=0){if(this.n.isZero()||this.g.isInfinity())return null;if(!this.zeroA||1!==this.p.modrn(3)||1!==this.n.modrn(3))return null;const[t,r]=this._getEndoRoots(this.p),i=[t,r][1&e].toRed(this.red),[n,s]=this._getEndoRoots(this.n),f=this.point(this.g.x.redMul(i),this.g.y);let d;this.g.mul(n).eq(f)?d=n:(J(this.g.mul(s).eq(f)),d=s);const o=this._getEndoBasis(d),h=this._getEndoPrecomp(o);return new z(i,d,o,h)}_getEndoRoots(e){const t=e===this.p?this.red:a.mont(e),r=new a(2).toRed(t),i=new a(3).toRed(t),n=r.redInvert(),s=i.redNeg().redSqrt().redMul(n),f=s.redNeg();return[s.redSub(n).fromRed(),f.redSub(n).fromRed()].sort(a.cmp)}_getEndoBasis(e){const[t,r,i,n,s,f]=this._egcdSqrt(e),d=i,o=n.neg(),h=t.sqr().iadd(r.sqr()),a=s.sqr().iadd(f.sqr());let c,u;return h.cmp(a)<=0?(c=t,u=r.neg()):(c=s,u=f.neg()),[new O(d,o),new O(c,u)]}_egcdSqrt(e){J(e instanceof a),J(!e.red),J(e.sign()>0),J(this.n.sign()>0);const t=this.n.ushrn(this.n.bitLength()>>>1);let r,i,n,s,f,d=e,o=this.n.clone(),h=new a(1),c=new a(0),u=new a(0),l=new a(1),b=0,m=0;for(;!d.isZero()&&b<2;){const e=o.quo(d),a=o.sub(e.mul(d)),p=u.sub(e.mul(h)),g=l.sub(e.mul(c));0===m&&a.cmp(t)<0&&(r=f,i=h,n=a,s=p,m=1),f=a,o=d,d=a,u=h,h=p,l=c,c=g,b+=m}return J(0!==m,"Could not find r < sqrt(n)."),[r,i,n,s,u,h]}_getEndoPrecomp(e){J(Array.isArray(e)),J(2===e.length),J(e[0]instanceof O),J(e[1]instanceof O);const[t,r]=e,i=t.a.mul(r.b).isub(t.b.mul(r.a)),n=i.bitLength()+16,s=a.shift(1,n),f=s.mul(r.b).divRound(i),d=s.mul(t.b).divRound(i);return J(i.eq(this.n)),[f,d]}_endoSplit(e){J(e instanceof a),J(!e.red),J(!this.n.isZero());const[t,r]=this.endo.basis,i=r.b.mul(e).divRound(this.n),n=t.b.neg().mul(e).divRound(this.n),s=i.mul(t.a),f=n.mul(r.a),d=i.ineg().mul(t.b),o=n.mul(r.b);return[e.sub(s).isub(f),d.isub(o)]}_endoBeta(e){return J(e instanceof w),[e,e._getBeta()]}_endoWnafMulAdd(e,t){J(Array.isArray(e)),J(Array.isArray(t)),J(e.length===t.length),J(null!=this.endo);const r=e.length,i=new Array(2*r),n=new Array(2*r);for(let s=0;s<r;s++){const[r,f]=this._endoBeta(e[s]),[d,o]=this._endoSplit(t[s]);i[2*s+0]=r,n[2*s+0]=d,i[2*s+1]=f,n[2*s+1]=o}return this._wnafMulAdd(5,i,n)}_icart(e){const{a:t,b:r,i3:i,one:n}=this,s=i.redSqr().redMul(i),f=this.p.ushln(1).isubn(1).idivn(3),d=e.clone();d.cinject(n,d.czero());const o=d.redSqr(),h=o.redSqr(),a=h.redMul(o),c=d.redMuln(6).redFermat(),u=t.redMuln(3).redISub(h).redMul(c),l=u.redSqr(),b=a.redMul(s),m=o.redMul(i),p=l.redISub(r).redISub(b).redPow(f).redIAdd(m),g=d.redMul(p).redIAdd(u);return this.point(p,g)}_sswu(e){const{b:t,z:r,ai:i,zi:n,one:s}=this,f=this.p.subn(2),d=r.redSqr(),o=t.redNeg().redMul(i),h=t.redMul(n).redMul(i),a=e.redSqr(),c=a.redSqr(),u=d.redMul(c).redIAdd(r.redMul(a)).redPow(f),l=o.redMul(s.redAdd(u));l.cinject(h,u.czero());const b=r.redMul(a).redMul(l),m=this.solveY2(l),p=this.solveY2(b),g=0|m.redIsSquare(),w=l.cinject(b,1^g),v=m.cinject(p,1^g).redSqrt();return v.cinject(v.redNeg(),v.redIsOdd()^e.redIsOdd()),this.point(w,v)}_sswui(e,t){const{a:r,b:i,z:n}=this,{x:s,y:f}=e,d=3&t,o=r.redSqr().redMul(s.redSqr()),h=r.redMul(i).redMul(s).redIMuln(2),a=i.redSqr().redMuln(3),c=r.redMul(s).redIAdd(i),[u,l]=k(o.redISub(h).redISub(a)),b=c.redSub(l).redINeg(),m=c.redAdd(l).redINeg(),p=c.redMul(n).redIMuln(2),g=i.redMul(n).redIMuln(2);b.cinject(m,1&d),p.cinject(g,d>>>1);const[w,v]=F(b,p);if(v.cinject(v.redNeg(),v.redIsOdd()^f.redIsOdd()),!(u&w))throw new Error("Invalid point.");return v}_svdwf(e){const{c:t,z:r,zi:i,i2:n,i3:s}=this,f=this.p.subn(2),d=this.solveY2(r),o=s.redMul(i.redSqr()),h=e.redSqr(),a=h.redSqr(),c=h.redAdd(d),u=h.redMul(c).redPow(f),l=a.redMul(u).redMul(t),b=c.redSqr().redMul(c),m=t.redSub(r).redMul(n).redISub(l),p=l.redSub(t.redAdd(r).redMul(n)),g=r.redSub(b.redMul(u).redMul(o)),w=this.solveY2(m),v=this.solveY2(p),y=this.solveY2(g),M=0|w.redIsSquare(),S=0|v.redIsSquare();return m.cinject(p,(1^M)&S),w.cinject(v,(1^M)&S),m.cinject(g,(1^M)&(1^S)),w.cinject(y,(1^M)&(1^S)),[m,w]}_svdw(e){const[t,r]=this._svdwf(e),i=r.redSqrt();return i.cinject(i.redNeg(),i.redIsOdd()^e.redIsOdd()),this.point(t,i)}_svdwi(e,t){const{b:r,c:i,z:n,two:s}=this,{x:f,y:d}=e,o=3&t,h=n.redSqr(),a=h.redMul(n),c=h.redSqr(),u=a.redAdd(r),l=u.redMuln(2),b=f.redSqr(),m=f.redMuln(2).redIAdd(n),p=f.redMul(h),g=i.redSub(m),w=i.redAdd(m),v=b.redMul(h).redIAdd(c).redIMuln(9),y=f.redMul(a).redIMuln(18),M=u.redMul(f.redSub(n)).redIMuln(12),[S,I]=k(v.redISub(y).redIAdd(M)),_=o-2>>>31|S,E=I.redMul(n),A=a.redISub(p).redIMuln(3).redISub(l),x=u.redMul(g),q=u.redMul(w),N=A.redAdd(E),z=A.redSub(E),O=s.clone();x.cinject(q,(1^o)-1>>>31),x.cinject(N,(2^o)-1>>>31),x.cinject(z,(3^o)-1>>>31),O.cinject(w,(0^o)-1>>>31),O.cinject(g,(1^o)-1>>>31);const[B,j]=F(x,O),[R]=this._svdwf(j),P=R.ceq(f);if(j.cinject(j.redNeg(),j.redIsOdd()^d.redIsOdd()),!(_&B&P))throw new Error("Invalid point.");return j}isElliptic(){const{a:e,b:t}=this,r=e.redSqr().redMul(e);return!t.redSqr().redMuln(27).redIAdd(r.redMuln(4)).isZero()}jinv(){const{a:e,b:t}=this,r=e.redSqr().redMul(e),i=t.redSqr(),n=r.redMuln(4),s=n.redMuln(1728),f=i.redMuln(27).redIAdd(n);if(f.isZero())throw new Error("Curve is not elliptic.");return s.redDiv(f).fromRed()}point(e,t,r=0){return new w(this,e,t,r)}jpoint(e,t,r){return new v(this,e,t,r)}solveX(e){if(J(e instanceof a),!this.a.isZero())throw new Error("Not implemented.");return Z(e.redSqr().redSub(this.b))}solveY2(e){J(e instanceof a);const t=e.redSqr().redMul(e).redIAdd(this.b);return this.zeroA||(this.threeA?t.redIAdd(e.redMuln(-3)):t.redIAdd(this.a.redMul(e))),t}validate(e){if(J(e instanceof w),e.inf)return!0;const{x:t,y:r}=e,i=this.solveY2(t);return r.redSqr().eq(i)}pointFromX(e,t=null){J(e instanceof a),J(null==t||"boolean"==typeof t),e.red||(e=e.toRed(this.red));const r=this.solveY(e);if(null!=t){if(this.h.cmpn(1)>0&&r.isZero()&&t)throw new Error("Invalid point.");r.redIsOdd()!==t&&r.redINeg()}return this.point(e,r)}pointFromY(e,t=0){J(e instanceof a),J(t>>>0===t),e.red||(e=e.toRed(this.red));const r=this.solveX(e);if(t>=r.length)throw new Error("Invalid X coordinate index.");const i=r[t];return this.point(i,e)}isIsomorphic(e){if(J(e instanceof m),!e.p.eq(this.p))return!1;let t,r;try{[t,r]=this._scale(e)}catch(e){return!1}if("short"===e.type){const i=this.field(e.a).redMul(t.redSqr()),n=this.field(e.b).redMul(r.redSqr());return this.a.eq(i)&&this.b.eq(n)}if("mont"===e.type){const{a3:r,bi:i}=e,n=this.field(r.redMul(i)).redMul(t);return this.solveY2(n).isZero()}if("edwards"===e.type){const r=this.field(e.ad6).redMul(t);return this.solveY2(r).isZero()}return!1}isIsogenous(e){return J(e instanceof m),!1}pointFromShort(e){if(J(e instanceof w),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const[t,r]=this._scale(e.curve),i=this.field(e.x),n=this.field(e.y),s=i.redMul(t),f=n.redMul(r);return this.point(s,f)}throw new Error("Not implemented.")}pointFromMont(e){if(J(e instanceof M),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const{a3:t,bi:r}=e.curve,[i,n]=this._scale(e.curve),s=e.x.redAdd(t).redMul(r),f=e.y.redMul(r);return this.point(this.field(s).redMul(i),this.field(f).redMul(n))}throw new Error("Not implemented.")}pointFromEdwards(e){if(J(e instanceof _),this.isIsomorphic(e.curve)){const{a:t,d:r,ad6:i}=e.curve,[n,s]=this._scale(e.curve);if(e.isInfinity())return this.point();if(e.x.isZero()){const e=this.field(i).redMul(n);return this.point(e,this.zero)}const{x:f,y:d,z:o}=e,h=t.redMuln(5),a=r.redMuln(5),c=r.redSub(t),u=a.redSub(t),l=r.redSub(h),b=d.redAdd(o),m=d.redSub(o),p=u.redMul(d).redIAdd(l.redMul(o)),g=m.redMuln(12),w=c.redMul(b).redMul(o),v=m.redMul(f).redIMuln(4);return this.cpoint(this.field(p).redMul(n),this.field(g),this.field(w).redMul(s),this.field(v))}throw new Error("Not implemented.")}pointFromUniform(e){if(J(e instanceof a),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(!this.a.isZero())return this._sswu(e);if(!this.c.isZero())return this._svdw(e);throw new Error("Not implemented.")}pointToUniform(e,t){if(J(e instanceof w),J(t>>>0===t),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(e.isInfinity())throw new Error("Invalid point.");const r=(t>>>4&15)%this.torsion.length,i=e.add(this.torsion[r]);if(!this.a.isZero())return this._sswui(i,t);if(!this.c.isZero())return this._svdwi(i,t);throw new Error("Not implemented.")}mulAll(e,t){return super.mulAll(e,t).toP()}mulAllSimple(e,t){return super.mulAllSimple(e,t).toP()}decodePoint(e){return w.decode(this,e)}encodeX(e){return J(e instanceof p),e.encodeX()}decodeEven(e){return w.decodeEven(this,e)}decodeSquare(e){return w.decodeSquare(this,e)}toShort(e,t,r=null){const[i,n]=this._short(e,t),s=new g({red:this.red,prime:this.prime,p:this.p,a:i,b:n,n:this.n,h:this.h});if(null!=r){const[,e]=s._scale(this);e.redIsOdd()!==r&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromShort(this.g));for(let e=0;e<this.h.word(0);e++)s.torsion[e]=s.pointFromShort(this.torsion[e]);return s}toMont(e,t,r=null){const[i,n]=this._mont(e,t),s=new y({red:this.red,prime:this.prime,p:this.p,a:i,b:n,n:this.n,h:this.h});if(null!=r){const[,e]=this._scale(s);e.redIsOdd()!==r&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromShort(this.g));for(let e=0;e<this.h.word(0);e++)s.torsion[e]=s.pointFromShort(this.torsion[e]);return s}toEdwards(e,t,r=null){const[i,n]=this._edwards(e,t),s=new I({red:this.red,prime:this.prime,p:this.p,a:i,d:n,n:this.n,h:this.h});if(null!=r){const[,e]=this._scale(s);e.redIsOdd()!==r&&e.redINeg()}if(this.g.isInfinity()||(s.g=s.pointFromShort(this.g),s.g.normalize()),s.isComplete())for(let e=0;e<this.h.word(0);e++)s.torsion[e]=s.pointFromShort(this.torsion[e]),s.torsion[e].normalize();return s}pointFromJSON(e){return w.fromJSON(this,e)}toJSON(e){const t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.b=this.b.fromRed().toJSON(),this.c.isZero()||(t.c=this.c.fromRed().toJSON()),t}}class w extends p{constructor(e,t,r,i){J(e instanceof g),super(e,c.AFFINE),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=1,null!=t&&this._init(t,r,i)}_init(e,t,r){J(e instanceof a),J(t instanceof a),this.x=e,this.y=t,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=0|r}_safeNAF(e){return J(e>>>0===e),this.pre&&this.pre.naf?this.pre.naf:e>1?this.toJ()._getNAF(e):this._getNAF(e)}_getBeta(){if(!this.curve.endo)return null;if(this.pre&&this.pre.beta)return this.pre.beta;const e=this.x.redMul(this.curve.endo.beta),t=this.curve.point(e,this.y);return this.pre&&(t.pre=this.pre.map(e=>{const t=e.x.redMul(this.curve.endo.beta);return this.curve.point(t,e.y)}),this.pre.beta=t),t}_getJNAF(e){if(J(e instanceof w),this.inf|e.inf)return super._getJNAF(e);const t=[this,null,null,e];return this.y.eq(e.y)?(t[1]=this.add(e),t[2]=this.toJ().sub(e)):this.y.eq(e.y.redNeg())?(t[1]=this.toJ().add(e),t[2]=this.sub(e)):(t[1]=this.toJ().add(e),t[2]=this.toJ().sub(e)),t}clone(){return this.curve.point(this.x.clone(),this.y.clone(),this.inf)}swap(e,t){J(e instanceof w);const r=1&(t>>31|-t>>31),i=this.inf,n=e.inf;return this.x.cswap(e.x,t),this.y.cswap(e.y,t),this.inf=i&(1^r)|n&r,e.inf=n&(1^r)|i&r,this}scale(e){return this.toJ().scale(e)}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(e){if(J(e instanceof w),this.inf)return e;if(e.inf)return this;if(this.x.eq(e.x))return this.y.eq(e.y)?this.dbl():this.curve.point();if(this.y.eq(e.y)){const t=this.x.redNeg().redISub(e.x),r=this.y.redNeg();return this.curve.point(t,r)}const t=this.x.redSub(e.x),r=this.y.redSub(e.y).redDiv(t),i=r.redSqr().redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();const e=this.x.redSqr().redIMuln(3).redIAdd(this.curve.a),t=this.y.redMuln(2),r=e.redDiv(t),i=r.redSqr().redISub(this.x).redISub(this.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)}dblp(e){return this.toJ().dblp(e).toP()}uadd(e){J(e instanceof w);const t=this.y.redAdd(e.y),r=this.x.redAdd(e.x).redSqr(),i=this.x.redMul(e.x),n=r.redISub(i).redIAdd(this.curve.a),s=t.czero()&n.czero();t.cinject(this.x.redSub(e.x),s),n.cinject(this.y.redSub(e.y),s);const f=t.czero()&(1^(this.inf|e.inf));t.cinject(this.curve.one,t.czero());const d=n.redMul(t.redFermat()),o=d.redSqr().redISub(this.x).redISub(e.x),h=d.redMul(this.x.redSub(o)).redISub(this.y),a=f|this.inf&e.inf;return o.cinject(e.x,this.inf),h.cinject(e.y,this.inf),o.cinject(this.x,e.inf),h.cinject(this.y,e.inf),o.cinject(this.curve.zero,a),h.cinject(this.curve.zero,a),this.curve.point(o,h,a)}udbl(){return this.uadd(this)}recover(e,t,r,i){if(J(e instanceof a),J(t instanceof a),J(r instanceof a),J(i instanceof a),this.inf)return this.curve.jpoint();const n=t.redMul(i),s=n.redSqr(),f=s.redMul(n),d=this.x.redMul(n),o=e.redMul(i),h=r.redMul(t),c=this.curve.b.redMul(f).redIMuln(2),u=d.redMul(o).redIAdd(this.curve.a.redMul(s)),l=d.redAdd(o),b=d.redISub(o),m=c.redIAdd(u.redMul(l)),p=h.redMul(b.redSqr()),g=m.redISub(p),w=this.y.redMul(f).redIMuln(2),v=e.redMul(w),y=g.redMul(t),M=t.redMul(w),S=v.redMul(M),I=y.redMul(M.redSqr()),_=M;return this.curve.jpoint(S,I,_)}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(e){return J(e instanceof w),this===e||(this.inf?0!==e.inf:!e.inf&&(this.x.eq(e.x)&&this.y.eq(e.y)))}cmp(e){return J(e instanceof w),this.inf&&!e.inf?-1:!this.inf&&e.inf?1:this.inf&&e.inf?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return 0!==this.inf}isOrder2(){return!this.inf&&this.y.isZero()}isOdd(){return!this.inf&&this.y.redIsOdd()}isEven(){return!this.inf&&this.y.redIsEven()}isSquare(){return!this.inf&&-1!==this.y.redJacobi()}eqX(e){return J(e instanceof a),J(!e.red),!this.inf&&this.getX().eq(e)}eqR(e){return J(e instanceof a),J(!e.red),J(!this.curve.n.isZero()),!this.inf&&this.getX().imod(this.curve.n).eq(e)}mul(e){return super.mul(e).toP()}muln(e){return super.muln(e).toP()}mulSimple(e){return super.mulSimple(e).toP()}mulBlind(e,t){return super.mulBlind(e,t).toP()}mulConst(e,t){return super.mulConst(e,t).toP()}mulAdd(e,t,r){return super.mulAdd(e,t,r).toP()}mulAddSimple(e,t,r){return super.mulAddSimple(e,t,r).toP()}mulH(){return super.mulH().toP()}div(e){return super.div(e).toP()}divn(e){return super.divn(e).toP()}divH(){return super.divH().toP()}toP(){return this}toJ(){return this.inf?this.curve.jpoint():this.curve.jpoint(this.x,this.y,this.curve.one)}encode(e){null==e&&(e=!0),J("boolean"==typeof e);const{fieldSize:t}=this.curve;if(this.inf)throw new Error("Invalid point.");if(e){const e=r.alloc(1+t),i=this.curve.encodeField(this.getX());return e[0]=2|this.y.redIsOdd(),i.copy(e,1),e}const i=r.alloc(1+2*t),n=this.curve.encodeField(this.getX()),s=this.curve.encodeField(this.getY());return i[0]=4,n.copy(i,1),s.copy(i,1+t),i}static decode(e,t){J(e instanceof g),J(null!=t&&!0===t._isBuffer);const r=e.fieldSize;if(t.length<1+r)throw new Error("Not a point.");const i=t[0];switch(i){case 2:case 3:{if(t.length!==1+r)throw new Error("Invalid point size for compressed.");const n=e.decodeField(t.slice(1,1+r));if(n.cmp(e.p)>=0)throw new Error("Invalid point.");const s=e.pointFromX(n,3===i);return J(!s.isInfinity()),s}case 4:case 6:case 7:{if(t.length!==1+2*r)throw new Error("Invalid point size for uncompressed.");const n=e.decodeField(t.slice(1,1+r)),s=e.decodeField(t.slice(1+r,1+2*r));if(n.cmp(e.p)>=0||s.cmp(e.p)>=0)throw new Error("Invalid point.");if(4!==i&&i!==(6|s.isOdd()))throw new Error("Invalid hybrid encoding.");const f=e.point(n,s);if(!f.validate())throw new Error("Invalid point.");return J(!f.isInfinity()),f}default:throw new Error("Unknown point format.")}}encodeX(){return this.curve.encodeField(this.getX())}static decodeEven(e,t){J(e instanceof g);const r=e.decodeField(t);if(r.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromX(r,!1)}static decodeSquare(e,t){J(e instanceof g);const r=e.decodeField(t);if(r.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromX(r)}toJSON(e){if(this.inf)return[];const t=this.getX().toJSON(),r=this.getY().toJSON();return!0===e&&this.pre?[t,r,this.pre.toJSON()]:[t,r]}toPretty(){if(this.inf)return[];const e=2*this.curve.fieldSize;return[U(this.getX(),e),U(this.getY(),e)]}static fromJSON(e,t){if(J(e instanceof g),J(Array.isArray(t)),J(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();const r=a.fromJSON(t[0]),i=a.fromJSON(t[1]),n=e.point(r,i);return t.length>2&&null!=t[2]&&(n.pre=E.fromJSON(n,t[2])),n}[h](){return this.inf?"<ShortPoint: Infinity>":"<ShortPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}class v extends p{constructor(e,t,r,i){J(e instanceof g),super(e,c.JACOBIAN),this.x=this.curve.one,this.y=this.curve.one,this.z=this.curve.zero,this.zOne=0,null!=t&&this._init(t,r,i)}_init(e,t,r){J(e instanceof a),J(t instanceof a),J(null==r||r instanceof a),this.x=e,this.y=t,this.z=r||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=0|this.z.eq(this.curve.one)}clone(){return this.curve.jpoint(this.x.clone(),this.y.clone(),this.z.clone())}swap(e,t){J(e instanceof v);const r=1&(t>>31|-t>>31),i=this.zOne,n=e.zOne;return this.x.cswap(e.x,t),this.y.cswap(e.y,t),this.z.cswap(e.z,t),this.zOne=i&(1^r)|n&r,e.zOne=n&(1^r)|i&r,this}validate(){const{a:e,b:t}=this.curve;if(this.isInfinity())return!0;if(this.zOne)return this.curve.validate(this.toP());const r=this.y.redSqr(),i=this.x.redSqr().redMul(this.x),n=this.z.redSqr(),s=n.redSqr(),f=s.redMul(n),d=i.redIAdd(t.redMul(f));return this.curve.zeroA||(this.curve.threeA?d.redIAdd(s.redIMuln(-3).redMul(this.x)):d.redIAdd(e.redMul(s).redMul(this.x))),r.eq(d)}normalize(){if(this.zOne)return this;if(this.isInfinity())return this;const e=this.z.redInvert(),t=e.redSqr();return this.x=this.x.redMul(t),this.y=this.y.redMul(t).redMul(e),this.z=this.curve.one,this.zOne=1,this}scale(e){if(J(e instanceof a),this.isInfinity())return this.curve.jpoint();const t=e.redSqr(),r=this.x.redMul(t),i=this.y.redMul(t).redMul(e),n=this.z.redMul(e);return this.curve.jpoint(r,i,n)}neg(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)}add(e){return J(e instanceof p),e.type===c.AFFINE?this._mixedAdd(e):this._add(e)}_add(e){return J(e instanceof v),this.isInfinity()?e:e.isInfinity()?this:this.zOne&&e.zOne?this._addAA(e):this.zOne?e._addJA(this):e.zOne?this._addJA(e):this._addJJ(e)}_mixedAdd(e){return J(e instanceof w),this.isInfinity()?e.toJ():e.isInfinity()?this:this.zOne?this._addAA(e):this._addJA(e)}_addJJ(e){const t=this.z.redSqr(),r=e.z.redSqr(),i=this.x.redMul(r),n=e.x.redMul(t),s=this.y.redMul(e.z).redMul(r),f=e.y.redMul(this.z).redMul(t),d=n.redISub(i),o=f.redISub(s);if(d.isZero())return o.isZero()?this.dbl():this.curve.jpoint();const h=d.redSqr(),a=d.redMul(h),c=i.redMul(h),u=o.redSqr().redISub(a).redISub(c).redISub(c),l=o.redMul(c.redISub(u)).redISub(s.redMul(a)),b=this.z.redMul(e.z).redMul(d);return this.curve.jpoint(u,l,b)}_addJA(e){const t=this.z.redSqr(),r=e.x.redMul(t),i=e.y.redMul(this.z).redMul(t),n=r.redISub(this.x),s=i.redISub(this.y).redIMuln(2);if(n.isZero())return s.isZero()?this.dbl():this.curve.jpoint();const f=n.redMuln(2).redSqr(),d=n.redMul(f),o=this.x.redMul(f),h=s.redSqr().redISub(d).redISub(o).redISub(o),a=s.redMul(o.redISub(h)).redISub(this.y.redMul(d).redIMuln(2)),c=this.z.redMul(n).redIMuln(2);return this.curve.jpoint(h,a,c)}_addAA(e){const t=e.x.redSub(this.x),r=e.y.redSub(this.y).redIMuln(2);if(t.isZero())return r.isZero()?this.dbl():this.curve.jpoint();const i=t.redSqr().redIMuln(4),n=t.redMul(i),s=this.x.redMul(i),f=r.redSqr().redISub(n).redISub(s).redISub(s),d=r.redMul(s.redISub(f)).redISub(this.y.redMul(n).redIMuln(2)),o=t.redIMuln(2);return this.curve.jpoint(f,d,o)}dbl(){return this.isInfinity()?this:this.y.isZero()?this.curve.jpoint():this.zOne?this._dblA():this.curve.zeroA?this._dbl0():this.curve.threeA?this._dbl3():this._dblJ()}_dblJ(){const e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),i=this.x.redMul(t).redIMuln(4),n=e.redIMuln(3).redIAdd(this.curve.a.redMul(r.redSqr())),s=n.redSqr().redISub(i).redISub(i),f=s,d=n.redMul(i.redISub(s)).redISub(t.redSqr().redIMuln(8)),o=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(f,d,o)}_dblA(){const e=this.x.redSqr(),t=this.y.redSqr(),r=t.redSqr(),i=t.redIAdd(this.x).redSqr().redISub(e).redISub(r).redIMuln(2),n=e.redIMuln(3).redIAdd(this.curve.a),s=n.redSqr().redISub(i).redISub(i),f=s,d=n.redMul(i.redISub(s)).redISub(r.redIMuln(8)),o=this.y.redMuln(2);return this.curve.jpoint(f,d,o)}_dbl0(){const e=this.x.redSqr(),t=this.y.redSqr(),r=t.redSqr(),i=t.redIAdd(this.x).redSqr().redISub(e).redISub(r).redIMuln(2),n=e.redIMuln(3),s=n.redSqr().redISub(i).redISub(i),f=n.redMul(i.redISub(s)).redISub(r.redIMuln(8)),d=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(s,f,d)}_dbl3(){const e=this.z.redSqr(),t=this.y.redSqr(),r=this.x.redMul(t),i=this.x.redSub(e),n=this.x.redAdd(e),s=i.redMul(n).redIMuln(3),f=r.redIMuln(4),d=f.redMuln(2),o=t.redSqr().redIMuln(8),h=s.redSqr().redISub(d),a=this.y.redAdd(this.z).redSqr().redISub(t).redISub(e),c=s.redMul(f.redISub(h)).redISub(o);return this.curve.jpoint(h,c,a)}dblp(e){return J(e>>>0===e),this.curve.zeroA||this.curve.threeA?super.dblp(e):0===e?this:this.isInfinity()?this:this._dblp(e)}_dblp(e){const{a:t,i2:r}=this.curve;let i=this.x,n=this.z,s=this.y.redMuln(2),f=n.redPown(4);for(let r=0;r<e;r++){if(s.isZero())return this.curve.jpoint();const d=i.redSqr(),o=s.redSqr(),h=o.redSqr(),a=d.redIMuln(3).redIAdd(t.redMul(f)),c=i.redMul(o),u=a.redSqr().redISub(c).redISub(c),l=u,b=a.redMul(c.redISub(u)).redIMuln(2).redISub(h),m=s.redMul(n);r+1<e&&(f=f.redMul(h)),i=l,s=b,n=m}return this.curve.jpoint(i,s.redMul(r),n)}uadd(e){return J(e instanceof p),e.type===c.AFFINE?this._uadd(e.toJ()):this._uadd(e)}_uadd(e){J(e instanceof v);const{zero:t,one:r}=this.curve,i=this.z.redSqr(),n=e.z.redSqr(),s=this.x.redMul(n),f=e.x.redMul(i),d=this.y.redMul(n).redMul(e.z),o=e.y.redMul(i).redMul(this.z),h=this.z.redMul(e.z),a=s.redAdd(f),c=d.redAdd(o),u=a.redSqr().redISub(s.redMul(f));if(!this.curve.zeroA){const e=h.redPown(4);this.curve.threeA?u.redIAdd(e.redIMuln(-3)):u.redIAdd(this.curve.a.redMul(e))}const l=c.czero()&u.czero();c.cinject(s.redSub(f),l),u.cinject(d.redSub(o),l);const b=c.redSqr(),m=a.redMul(b),p=b.redSqr();p.cinject(t,l);const g=u.redSqr(),w=h.redMul(c),y=m.redMuln(3).redISub(g).redISub(g),M=g.redISub(m).redIMuln(4),S=u.redMul(y).redISub(p).redIMuln(4),I=w.redIMuln(2),_=this.z.czero(),E=e.z.czero(),A=I.czero()&(1^(_|E));return M.cinject(e.x,_),S.cinject(e.y,_),I.cinject(e.z,_),M.cinject(this.x,E),S.cinject(this.y,E),I.cinject(this.z,E),M.cinject(r,A),S.cinject(r,A),I.cinject(t,A),this.curve.jpoint(M,S,I)}udbl(){const e=this._udbl(),t=this.z.czero()|this.y.czero();return e.x.cinject(this.curve.one,t),e.y.cinject(this.curve.one,t),e.z.cinject(this.curve.zero,t),e}_udbl(){return this.curve.zeroA?this._dbl0():this.curve.threeA?this._dbl3():this._dblJ()}zaddu(e){J(e instanceof v);const t=this.x.redSub(e.x),r=this.y.redSub(e.y),i=t.redSqr(),n=this.x.redMul(i),s=e.x.redMul(i),f=n,d=r.redSqr().redISub(n).redISub(s),o=this.y.redMul(n.redSub(s)),h=r.redMul(f.redSub(d)).redISub(o),a=this.z.redMul(t),c=a;return[this.curve.jpoint(d,h,c),this.curve.jpoint(f,o,a)]}zaddc(e){J(e instanceof v);const t=this.x.redSub(e.x),r=this.y.redSub(e.y),i=this.y.redAdd(e.y),n=t.redSqr(),s=this.x.redMul(n),f=e.x.redMul(n),d=i.redSqr().redISub(s).redISub(f),o=r.redSqr().redISub(s).redISub(f),h=this.y.redMul(f.redISub(s)),a=e.y.redMuln(2).redIAdd(r),c=s.redISub(d),u=d.redAdd(c).redISub(o),l=a.redMul(c).redIAdd(h),b=r.redMul(u).redIAdd(h),m=this.z.redMul(t),p=m;return[this.curve.jpoint(o,b,p),this.curve.jpoint(d,l,m)]}zdblu(){const e=this.x.redSqr(),t=this.y.redSqr(),r=t.redSqr(),i=this.x.redAdd(t).redSqr(),n=e.redMuln(3);if(!this.curve.zeroA){const e=this.z.redPown(4);this.curve.threeA?n.redIAdd(e.redIMuln(-3)):n.redIAdd(this.curve.a.redMul(e))}const s=i.redISub(e).redISub(r).redIMuln(2),f=n.redSqr().redISub(s).redISub(s),d=r.redIMuln(8),o=s.redSub(f).redMul(n).redISub(d),h=this.y.redMul(this.z).redIMuln(2),a=h;return[this.curve.jpoint(f,o,a),this.curve.jpoint(s,d,h)]}recover(e,t,r,i){return this.toP().recover(e,t,r,i)}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.y.fromRed()}eq(e){if(J(e instanceof v),this===e)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return!1;if(this.z.eq(e.z))return this.x.eq(e.x)&&this.y.eq(e.y);const t=this.z.redSqr(),r=e.z.redSqr(),i=this.x.redMul(r),n=e.x.redMul(t);if(!i.eq(n))return!1;const s=t.redMul(this.z),f=r.redMul(e.z),d=this.y.redMul(f),o=e.y.redMul(s);return d.eq(o)}cmp(e){J(e instanceof v);const t=this.isInfinity(),r=e.isInfinity();return t&&!r?-1:!t&&r?1:t&&r?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return this.z.isZero()}isOrder2(){return!this.isInfinity()&&this.y.isZero()}isOdd(){return!this.isInfinity()&&(this.normalize(),this.y.redIsOdd())}isEven(){return!this.isInfinity()&&(this.normalize(),this.y.redIsEven())}isSquare(){return!this.isInfinity()&&-1!==this.y.redMul(this.z).redJacobi()}eqX(e){if(J(e instanceof a),J(!e.red),this.isInfinity())return!1;const t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);return this.x.eq(r)}eqR(e){if(J(e instanceof a),J(!e.red),!this.curve.smallGap)return this.toP().eqR(e);if(this.isInfinity())return!1;if(e.cmp(this.curve.p)>=0)return!1;const t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(this.x.eq(r))return!0;if(this.curve.highOrder)return!1;if(e.cmp(this.curve.pmodn)>=0)return!1;const i=this.curve.redN.redMul(t);return r.redIAdd(i),this.x.eq(r)}toP(){return this.isInfinity()?this.curve.point():(this.normalize(),this.curve.point(this.x,this.y))}toJ(){return this}encode(e){return this.toP().encode(e)}static decode(e,t){return w.decode(e,t).toJ()}encodeX(){return this.toP().encodeX()}static decodeEven(e,t){return w.decodeEven(e,t).toJ()}static decodeSquare(e,t){return w.decodeSquare(e,t).toJ()}toJSON(e){return this.toP().toJSON(e)}toPretty(){return this.toP().toPretty()}static fromJSON(e,t){return w.fromJSON(e,t).toJ()}[h](){return this.isInfinity()?"<JPoint: Infinity>":"<JPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class y extends m{constructor(e){super(M,"mont",e),this.a=a.fromJSON(e.a).toRed(this.red),this.b=a.fromJSON(e.b).toRed(this.red),this.bi=this.b.redInvert(),this.a2=this.a.redAdd(this.two),this.a24=this.a2.redMul(this.i4),this.a3=this.a.redMul(this.i3),this.a0=this.a.redMul(this.bi),this.b0=this.bi.redSqr(),this._finalize(e)}static _isomorphism(e,t,r){J(e instanceof a),J(t instanceof a),J(r instanceof a);const i=e.clone(),n=r.clone();if(1!==t.redDiv(r).redJacobi())throw new Error("Invalid `b` coefficient.");return[i,n]}_short(e,t){const{a:r,b:i,three:n}=this,s=r.redSqr(),f=s.redMul(r),d=i.redSqr(),o=d.redMul(i),h=n.redSub(s),a=d.redMuln(3),c=f.redMuln(2).redISub(r.redMuln(9)),u=o.redMuln(27),l=h.redDiv(a),b=c.redDiv(u);return null!=e?g._isomorphism(l,b,e,t):[l,b]}_mont(e){return y._isomorphism(this.a,this.b,e)}_edwards(e,t=!1){J("boolean"==typeof t);const{two:r,bi:i}=this,n=this.a.redAdd(r).redMul(i),s=this.a.redSub(r).redMul(i);return t&&n.swap(s),null!=e?I._isomorphism(n,s,e):[n,s]}_scaleShort(e){J(e instanceof g);const[t,r]=e._scale(this);return[this.field(t.redInvert()),this.field(r.redInvert())]}_scaleMont(e){return J(e instanceof y),this.g.isInfinity()||e.g.isInfinity()?this.field(e.b).redDivSqrt(this.b):this.g.y.redDiv(this.field(e.g.y))}_scaleEdwards(e,t){J(e instanceof I);const r=e._scale(this,t);return this.field(r)}_solveY0(e){J(e instanceof a);const t=this.a0,r=this.b0,i=e.redSqr();return i.redMul(e).redIAdd(t.redMul(i)).redIAdd(r.redMul(e))}_elligator2(e){const t=this.a0.redNeg(),r=this.one.redAdd(this.z.redMul(e.redSqr()));r.cinject(this.one,r.czero());const i=t.redMul(r.redFermat()),n=i.redNeg().redISub(this.a0),s=this._solveY0(i),f=this._solveY0(n),d=0|s.redIsSquare(),o=i.cinject(n,1^d),h=s.cinject(f,1^d).redSqrt();h.cinject(h.redNeg(),h.redIsOdd()^e.redIsOdd());const a=this.b.redMul(o),c=this.b.redMul(h);return this.point(a,c)}_invert2(e,t){const{x:r,y:i}=e,n=1&t,s=r.redMul(this.bi),f=i.redMul(this.bi),d=s.redAdd(this.a0),o=s;d.cswap(o,n);const h=d.redINeg(),a=o.redMul(this.z),[c,u]=F(h,a);if(u.cinject(u.redNeg(),u.redIsOdd()^f.redIsOdd()),!c)throw new Error("Invalid point.");return u}_constMul(e,t,r){J(e instanceof M);const i=e.toX(),[n,s]=i.ladderConst(t,r),f=e.recover(n,s);return t.isNeg()?f.neg():f}isElliptic(){const e=this.a.redSqr();return!this.b.redMul(e.redSub(this.four)).isZero()}jinv(){const{a:e,three:t,four:r}=this,i=e.redSqr(),n=i.redSub(t).redPown(3).redIMuln(256),s=i.redSub(r);if(s.isZero())throw new Error("Curve is not elliptic.");return n.redDiv(s).fromRed()}point(e,t,r=0){return new M(this,e,t,r)}jpoint(e,t,r){return J(null==e&&null==t&&null==r),this.point()}xpoint(e,t){return new S(this,e,t)}solveY2(e){J(e instanceof a);const t=e.redSqr();return t.redMul(e).redIAdd(this.a.redMul(t)).redIAdd(e).redMul(this.bi)}validate(e){if(J(e instanceof M),e.isInfinity())return!0;const{x:t,y:r}=e,i=this.solveY2(t);return r.redSqr().eq(i)}pointFromX(e,t=null){J(e instanceof a),J(null==t||"boolean"==typeof t),e.red||(e=e.toRed(this.red));const r=this.solveY(e);if(null!=t){if(r.isZero()&&t)throw new Error("Invalid point.");r.redIsOdd()!==t&&r.redINeg()}return this.point(e,r)}isIsomorphic(e,t){if(J(e instanceof m),!e.p.eq(this.p))return!1;if("mont"===e.type){const t=this.field(e.a),r=this.field(e.b);return!!this.a.eq(t)&&(!this.b.isZero()&&1===r.redDiv(this.b).redJacobi())}return e.isIsomorphic(this,t)}isIsogenous(e){return J(e instanceof m),"mont"!==e.type&&e.isIsogenous(this)}pointFromShort(e){if(J(e instanceof w),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const{a3:t,b:r}=this,[i,n]=this._scale(e.curve),s=this.field(e.x).redMul(i),f=this.field(e.y).redMul(n),d=r.redMul(s).redISub(t),o=r.redMul(f);return this.point(d,o)}throw new Error("Not implemented.")}pointFromMont(e){if(J(e instanceof M),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const t=this._scale(e.curve),r=this.field(e.x),i=this.field(e.y),n=r,s=t.redMul(i);return this.point(n,s)}throw new Error("Not implemented.")}pointFromEdwards(e){J(e instanceof _),J(e.curve.p.eq(this.p));const t=this.field(e.x),r=this.field(e.y),i=this.field(e.z);if(this.isIsogenous(e.curve)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);const n=i.redSqr().redIMuln(2),s=r.redSqr(),f=t.redSqr(),d=n.redISub(f).redISub(s).redMul(r),o=f.redMul(t);return this.cpoint(s,f,d,o)}if(this.isIsomorphic(e.curve,!0)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);const n=this._scale(e.curve,!0),s=r.redAdd(i),f=r.redSub(i),d=n.redMul(i).redMul(s),o=t.redMul(f);return this.cpoint(s,f,d,o)}if(this.isIsomorphic(e.curve,!1)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);const n=this._scale(e.curve,!1),s=i.redAdd(r),f=i.redSub(r),d=n.redMul(i).redMul(s),o=t.redMul(f);return this.cpoint(s,f,d,o)}throw new Error("Not implemented.")}pointFromUniform(e){if(J(e instanceof a),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");return this._elligator2(e)}pointToUniform(e,t){if(J(e instanceof M),J(t>>>0===t),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");if(e.isInfinity())throw new Error("Invalid point.");const r=(t>>>4&15)%this.torsion.length,i=e.add(this.torsion[r]);return this._invert2(i,t)}decodePoint(e,t){return M.decode(this,e,t)}encodeX(e){return J(e instanceof S),e.encode()}decodeX(e){return S.decode(this,e)}toShort(e,t,r=null){const[i,n]=this._short(e,t),s=new g({red:this.red,prime:this.prime,p:this.p,a:i,b:n,n:this.n,h:this.h});if(null!=r){const[,e]=s._scale(this);e.redIsOdd()!==r&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromMont(this.g));for(let e=0;e<this.h.word(0);e++)s.torsion[e]=s.pointFromMont(this.torsion[e]);return s}toMont(e,t=null){const[r,i]=this._mont(e),n=new y({red:this.red,prime:this.prime,p:this.p,a:r,b:i,n:this.n,h:this.h,z:this.z});if(null!=t){const e=n._scale(this);e.redIsOdd()!==t&&e.redINeg()}this.g.isInfinity()||(n.g=n.pointFromMont(this.g));for(let e=0;e<this.h.word(0);e++)n.torsion[e]=n.pointFromMont(this.torsion[e]);return n}toEdwards(e,t,r=null){const[i,n]=this._edwards(e,t),s=new I({red:this.red,prime:this.prime,p:this.p,a:i,d:n,n:this.n,h:this.h,z:this.z});if(null!=r){const e=s._scale(this,t);e.redIsOdd()!==r&&e.redINeg()}if(this.g.isInfinity()||(s.g=s.pointFromMont(this.g),s.g.normalize()),s.isComplete())for(let e=0;e<this.h.word(0);e++)s.torsion[e]=s.pointFromMont(this.torsion[e]),s.torsion[e].normalize();return s}pointFromJSON(e){return M.fromJSON(this,e)}toJSON(e){const t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.b=this.b.fromRed().toJSON(),t}}class M extends p{constructor(e,t,r,i){J(e instanceof y),super(e,c.AFFINE),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=1,null!=t&&this._init(t,r,i)}_init(e,t,r){J(e instanceof a),J(t instanceof a),this.x=e,this.y=t,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=0|r}clone(){return this.curve.point(this.x.clone(),this.y.clone(),this.inf)}swap(e,t){J(e instanceof M);const r=1&(t>>31|-t>>31),i=this.inf,n=e.inf;return this.x.cswap(e.x,t),this.y.cswap(e.y,t),this.inf=i&(1^r)|n&r,e.inf=n&(1^r)|i&r,this}scale(e){return this.clone()}randomize(e){return this.clone()}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(e){if(J(e instanceof M),this.inf)return e;if(e.inf)return this;if(this.x.eq(e.x))return this.y.eq(e.y)?this.dbl():this.curve.point();const t=e.x.redSub(this.x),r=e.y.redSub(this.y).redDiv(t),i=this.curve.b.redMul(r.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();const e=this.x.redSqr().redIMuln(3),t=this.curve.a.redMul(this.x).redIMuln(2),r=e.redIAdd(t).redIAdd(this.curve.one),i=this.curve.b.redMul(this.y).redIMuln(2),n=r.redDiv(i),s=this.curve.b.redMul(n.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(this.x),f=n.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,f)}uadd(e){J(e instanceof M);const t=e.x.redSub(this.x),r=e.y.redSub(this.y),i=this.x.redSqr().redIMuln(3),n=this.curve.a.redMul(this.x).redIMuln(2),s=i.redIAdd(n).redIAdd(this.curve.one),f=this.curve.b.redMul(this.y).redIMuln(2),d=t.czero()&r.czero();r.cinject(s,d),t.cinject(f,d);const o=t.czero()&(1^(this.inf|e.inf));t.cinject(this.curve.one,t.czero());const h=r.redMul(t.redFermat()),a=this.curve.b.redMul(h.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(e.x),c=h.redMul(this.x.redSub(a)).redISub(this.y),u=o|this.inf&e.inf;return a.cinject(e.x,this.inf),c.cinject(e.y,this.inf),a.cinject(this.x,e.inf),c.cinject(this.y,e.inf),a.cinject(this.curve.zero,u),c.cinject(this.curve.zero,u),this.curve.point(a,c,u)}udbl(){return this.uadd(this)}recover(e,t){if(J(e instanceof S),J(t instanceof S),this.inf)return this.curve.point();const r=this.x.redMul(e.z),i=e.x.redAdd(r),n=e.x.redSub(r).redSqr().redMul(t.x),s=this.curve.a.redMul(e.z).redIMuln(2),f=i.redIAdd(s),d=this.x.redMul(e.x).redIAdd(e.z),o=f.redMul(d),h=s.redMul(e.z),a=o.redISub(h).redMul(t.z),c=this.curve.b.redMul(this.y).redIMuln(2).redMul(e.z).redMul(t.z),u=c.redMul(e.x),l=a.redISub(n),b=c.redMul(e.z);if(b.isZero())return this.curve.point();const m=b.redInvert(),p=u.redMul(m),g=l.redMul(m);return this.curve.point(p,g)}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(e){return J(e instanceof M),this===e||(this.inf?0!==e.inf:!e.inf&&(this.x.eq(e.x)&&this.y.eq(e.y)))}cmp(e){return J(e instanceof M),this.inf&&!e.inf?-1:!this.inf&&e.inf?1:this.inf&&e.inf?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return 0!==this.inf}isOrder2(){return!this.inf&&this.y.isZero()}isOdd(){return!this.inf&&this.y.redIsOdd()}isEven(){return!this.inf&&this.y.redIsEven()}toP(){return this}toJ(){return this}toX(){return this.inf?this.curve.xpoint():this.curve.xpoint(this.x,this.curve.one)}encode(){return this.toX().encode()}static decode(e,t,r){return J(e instanceof y),e.decodeX(t).toP(r)}toJSON(e){if(this.inf)return[];return[this.getX().toJSON(),this.getY().toJSON()]}toPretty(){if(this.inf)return[];const e=2*this.curve.fieldSize;return[U(this.getX(),e),U(this.getY(),e)]}static fromJSON(e,t){if(J(e instanceof y),J(Array.isArray(t)),J(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();const r=a.fromJSON(t[0]),i=a.fromJSON(t[1]);return e.point(r,i)}[h](){return this.inf?"<MontPoint: Infinity>":"<MontPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}class S extends p{constructor(e,t,r){J(e instanceof y),super(e,c.PROJECTIVE),this.x=this.curve.one,this.z=this.curve.zero,null!=t&&this._init(t,r)}_init(e,t){J(e instanceof a),J(null==t||t instanceof a),this.x=e,this.z=t||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red))}clone(){return this.curve.xpoint(this.x.clone(),this.z.clone())}swap(e,t){return J(e instanceof S),this.x.cswap(e.x,t),this.z.cswap(e.z,t),this}precompute(e,t){return this}validate(){if(this.isInfinity())return!0;const{x:e,z:t}=this,r=e.redSqr(),i=r.redMul(e),n=t.redSqr(),s=this.curve.a.redMul(r).redMul(t);return-1!==i.redIAdd(s).redIAdd(e.redMul(n)).redMul(this.curve.bi).redMul(t).redJacobi()}normalize(){return this.isInfinity()?this:this.z.eq(this.curve.one)?this:(this.x=this.x.redDiv(this.z),this.z=this.curve.one,this)}scale(e){if(J(e instanceof a),this.isInfinity())return this.curve.xpoint();const t=this.x.redMul(e),r=this.z.redMul(e);return this.curve.xpoint(t,r)}neg(){return this}dbl(){const e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),r=e.redSub(t),i=e.redMul(t),n=r.redMul(t.redIAdd(this.curve.a24.redMul(r)));return this.curve.xpoint(i,n)}diffAdd(e,t){J(e instanceof S),J(t instanceof S);const r=e.x.redAdd(e.z),i=e.x.redSub(e.z),n=t.x.redAdd(t.z),s=t.x.redSub(t.z).redMul(r),f=n.redMul(i),d=this.z.redMul(s.redAdd(f).redSqr()),o=this.x.redMul(s.redISub(f).redSqr());return this.curve.xpoint(d,o)}diffAddDbl(e,t){J(e instanceof S),J(t instanceof S);const r=e.x.redAdd(e.z),i=r.redSqr(),n=e.x.redSub(e.z),s=n.redSqr(),f=i.redSub(s),d=t.x.redAdd(t.z),o=t.x.redSub(t.z).redMul(r),h=d.redMul(n),a=this.z.redMul(o.redAdd(h).redSqr()),c=this.x.redMul(o.redISub(h).redSqr()),u=i.redMul(s),l=f.redMul(s.redIAdd(this.curve.a24.redMul(f)));return[this.curve.xpoint(u,l),this.curve.xpoint(a,c)]}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(e){return this.toP(e).getY()}eq(e){if(J(e instanceof S),this===e)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return!1;if(this.z.eq(e.z))return this.x.eq(e.x);const t=this.x.redMul(e.z),r=e.x.redMul(this.z);return t.eq(r)}cmp(e){J(e instanceof S);const t=this.isInfinity(),r=e.isInfinity();return t&&!r?-1:!t&&r?1:t&&r?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())}isInfinity(){return this.z.isZero()}isOrder2(){return!this.isInfinity()&&this.x.isZero()}isOdd(){return!1}isEven(){return!1}hasTorsion(){return!this.isInfinity()&&(!!this.x.isZero()||super.hasTorsion())}order(){try{return this.toP().order()}catch(e){return new a(1)}}jmul(e){return this.ladder(e)[0]}jmulSimple(e){return this.ladderSimple(e)[0]}jmulBlind(e,t){return this.ladderBlind(e,t)[0]}jmulConst(e,t){return this.ladderConst(e,t)[0]}jmulAdd(e,t,r){throw new Error("Not implemented.")}jmulAddSimple(e,t,r){throw new Error("Not implemented.")}ladder(e){J(e instanceof a),J(!e.red);const t=e.bitLength();let r=this.curve.xpoint(),i=this;for(let n=t-1;n>=0;n--){0===e.bit(n)?[r,i]=this.diffAddDbl(r,i):[i,r]=this.diffAddDbl(i,r)}return[r,i]}ladderSimple(e){J(e instanceof a),J(!e.red);const t=e.bitLength();let r=this.curve.xpoint(),i=this;for(let n=t-1;n>=0;n--){0===e.bit(n)?(i=this.diffAdd(i,r),r=r.dbl()):(r=this.diffAdd(r,i),i=i.dbl())}return[r,i]}ladderBlind(e,t){return t?this.randomize(t).ladder(e):this.ladder(e)}ladderConst(e,t){J(e instanceof a),J(!e.red);const r=Math.max(e.bitLength(),this.curve.fieldBits),i=r+7>>>3,n=e.toArray("le",i),s=t?this.randomize(t):this;let f=this.curve.xpoint().clone(),d=s.clone(),o=0;for(let e=r-1;e>=0;e--){const t=n[e>>3]>>(7&e)&1;f.swap(d,o^t),[f,d]=s.diffAddDbl(f,d),o=t}return f.swap(d,o),[f,d]}toP(e=null){return J(null==e||"boolean"==typeof e),this.isInfinity()?this.curve.point():(this.normalize(),this.curve.pointFromX(this.x,e))}toJ(){return this}toX(){return this}key(){if(this.isInfinity())return`${this.curve.uid}:oo`;this.normalize();const e=this.getX().toString(16);return`${this.curve.uid}:${e}`}encode(){return this.curve.encodeField(this.getX())}static decode(e,t){J(e instanceof y);const r=e.decodeField(t);r.iumaskn(e.fieldBits);const i=e.xpoint(r,e.one);return J(!i.isInfinity()),i}toJSON(e){return this.toP().toJSON(e)}toPretty(){return this.toP().toPretty()}static fromJSON(e,t){return M.fromJSON(e,t).toX()}[h](){return this.isInfinity()?"<XPoint: Infinity>":"<XPoint: x="+this.x.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class I extends m{constructor(e){super(_,"edwards",e),this.a=a.fromJSON(e.a).toRed(this.red),this.d=a.fromJSON(e.d).toRed(this.red),this.s=a.fromJSON(e.s||"0").toRed(this.red),this.si=this.s.isZero()?this.zero:this.s.redInvert(),this.k=this.d.redMuln(2),this.smi=-this.d.redNeg().word(0),this.ad6=this.a.redAdd(this.d).redMul(this.i6),this.twisted=!this.a.eq(this.one),this.oneA=this.a.eq(this.one),this.mOneA=this.a.eq(this.one.redNeg()),this.smallD=null!=this.prime&&1===this.d.redNeg().length,this.alt=null,this._finalize(e)}static _isomorphism(e,t,r){J(e instanceof a),J(t instanceof a),J(r instanceof a);const i=r.clone(),n=r.redMul(t).redDiv(e);if(1!==e.redDiv(r).redJacobi())throw new Error("Invalid `a` coefficient.");return[i,n]}_short(e,t){const{a:r,d:i}=this,n=r.redSqr(),s=n.redMul(r),f=i.redSqr(),d=f.redMul(i),o=r.redMul(i).redIMuln(14),h=n.redMul(i),a=r.redMul(f),c=h.redIAdd(a).redIMuln(33),u=n.redAdd(o).redIAdd(f).redDivn(-48),l=c.redISub(s).redISub(d).redDivn(864);return null!=e?g._isomorphism(u,l,e,t):[u,l]}_mont(e,t=!1){let r,i;J("boolean"==typeof t),t?(r=this.d.redAdd(this.a),i=this.d.redSub(this.a)):(r=this.a.redAdd(this.d),i=this.a.redSub(this.d));const n=i.redInvert(),s=r.redMuln(2).redMul(n),f=n.redMuln(4);return null!=e?y._isomorphism(s,f,e):[s,f]}_edwards(e){return I._isomorphism(this.a,this.d,e)}_scaleShort(e){J(e instanceof g);const[t,r]=e._scale(this);return[this.field(t.redInvert()),this.field(r.redInvert())]}_scaleMont(e,t=!1){if(J(e instanceof y),J("boolean"==typeof t),this.g.isInfinity()||e.g.isInfinity()){const[r]=e._edwards(null,t);return this.field(r).redDivSqrt(this.a)}const r=e.g.x.redDiv(e.g.y);return this.g.x.redDiv(this.field(r))}_scaleEdwards(e){return J(e instanceof I),this.g.isInfinity()||e.g.isInfinity()?this.field(e.a).redDivSqrt(this.a):this.g.x.redDiv(this.field(e.g.x))}_mulA(e){return J(e instanceof a),this.oneA?e.clone():this.mOneA?e.redNeg():this.a.redMul(e)}_mulD(e){return J(e instanceof a),this.smallD?e.redMuln(this.smi):this.d.redMul(e)}_elligator1(e){const{s:t,si:r,i2:i,one:n,two:s}=this,f=r.redSqr().redIMuln(2),d=t.redSqr().redMul(i),o=d.redSqr(),h=f.redAdd(d),a=h.redSqr().redISub(s),c=f.redSub(n),u=this.p.subn(2),l=this.p.subn(1).iushrn(1),b=this.p.addn(1).iushrn(2),m=n.redSub(e),p=n.redAdd(e),g=m.redMul(p.redPow(u)),w=g.redSqr(),v=w.redMul(g),y=v.redMul(w).redAdd(a.redMul(v)).redIAdd(g),M=y.redPow(l),S=w.redAdd(o).redPow(l),I=M.redMul(S),_=M.redMul(g),E=M.redMul(y).redPow(b).redMul(I),A=n.redAdd(_),x=h.redMul(_),q=A.redSqr(),N=c.redMul(t).redMul(_).redMul(A),z=E.cinject(this.one,g.czero()),O=x.redSub(q),B=x.redAdd(q);return this.cpoint(N,z,O,B)}_invert1(e,t){const{s:r,si:i,i2:n,one:s}=this,{x:f,y:d,z:o}=e,h=1&t,a=i.redSqr().redIMuln(2),c=r.redSqr().redMul(n),u=c.redSqr(),l=a.redAdd(c),b=a.redSub(s),m=this.p.subn(2),p=this.p.subn(1).iushrn(1),g=this.p.addn(1).iushrn(2),w=d.redSub(o),v=d.redAdd(o).redIMuln(2),y=w.redMul(v.redPow(m)),M=s.redAdd(y.redMul(l)),S=M.redSqr().redISub(s),I=S.redPow(g),_=I.redSqr().ceq(S),E=I.redSub(M),A=s.redAdd(E),x=b.redMul(r).redMul(E).redMul(A).redMul(f.redMul(o)),q=E.redSqr().redIAdd(u),N=x.redMul(q).redPow(p).redMul(E),z=s.redSub(N),O=s.redAdd(N),B=z.redMul(O.redPow(m));if(B.cinject(B.redNeg(),B.redIsOdd()^h),!_)throw new Error("Invalid point.");return B}_alt(){return this.alt||(this.alt=this.toMont()),this.alt}isElliptic(){const e=this.a.redMul(this.d),t=this.a.redSub(this.d);return!e.redMul(t).isZero()}jinv(){const{a:e,d:t}=this,r=e.redMul(t),i=e.redSub(t).redPown(4),n=e.redSqr(),s=t.redSqr(),f=n.redAdd(r.redMuln(14)).redIAdd(s).redPown(3).redIMuln(16),d=r.redMul(i);if(d.isZero())throw new Error("Curve is not elliptic.");return f.redDiv(d).fromRed()}isComplete(){return 1===this.a.redJacobi()&&-1===this.d.redJacobi()}point(e,t,r,i){return new _(this,e,t,r,i)}jpoint(e,t,r){return J(null==e&&null==t&&null==r),this.point()}cpoint(e,t,r,i){J(e instanceof a),J(t instanceof a),J(r instanceof a),J(i instanceof a);const n=e.redMul(i),s=r.redMul(t),f=t.redMul(i),d=e.redMul(r);return this.point(n,s,f,d)}solveX2(e){J(e instanceof a);const t=e.redSqr(),r=this._mulD(t).redISub(this.a);return t.redISub(this.one).redDiv(r)}solveX(e){const t=e.redSqr(),r=this._mulD(t).redISub(this.a);return t.redISub(this.one).redDivSqrt(r)}solveY2(e){J(e instanceof a);const t=e.redSqr(),r=this._mulA(t).redISub(this.one),i=this._mulD(t).redISub(this.one);return r.redDiv(i)}solveY(e){const t=e.redSqr(),r=this._mulA(t).redISub(this.one),i=this._mulD(t).redISub(this.one);return r.redDivSqrt(i)}validate(e){if(J(e instanceof _),e.zOne){const t=e.x.redSqr(),r=e.y.redSqr(),i=this._mulD(t).redMul(r),n=this._mulA(t).redIAdd(r),s=this.one.redAdd(i),f=e.t,d=e.x.redMul(e.y);return n.eq(s)&&f.eq(d)}const t=e.x.redSqr(),r=e.y.redSqr(),i=e.z.redSqr(),n=i.redSqr(),s=this._mulD(t).redMul(r),f=this._mulA(t).redIAdd(r).redMul(i),d=n.redIAdd(s),o=e.t.redMul(e.z),h=e.x.redMul(e.y);return f.eq(d)&&o.eq(h)}pointFromX(e,t=null){J(e instanceof a),J(null==t||"boolean"==typeof t),e.red||(e=e.toRed(this.red));const r=this.solveY(e);if(null!=t){if(r.isZero()&&t)throw new Error("Invalid point.");r.redIsOdd()!==t&&r.redINeg()}return this.point(e,r)}pointFromY(e,t=null){J(e instanceof a),J(null==t||"boolean"==typeof t),e.red||(e=e.toRed(this.red));const r=this.solveX(e);if(null!=t){if(r.isZero()&&t)throw new Error("Invalid point.");r.redIsOdd()!==t&&r.redINeg()}return this.point(r,e)}isIsomorphic(e,t=!1){if(J(e instanceof m),J("boolean"==typeof t),!e.p.eq(this.p))return!1;if("short"===e.type)return e.isIsomorphic(this);if("mont"===e.type){const r=this.field(e.a);let i,n;return t?(i=this.d.redAdd(this.a),n=this.d.redSub(this.a)):(i=this.a.redAdd(this.d),n=this.a.redSub(this.d)),r.redMul(n).eq(i.redIMuln(2))}if("edwards"===e.type){const t=this.field(e.a),r=this.field(e.d);return this.a.redMul(r).eq(t.redMul(this.d))}return!1}isIsogenous(e){if(J(e instanceof m),!e.p.eq(this.p))return!1;if("mont"===e.type){if(!this.a.eq(this.one))return!1;const t=this.field(e.a),r=this.field(e.b),i=this.two.redSub(this.d.redMuln(4));return t.eq(i)&&r.eq(this.one)}if("edwards"===e.type){const t=this.field(e.a),r=this.field(e.d);return t.eq(this.a.redNeg())&&r.eq(this.d.redSub(this.a))}return!1}pointFromShort(e){if(J(e instanceof w),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();if(e.y.isZero())return this.point(this.zero,this.one.redNeg());const{a:t,d:r}=this,[i,n]=this._scale(e.curve),s=t.redMuln(5),f=r.redMuln(5),d=this.field(e.x).redMul(i),o=this.field(e.y).redMul(n),h=d.redMuln(6),a=d.redMuln(12),c=h.redSub(t).redISub(r),u=o.redMuln(6),l=a.redSub(s).redIAdd(r),b=a.redAdd(t).redISub(f);return this.cpoint(c,u,l,b)}throw new Error("Not implemented.")}pointFromMont(e){J(e instanceof M),J(e.curve.p.eq(this.p));const t=this.field(e.x),r=this.field(e.y);if(this.isIsogenous(e.curve)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point();const i=t.redSqr(),n=i.redMul(t),s=n.redMul(t),f=s.redMul(t),d=r.redSqr(),o=r.redMuln(4),h=i.redSub(this.one),a=i.redMuln(2),c=d.redMuln(4),u=n.redIMuln(2),l=t.redMul(d).redIMuln(4),b=i.redMul(d).redIMuln(2),m=d.redIMuln(2),p=o.redMul(h),g=s.redISub(a).redIAdd(c).redIAdd(this.one),w=f.redSub(u).redISub(l).redIAdd(t).redINeg(),v=f.redISub(b).redISub(u).redISub(m).redIAdd(t);return this.cpoint(p,g,w,v).divn(4)}if(this.isIsomorphic(e.curve,!0)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.one.redNeg());const i=this._scale(e.curve,!0).redMul(t),n=r,s=t.redAdd(this.one),f=t.redSub(this.one);return this.cpoint(i,n,s,f)}if(this.isIsomorphic(e.curve,!1)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.one.redNeg());const i=this._scale(e.curve,!1).redMul(t),n=r,s=t.redSub(this.one),f=t.redAdd(this.one);return this.cpoint(i,n,s,f)}throw new Error("Not implemented.")}pointFromEdwards(e){J(e instanceof _),J(e.curve.p.eq(this.p));const t=this.field(e.curve.a),r=this.field(e.x),i=this.field(e.y),n=this.field(e.z),s=this.field(e.t);if(this.isIsogenous(e.curve)){const e=r.redMul(i),s=r.redSqr(),f=i.redSqr(),d=n.redSqr(),o=t.redMul(s),h=e.redIMuln(2),a=f.redSub(o),c=f.redAdd(o),u=d.redIMuln(2).redISub(c),l=this.cpoint(h,a,c,u);return this.twisted?l:l.divn(4)}if(this.isIsomorphic(e.curve)){const t=this._scale(e.curve),f=t.redMul(r),d=i,o=n,h=t.redMul(s);return this.point(f,d,o,h)}throw new Error("Not implemented.")}pointFromUniform(e,t=null){J(e instanceof a),J(e.red===this.red),J(null==t||t instanceof y),t||(t=this._alt());const r=t.field(e),i=t.pointFromUniform(r);return this.pointFromMont(i)}pointToUniform(e,t,r=null){J(e instanceof _),J(t>>>0===t),J(null==r||r instanceof y),r||(r=this._alt());const i=(t>>4&15)%this.torsion.length,n=e.add(this.torsion[i]),s=r.pointFromEdwards(n),f=r.pointToUniform(s,15&t);return this.field(f)}pointFromHash(e,t,r=null){J(null==r||r instanceof y),r||(r=this._alt());const i=r.pointFromHash(e,t);return this.pointFromMont(i)}pointToHash(e,t,r,i=null){J(e instanceof _),J(t>>>0===t),J(null==i||i instanceof y),i||(i=this._alt());const n=t%this.torsion.length,s=e.add(this.torsion[n]),f=i.pointFromEdwards(s);return i.pointToHash(f,0,r)}decodePoint(e){return _.decode(this,e)}toShort(e,t,r=null){const[i,n]=this._short(e,t),s=new g({red:this.red,prime:this.prime,p:this.p,a:i,b:n,n:this.n,h:this.h});if(null!=r){const[,e]=s._scale(this);e.redIsOdd()!==r&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromEdwards(this.g));for(let e=0;e<this.h.word(0);e++)s.torsion[e]=s.pointFromEdwards(this.torsion[e]);return s}toMont(e,t,r=null){const[i,n]=this._mont(e,t),s=new y({red:this.red,prime:this.prime,p:this.p,a:i,b:n,n:this.n,h:this.h,z:this.z});if(null!=r){const e=this._scale(s,t);e.redIsOdd()!==r&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromEdwards(this.g));for(let e=0;e<this.h.word(0);e++)s.torsion[e]=s.pointFromEdwards(this.torsion[e]);return s}toEdwards(e,t=null){const[r,i]=this._edwards(e),n=new I({red:this.red,prime:this.prime,p:this.p,a:r,d:i,n:this.n,h:this.h,z:this.z});if(null!=t){const e=n._scale(this);e.redIsOdd()!==t&&e.redINeg()}if(this.g.isInfinity()||(n.g=n.pointFromEdwards(this.g),n.g.normalize()),n.isComplete())for(let e=0;e<this.h.word(0);e++)n.torsion[e]=n.pointFromEdwards(this.torsion[e]),n.torsion[e].normalize();return n}pointFromJSON(e){return _.fromJSON(this,e)}toJSON(e){const t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.d=this.d.fromRed().toJSON(),this.s.isZero()||(t.s=this.s.fromRed().toJSON()),t}}class _ extends p{constructor(e,t,r,i,n){J(e instanceof I),super(e,c.EXTENDED),this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=1,null!=t&&this._init(t,r,i,n)}_init(e,t,r,i){J(e instanceof a),J(t instanceof a),J(null==r||r instanceof a),J(null==i||i instanceof a),this.x=e,this.y=t,this.z=r||this.curve.one,this.t=i||null,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=0|this.z.eq(this.curve.one),this._check(),this.t||(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redDiv(this.z)))}_check(){if(this.z.isZero())throw new Error("Invalid point.")}clone(){return this.curve.point(this.x.clone(),this.y.clone(),this.z.clone(),this.t.clone())}swap(e,t){J(e instanceof _);const r=1&(t>>31|-t>>31),i=this.zOne,n=e.zOne;return this.x.cswap(e.x,t),this.y.cswap(e.y,t),this.z.cswap(e.z,t),this.t.cswap(e.t,t),this.zOne=i&(1^r)|n&r,e.zOne=n&(1^r)|i&r,this}normalize(){if(this.zOne)return this;const e=this.z.redInvert();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t=this.t.redMul(e),this.z=this.curve.one,this.zOne=1,this}scale(e){J(e instanceof a);const t=this.x.redMul(e),r=this.y.redMul(e),i=this.z.redMul(e),n=this.t.redMul(e);return this.curve.point(t,r,i,n)}neg(){const e=this.x.redNeg(),t=this.y,r=this.z,i=this.t.redNeg();return this.curve.point(e,t,r,i)}add(e){return J(e instanceof _),this.isInfinity()?e:e.isInfinity()?this:this.zOne?e._add(this,0):this._add(e,0)}_add(e,t){return this.curve.mOneA?this._addM1(e,t):this._addA(e,t)}_addM1(e,t){const r=e.zOne&(1^t),i=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),s=this.t.redMul(this.curve.k).redMul(e.t),f=r?this.z.redAdd(this.z):this.z.redMul(e.z).redIMuln(2),d=n.redSub(i),o=f.redSub(s),h=f.redIAdd(s),a=n.redIAdd(i),c=d.redMul(o),u=h.redMul(a),l=d.redMul(a),b=o.redMul(h);return this.curve.point(c,u,b,l)}_addA(e,t){const r=e.zOne&(1^t),i=this.x.redMul(e.x),n=this.y.redMul(e.y),s=this.curve._mulD(this.t).redMul(e.t),f=r?this.z.clone():this.z.redMul(e.z),d=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(i).redISub(n),o=f.redSub(s),h=f.redIAdd(s),a=n.redISub(this.curve._mulA(i)),c=d.redMul(o),u=h.redMul(a),l=d.redMul(a),b=o.redMul(h);return this.curve.point(c,u,b,l)}dbl(){return this.isInfinity()?this:this._dbl(0)}_dbl(e){const t=this.zOne&(1^e),r=this.x.redSqr(),i=this.y.redSqr(),n=t?this.curve.two:this.z.redSqr().redIMuln(2),s=this.curve._mulA(r),f=this.x.redAdd(this.y).redSqr().redISub(r).redISub(i),d=s.redAdd(i),o=d.redSub(n),h=s.redISub(i),a=f.redMul(o),c=d.redMul(h),u=f.redMul(h),l=o.redMul(d);return this.curve.point(a,c,l,u)}uadd(e){return J(e instanceof _),this._add(e,1)}udbl(){return this._dbl(1)}getX(){return this.normalize(),this.x.fromRed()}getY(){return this.normalize(),this.y.fromRed()}eq(e){if(J(e instanceof _),J(!this.z.isZero()),J(!e.z.isZero()),this===e)return!0;if(this.z.eq(e.z))return this.x.eq(e.x)&&this.y.eq(e.y);const t=this.x.redMul(e.z),r=e.x.redMul(this.z);if(!t.eq(r))return!1;const i=this.y.redMul(e.z),n=e.y.redMul(this.z);return i.eq(n)}cmp(e){return J(e instanceof _),this.order().cmp(e.order())||this.getY().cmp(e.getY())||this.getX().cmp(e.getX())}isInfinity(){return J(!this.z.isZero()),!!this.x.isZero()&&this.y.eq(this.z)}isOrder2(){return!this.isInfinity()&&this.x.isZero()}isOdd(){return this.normalize(),this.x.redIsOdd()}isEven(){return this.normalize(),this.x.redIsEven()}toP(){return this.normalize()}toJ(){return this}encode(){const e=this.getY();return e.setn(this.curve.signBit,this.x.redIsOdd()),this.curve.encodeAdjusted(e)}static decode(e,t){J(e instanceof I);const r=e.decodeAdjusted(t),i=0!==r.testn(e.signBit);if(r.setn(e.signBit,0),r.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromY(r,i)}toJSON(e){if(this.isInfinity())return[];const t=this.getX().toJSON(),r=this.getY().toJSON();return!0===e&&this.pre?[t,r,this.pre.toJSON()]:[t,r]}toPretty(){const e=2*this.curve.fieldSize;return[U(this.getX(),e),U(this.getY(),e)]}static fromJSON(e,t){if(J(e instanceof I),J(Array.isArray(t)),J(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();const r=a.fromJSON(t[0]),i=a.fromJSON(t[1]),n=e.point(r,i);return t.length>2&&null!=t[2]&&(n.pre=E.fromJSON(n,t[2])),n}[h](){return this.isInfinity()?"<EdwardsPoint: Infinity>":"<EdwardsPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class E{constructor(){this.naf=null,this.windows=null,this.doubles=null,this.blinding=null,this.beta=null}map(e){J("function"==typeof e);const t=new this.constructor;return this.naf&&(t.naf=this.naf.map(e)),this.doubles&&(t.doubles=this.doubles.map(e)),t}toJSON(){return{naf:this.naf?this.naf.toJSON():null,windows:this.windows?this.windows.toJSON():null,doubles:this.doubles?this.doubles.toJSON():null,blinding:this.blinding?this.blinding.toJSON():t}}fromJSON(e,t){return J(e instanceof p),J(t&&"object"==typeof t),null!=t.naf&&(this.naf=A.fromJSON(e,t.naf)),null!=t.windows&&(this.windows=x.fromJSON(e,t.windows)),null!=t.doubles&&(this.doubles=q.fromJSON(e,t.doubles)),null!=t.blinding&&(this.blinding=N.fromJSON(e,t.blinding)),this}static fromJSON(e,t){return(new this).fromJSON(e,t)}}class A{constructor(e,t){this.width=e,this.points=t}map(e){J("function"==typeof e);const{width:t}=this,r=[];for(const t of this.points)r.push(e(t));return new this.constructor(t,r)}toJSON(){return{width:this.width,points:this.points.slice(1).map(e=>e.toJSON())}}static fromJSON(e,t){J(e instanceof p),J(t&&"object"==typeof t),J(t.width>>>0===t.width),J(Array.isArray(t.points));const{curve:r}=e,{width:i}=t,n=[e];for(const e of t.points)n.push(r.pointFromJSON(e));return new this(i,n)}}class x{constructor(e,t,r){this.width=e,this.bits=t,this.points=r}toJSON(){return{width:this.width,bits:this.bits,points:this.points.slice(1).map(e=>e.toJSON())}}static fromJSON(e,t){J(e instanceof p),J(t&&"object"==typeof t),J(t.width>>>0===t.width),J(t.bits>>>0===t.bits),J(Array.isArray(t.points));const{curve:r}=e,{width:i,bits:n}=t,s=[e];for(const e of t.points)s.push(r.pointFromJSON(e));return new this(i,n,s)}}class q{constructor(e,t){this.step=e,this.points=t}map(e){J("function"==typeof e);const{step:t}=this,r=[];for(const t of this.points)r.push(e(t));return new this.constructor(t,r)}toJSON(){return{step:this.step,points:this.points.slice(1).map(e=>e.toJSON())}}static fromJSON(e,t){J(e instanceof p),J(t&&"object"==typeof t),J(t.step>>>0===t.step),J(Array.isArray(t.points));const{curve:r}=e,{step:i}=t,n=[e];for(const e of t.points)n.push(r.pointFromJSON(e));return new this(i,n)}}class N{constructor(e,t){this.blind=e,this.unblind=t}toJSON(){return{blind:this.blind.toJSON(),unblind:this.unblind.toJSON()}}static fromJSON(e,t){J(e instanceof p),J(t&&"object"==typeof t);const{curve:r}=e;return new this(a.fromJSON(t.blind),r.pointFromJSON(t.unblind))}}class z{constructor(e,t,r,i){this.beta=e,this.lambda=t,this.basis=r,this.pre=i}toJSON(){return{beta:this.beta.fromRed().toJSON(),lambda:this.lambda.toJSON(),basis:[this.basis[0].toJSON(),this.basis[1].toJSON()],pre:[this.pre[0].toJSON(),this.pre[1].toJSON()]}}static fromJSON(e,t){return J(e instanceof m),J(t&&"object"==typeof t),J(Array.isArray(t.basis)),J(Array.isArray(t.pre)),J(2===t.basis.length),J(2===t.pre.length),new this(a.fromJSON(t.beta).toRed(e.red),a.fromJSON(t.lambda),[O.fromJSON(t.basis[0]),O.fromJSON(t.basis[1])],[a.fromJSON(t.pre[0]),a.fromJSON(t.pre[1])])}}class O{constructor(e,t){this.a=e,this.b=t}toJSON(){return{a:this.a.toJSON(),b:this.b.toJSON()}}static fromJSON(e){return J(e&&"object"==typeof e),new this(a.fromJSON(e.a),a.fromJSON(e.b))}}const B={__proto__:null,P192:class extends g{constructor(e){super({id:"P192",ossl:"prime192v1",type:"short",endian:"be",hash:"SHA256",prime:"p192",p:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff fffffffc"],b:["64210519 e59c80e7 0fa7e9ab 72243049","feb8deec c146b9b1"],n:["ffffffff ffffffff ffffffff 99def836","146bc9b1 b4d22831"],h:"1",z:"-5",g:[["188da80e b03090f6 7cbf20eb 43a18800","f4ff0afd 82ff1012"],["07192b95 ffc8da78 631011ed 6b24cdd5","73f977a1 1e794811"],e]})}},P224:class extends g{constructor(e){super({id:"P224",ossl:"secp224r1",type:"short",endian:"be",hash:"SHA256",prime:"p224",p:["ffffffff ffffffff ffffffff ffffffff","00000000 00000000 00000001"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff fffffffe"],b:["b4050a85 0c04b3ab f5413256 5044b0b7","d7bfd8ba 270b3943 2355ffb4"],n:["ffffffff ffffffff ffffffff ffff16a2","e0b8f03e 13dd2945 5c5c2a3d"],h:"1",z:"1f",g:[["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3","56c21122 343280d6 115c1d21"],["bd376388 b5f723fb 4c22dfe6 cd4375a0","5a074764 44d58199 85007e34"],e]})}},P256:class extends g{constructor(e){super({id:"P256",ossl:"prime256v1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff ffffffff"],a:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff fffffffc"],b:["5ac635d8 aa3a93e7 b3ebbd55 769886bc","651d06b0 cc53b0f6 3bce3c3e 27d2604b"],n:["ffffffff 00000000 ffffffff ffffffff","bce6faad a7179e84 f3b9cac2 fc632551"],h:"1",z:"-a",g:[["6b17d1f2 e12c4247 f8bce6e5 63a440f2","77037d81 2deb33a0 f4a13945 d898c296"],["4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16","2bce3357 6b315ece cbb64068 37bf51f5"],e]})}},P384:class extends g{constructor(e){super({id:"P384",ossl:"secp384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 ffffffff"],a:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 fffffffc"],b:["b3312fa7 e23ee7e4 988e056b e3f82d19","181d9c6e fe814112 0314088f 5013875a","c656398d 8a2ed19d 2a85c8ed d3ec2aef"],n:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff c7634d81 f4372ddf","581a0db2 48b0a77a ecec196a ccc52973"],h:"1",z:"-c",g:[["aa87ca22 be8b0537 8eb1c71e f320ad74","6e1d3b62 8ba79b98 59f741e0 82542a38","5502f25d bf55296c 3a545e38 72760ab7"],["3617de4a 96262c6f 5d9e98bf 9292dc29","f8f41dbd 289a147c e9da3113 b5f0b8c0","0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"],e]})}},P521:class extends g{constructor(e){super({id:"P521",ossl:"secp521r1",type:"short",endian:"be",hash:"SHA512",prime:"p521",p:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff"],a:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffc"],b:["00000051 953eb961 8e1c9a1f 929a21a0","b68540ee a2da725b 99b315f3 b8b48991","8ef109e1 56193951 ec7e937b 1652c0bd","3bb1bf07 3573df88 3d2c34f1 ef451fd4","6b503f00"],n:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffa 51868783 bf2f966b 7fcc0148","f709a5d0 3bb5c9b8 899c47ae bb6fb71e","91386409"],h:"1",z:"-4",g:[["000000c6 858e06b7 0404e9cd 9e3ecb66","2395b442 9c648139 053fb521 f828af60","6b4d3dba a14b5e77 efe75928 fe1dc127","a2ffa8de 3348b3c1 856a429b f97e7e31","c2e5bd66"],["00000118 39296a78 9a3bc004 5c8a5fb4","2c7d1bd9 98f54449 579b4468 17afbd17","273e662c 97ee7299 5ef42640 c550b901","3fad0761 353c7086 a272c240 88be9476","9fd16650"],e]})}},SECP256K1:class extends g{constructor(e){super({id:"SECP256K1",ossl:"secp256k1",type:"short",endian:"be",hash:"SHA256",prime:"k256",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe fffffc2f"],a:"0",b:"7",n:["ffffffff ffffffff ffffffff fffffffe","baaedce6 af48a03b bfd25e8c d0364141"],h:"1",z:"1",c:["0a2d2ba9 3507f1df 233770c2 a797962c","c61f6d15 da14ecd4 7d8d27ae 1cd5f852"],g:[["79be667e f9dcbbac 55a06295 ce870b07","029bfcdb 2dce28d9 59f2815b 16f81798"],["483ada77 26a3c465 5da4fbfc 0e1108a8","fd17b448 a6855419 9c47d08f fb10d4b8"],e],endo:{beta:["7ae96a2b 657c0710 6e64479e ac3434e9","9cf04975 12f58995 c1396c28 719501ee"],lambda:["5363ad4c c05c30e0 a5261c02 8812645a","122e22ea 20816678 df02967c 1b23bd72"],basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],pre:["3086d221a7d46bcde86c90e49284eb153dab","-e4437ed6010e88286f547fa90abfe4c42212"]}})}},BRAINPOOLP256:class extends g{constructor(e){super({id:"BRAINPOOLP256",ossl:"brainpoolP256r1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["a9fb57db a1eea9bc 3e660a90 9d838d72","6e3bf623 d5262028 2013481d 1f6e5377"],a:["7d5a0975 fc2c3057 eef67530 417affe7","fb8055c1 26dc5c6c e94a4b44 f330b5d9"],b:["26dc5c6c e94a4b44 f330b5d9 bbd77cbf","95841629 5cf7e1ce 6bccdc18 ff8c07b6"],n:["a9fb57db a1eea9bc 3e660a90 9d838d71","8c397aa3 b561a6f7 901e0e82 974856a7"],h:"1",z:"-2",g:[["8bd2aeb9 cb7e57cb 2c4b482f fc81b7af","b9de27e1 e3bd23c2 3a4453bd 9ace3262"],["547ef835 c3dac4fd 97f8461a 14611dc9","c2774513 2ded8e54 5c1d54c7 2f046997"],e]})}},BRAINPOOLP384:class extends g{constructor(e){super({id:"BRAINPOOLP384",ossl:"brainpoolP384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b4 12b1da19 7fb71123","acd3a729 901d1a71 87470013 3107ec53"],a:["7bc382c6 3d8c150c 3c72080a ce05afa0","c2bea28e 4fb22787 139165ef ba91f90f","8aa5814a 503ad4eb 04a8c7dd 22ce2826"],b:["04a8c7dd 22ce2826 8b39b554 16f0447c","2fb77de1 07dcd2a6 2e880ea5 3eeb62d5","7cb43902 95dbc994 3ab78696 fa504c11"],n:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b3 1f166e6c ac0425a7","cf3ab6af 6b7fc310 3b883202 e9046565"],h:"1",z:"-5",g:[["1d1c64f0 68cf45ff a2a63a81 b7c13f6b","8847a3e7 7ef14fe3 db7fcafe 0cbd10e8","e826e034 36d646aa ef87b2e2 47d4af1e"],["8abe1d75 20f9c2a4 5cb1eb8e 95cfd552","62b70b29 feec5864 e19c054f f9912928","0e464621 77918111 42820341 263c5315"],e]})}},BRAINPOOLP512:class extends g{constructor(e){super({id:"BRAINPOOLP512",ossl:"brainpoolP512r1",type:"short",endian:"be",hash:"SHA512",prime:null,p:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330871","7d4d9b00 9bc66842 aecda12a e6a380e6","2881ff2f 2d82c685 28aa6056 583a48f3"],a:["7830a331 8b603b89 e2327145 ac234cc5","94cbdd8d 3df91610 a83441ca ea9863bc","2ded5d5a a8253aa1 0a2ef1c9 8b9ac8b5","7f1117a7 2bf2c7b9 e7c1ac4d 77fc94ca"],b:["3df91610 a83441ca ea9863bc 2ded5d5a","a8253aa1 0a2ef1c9 8b9ac8b5 7f1117a7","2bf2c7b9 e7c1ac4d 77fc94ca dc083e67","984050b7 5ebae5dd 2809bd63 8016f723"],n:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330870","553e5c41 4ca92619 41866119 7fac1047","1db1d381 085ddadd b5879682 9ca90069"],h:"1",z:"7",g:[["81aee4bd d82ed964 5a21322e 9c4c6a93","85ed9f70 b5d916c1 b43b62ee f4d0098e","ff3b1f78 e2d0d48d 50d1687b 93b97d5f","7c6d5047 406a5e68 8b352209 bcb9f822"],["7dde385d 566332ec c0eabfa9 cf7822fd","f209f700 24a57b1a a000c55b 881f8111","b2dcde49 4a5f485e 5bca4bd8 8a2763ae","d1ca2b2f a8f05406 78cd1e0f 3ad80892"],e]})}},X25519:class extends y{constructor(){super({id:"X25519",ossl:"X25519",type:"mont",endian:"le",hash:"SHA512",prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"76d06",b:"1",n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000009"],["5f51e65e 475f794b 1fe122d3 88b72eb3","6dc2b281 92839e4d d6163a5d 81312c14"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["6be4f497 f9a9c2af c21fa77a d7f4a6ef","635a11c7 284a9363 e9a248ef 9c884415"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["141b0b68 06563d50 3de05885 280b5910","9ca5ee38 d7b56c9c 165db710 6377bbd8"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["68c59389 3d458e64 31c6ca00 45fb5015","20a44346 8eaa68dd 0f103842 048065b7"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["173a6c76 c2ba719b ce3935ff ba04afea","df5bbcb9 71559722 f0efc7bd fb7f9a36"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["3931c129 569e83a5 29482c14 e628b457","933bfc29 ed801b4d 68871483 92507b1a"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["46ce3ed6 a9617c5a d6b7d3eb 19d74ba8","6cc403d6 127fe4b2 9778eb7c 6daf84d3"]]]})}},X448:class extends y{constructor(){super({id:"X448",ossl:"X448",type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"262a6",b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000005"],["7d235d12 95f5b1f6 6c98ab6e 58326fce","cbae5d34 f55545d0 60f75dc2 8df3f6ed","b8027e23 46430d21 1312c4b1 50677af7","6fd7223d 457b5b1a"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["ba4d3a08 29b6112f 8812e51b a0bb2abe","bc1cb08e b48e5569 36ba50fd d2e7d68a","f8cb3216 0522425b 3f990812 abbe635a","d37a21e1 7551b193"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["45b2c5f7 d649eed0 77ed1ae4 5f44d541","43e34f71 4b71aa96 c945af01 2d182975","0734cde9 faddbda4 c066f7ed 54419ca5","2c85de1e 8aae4e6c"]]]})}},MONT448:class extends y{constructor(){super({id:"MONT448",ossl:null,type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:["b2cf97d2 d43459a9 31ed36b1 fc4e3cb5","5d93f8d2 22746997 60ccffc6 49961ed6","c5b05fca c24864ed 6fb59697 931b78da","84ddecd8 ca2b5cfb"],b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["ac0d24cc c6c75cb0 eb71f81e 7a6edf51","48e88aee 009a2a24 e795687e c28e125a","3e6730a6 0d46367b aa7fe99d 152128dc","41321bc7 7817f059"],["5a4437f6 80c0d0db 9b061276 d5d0ffcc","e786ff33 b6a53d30 98746425 82e66f09","4433dae7 7244a6e2 6b11e905 7228f483","556c41a5 913f55fe"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["bec92fd0 6da2acf2 b4e261e8 7cef0d34","22e75c18 3c589857 b71924e5 73c2f9ce","e18da5f2 466e2f39 3c2eedf0 f105a60a","b40c717d 4f1e1fd7"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["4136d02f 925d530d 4b1d9e17 8310f2cb","dd18a3e7 c3a767a8 48e6db19 8c3d0631","1e725a0d b991d0c6 c3d1120f 0efa59f5","4bf38e82 b0e1e028"]]]})}},ED25519:class extends I{constructor(e){super({id:"ED25519",ossl:"ED25519",type:"edwards",endian:"le",hash:"SHA512",prefix:"SigEd25519 no Ed25519 collisions",context:!1,prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"-1",d:["52036cee 2b6ffe73 8cc74079 7779e898","00700a4d 4141d8ab 75eb4dca 135978a3"],n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["216936d3 cd6e53fe c0a4e231 fdd6dc5c","692cc760 9525a7b2 c9562d60 8f25d51a"],["66666666 66666666 66666666 66666666","66666666 66666666 66666666 66666658"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffec"]],[["2b832480 4fc1df0b 2b4d0099 3dfbd7a7","2f431806 ad2fe478 c4ee1b27 4a0ea0b0"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["547cdb7f b03e20f4 d4b2ff66 c2042858","d0bce7f9 52d01b87 3b11e4d8 b5f15f3d"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]]]})}},ISO448:class extends I{constructor(e){super({id:"ISO448",ossl:null,type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["d78b4bdc 7f0daf19 f24f38c2 9373a2cc","ad461572 42a50f37 809b1da3 412a12e7","9ccc9c81 264cfe9a d0809970 58fb61c4","243cc32d baa156b9"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["79a70b2b 70400553 ae7c9df4 16c792c6","1128751a c9296924 0c25a07d 728bdc93","e21f7787 ed697224 9de732f3 8496cd11","69871309 3e9c04fc"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 80000000","00000000 00000000 00000000 00000000","00000000 00000001"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}},ED448:class extends I{constructor(e){super({id:"ED448",ossl:"ED448",type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffff6756"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["4f1970c6 6bed0ded 221d15a6 22bf36da","9e146570 470f1767 ea6de324 a3d3a464","12ae1af7 2ab66511 433b80e1 8b00938e","2626a82b c70cc05e"],["693f4671 6eb6bc24 88762037 56c9c762","4bea7373 6ca39840 87789c1e 05a0c2d7","3ad3ff1c e67c39c4 fdbd132c 4ed7c8ad","9808795b f230fa14"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}}},j={__proto__:null,P192:null,P224:null,P256:null,P384:null,P521:null,SECP256K1:null,BRAINPOOLP256:null,BRAINPOOLP384:null,BRAINPOOLP512:null,X25519:null,X448:null,MONT448:null,ED25519:null,ISO448:null,ED448:null};function R(e,t,r){J(e instanceof a),J(!e.red),J(t>>>0===t),J(r>>>0===r);const i=new Array(r),n=e.bitLength()+1,s=1|e.sign();J(n<=r);for(let e=0;e<r;e++)i[e]=0;let f,d=0,o=0;for(;d<n;)e.bit(d)!==o?(f=e.bits(d,t)+o,f-=(o=f>>t-1&1)<<t,i[d]=s*f,d+=t):d+=1;return J(0===o),i}function P(e,t,r){const i=function(e,t,r){J(e instanceof a),J(t instanceof a),J(!e.red),J(!t.red),J(r>>>0===r);const i=[new Array(r),new Array(r)],n=Math.max(e.bitLength(),t.bitLength())+1,s=1|e.sign(),f=1|t.sign();J(n<=r);let d=0,o=0;for(let r=0;r<n;r++){const n=e.bits(r,3),h=t.bits(r,3);let a=(3&n)+d&3,c=(3&h)+o&3,u=0,l=0;if(3===a&&(a=-1),3===c&&(c=-1),1&a){const e=(7&n)+d&7;u=3!==e&&5!==e||2!==c?a:-a}if(1&c){const e=(7&h)+o&7;l=3!==e&&5!==e||2!==a?c:-c}i[0][r]=u*s,i[1][r]=l*f,2*d===u+1&&(d=1-d),2*o===l+1&&(o=1-o)}for(let e=n;e<r;e++)i[0][e]=0,i[1][e]=0;return i}(e,t,r),n=new Array(r);for(let e=0;e<r;e++){const t=i[0][e],r=i[1][e];n[e]=u[3*(t+1)+(r+1)]}return n}function J(e,t){if(!e){const e=new Error(t||"Assertion failed");throw Error.captureStackTrace&&Error.captureStackTrace(e,J),e}}function k(e){J(e instanceof a);try{return[1,e.redSqrt()]}catch(t){if("X is not a square mod P."===t.message)return[0,e.clone()];throw t}}function F(e,t){J(e instanceof a),J(t instanceof a);try{return[1,e.redDivSqrt(t)]}catch(t){if("Not invertible."===t.message||"X is not a square mod P."===t.message)return[0,e.clone()];throw t}}function Z(e){const t=function(e){J(e instanceof a),J(e.red);const t=e.red.m;if(t.cmpn(3)<=0)return e.clone();if(2===t.modrn(3)){const r=t.ushln(1).isubn(1).idivn(3);return e.redPow(r)}const r=t.modrn(9);if(4===r){const r=t.ushln(1).iaddn(1).idivn(9),i=e.redPow(r);if(!i.redSqr().redMul(i).eq(e))throw new Error("X is not a cube mod P.");return i}if(7===r){const r=t.addn(2).idivn(9),i=e.redPow(r);if(!i.redSqr().redMul(i).eq(e))throw new Error("X is not a cube mod P.");return i}throw new Error("Not implemented.")}(e);if(1===e.red.m.modrn(3)){const r=new a(2).toRed(e.red),i=new a(3).toRed(e.red),n=r.redInvert(),s=i.redNeg().redSqrt().redMul(n),f=s.redNeg(),d=s.redSub(n),o=f.redSub(n);return[t,t.redMul(d),t.redMul(o)]}return[t]}function L(e){for(const t of Z(e))if(t.redJacobi()>=0)return t;throw new Error("X^(1/3) is not a square mod P.")}function D(e){return a.randomBits(e,32).toNumber()}function T(e,t){const r=new WeakMap;return function(i,n){const s=1&n,f=r.get(i);if(f&&null!==f[s])return f[s];const d=e.call(t,i,n);return r.has(i)||r.set(i,[null,null]),r.get(i)[s]=d,d}}function U(e,t){J(e instanceof a),J(t>>>0===t),7&t&&(t+=8-(7&t));const r=e.toString(16,t),i=[],n=[];J(0==(7&r.length));for(let e=0;e<r.length;e+=8)i.push(r.slice(e,e+8));for(let e=0;e<i.length;e+=4)n.push(i.slice(e,e+4).join(" "));return n}e.Curve=m,e.Point=p,e.ShortCurve=g,e.ShortPoint=w,e.JPoint=v,e.MontCurve=y,e.MontPoint=M,e.XPoint=S,e.EdwardsCurve=I,e.EdwardsPoint=_,e.curves=B,e.curve=function(e,...t){J("string"==typeof e);const r=e.toUpperCase();let i=j[r];if(!i){const n=B[r];if(!n)throw new Error(`Curve not found: "${e}".`);i=new n(...t),j[r]=i}return i},e.register=function(e,t){J("string"==typeof e),J("function"==typeof t);const r=e.toUpperCase();if(B[r])throw new Error(`Curve already registered: "${e}".`);B[r]=t,j[r]=null}}],["bcrypto","/lib/js/precomputed/secp256k1.json",function(e,t,r,i,n,s){r.exports={naf:{width:9,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","0ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","02de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","02972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","0d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["049370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","091b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","0673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","0a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","09414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["078c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","04f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","073867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["0336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","060660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","0b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["04e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["0c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","021ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","0c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","09731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","0cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","0712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]},doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","04e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["06f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["0948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","0e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","067c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["0928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","0d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["08ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]}}}],["bpkg","/lib/builtins/buffer.js",function(e,r,n,s,f,d){var o=[["buffer","/index.js",function(e,r,n,s,f){"use strict";var d=a(1),o=a(2);e.Buffer=u,e.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},e.INSPECT_MAX_BYTES=50;var h=2147483647;function c(e){if(e>h)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=u.prototype,t}function u(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return m(e)}return l(e,t,r)}function l(e,r,i){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|w(e,t),i=c(r),n=i.write(e,t);n!==r&&(i=i.slice(0,n));return i}(e,r);if(ArrayBuffer.isView(e))return p(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(X(e,ArrayBuffer)||e&&X(e.buffer,ArrayBuffer))return function(e,r,i){if(r<0||e.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<r+(i||0))throw new RangeError('"length" is outside of buffer bounds');var n;n=r===t&&i===t?new Uint8Array(e):i===t?new Uint8Array(e,r):new Uint8Array(e,r,i);return n.__proto__=u.prototype,n}(e,r,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return u.from(n,r,i);var s=function(e){if(null!=e&&!0===e._isBuffer){var r=0|g(e.length),i=c(r);return 0===i.length?i:(e.copy(i,0,0,r),i)}if(e.length!==t)return"number"!=typeof e.length||Y(e.length)?c(0):p(e);if("Buffer"===e.type&&Array.isArray(e.data))return p(e.data)}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),r,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function b(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function m(e){return b(e),c(e<0?0:0|g(e))}function p(e){for(var t=e.length<0?0:0|g(e.length),r=c(t),i=0;i<t;i+=1)r[i]=255&e[i];return r}function g(e){if(e>=h)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return 0|e}function w(e,t){if(null!=e&&!0===e._isBuffer)return e.length;if(ArrayBuffer.isView(e)||X(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return T(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return U(e).length;default:if(n)return i?-1:T(e).length;t=(""+t).toLowerCase(),n=!0}}function v(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function y(e,t,r,i,n){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Y(r=+r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=u.from(t,i)),null!=t&&!0===t._isBuffer)return 0===t.length?-1:M(e,t,r,i,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):M(e,[t],r,i,n);throw new TypeError("val must be string, number or Buffer")}function M(e,r,i,n,s){var f,d=1,o=e.length,h=r.length;if(n!==t&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||r.length<2)return-1;d=2,o/=2,h/=2,i/=2}function a(e,t){return 1===d?e[t]:e.readUInt16BE(t*d)}if(s){var c=-1;for(f=i;f<o;f++)if(a(e,f)===a(r,-1===c?0:f-c)){if(-1===c&&(c=f),f-c+1===h)return c*d}else-1!==c&&(f-=f-c),c=-1}else for(i+h>o&&(i=o-h),f=i;f>=0;f--){for(var u=!0,l=0;l<h;l++)if(a(e,f+l)!==a(r,l)){u=!1;break}if(u)return f}return-1}function S(e,t,r,i){r=Number(r)||0;var n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;var s=t.length;i>s/2&&(i=s/2);for(var f=0;f<i;++f){var d=parseInt(t.substr(2*f,2),16);if(Y(d))return f;e[r+f]=d}return f}function I(e,t,r,i){return C(T(t,e.length-r),e,r,i)}function _(e,t,r,i){return C(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,i)}function E(e,t,r,i){return _(e,t,r,i)}function A(e,t,r,i){return C(U(t),e,r,i)}function x(e,t,r,i){return C(function(e,t){for(var r,i,n,s=[],f=0;f<e.length&&!((t-=2)<0);++f)r=e.charCodeAt(f),i=r>>8,n=r%256,s.push(n),s.push(i);return s}(t,e.length-r),e,r,i)}function q(e,t,r){return 0===t&&r===e.length?d.fromByteArray(e):d.fromByteArray(e.slice(t,r))}function N(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var s,f,d,o,h=e[n],a=null,c=h>239?4:h>223?3:h>191?2:1;if(n+c<=r)switch(c){case 1:h<128&&(a=h);break;case 2:128==(192&(s=e[n+1]))&&(o=(31&h)<<6|63&s)>127&&(a=o);break;case 3:s=e[n+1],f=e[n+2],128==(192&s)&&128==(192&f)&&(o=(15&h)<<12|(63&s)<<6|63&f)>2047&&(o<55296||o>57343)&&(a=o);break;case 4:s=e[n+1],f=e[n+2],d=e[n+3],128==(192&s)&&128==(192&f)&&128==(192&d)&&(o=(15&h)<<18|(63&s)<<12|(63&f)<<6|63&d)>65535&&o<1114112&&(a=o)}null===a?(a=65533,c=1):a>65535&&(a-=65536,i.push(a>>>10&1023|55296),a=56320|1023&a),i.push(a),n+=c}return function(e){var t=e.length;if(t<=z)return String.fromCharCode.apply(String,e);var r="",i=0;for(;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=z));return r}(i)}e.kMaxLength=h,u.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||void 0===i||"function"!=typeof i.error||i.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){return u.isBuffer(this)?this.buffer:t}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){return u.isBuffer(this)?this.byteOffset:t}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),u.poolSize=8192,u.from=function(e,t,r){return l(e,t,r)},u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,u.alloc=function(e,r,i){return function(e,r,i){return b(e),e<=0?c(e):r!==t?"string"==typeof i?c(e).fill(r,i):c(e).fill(r):c(e)}(e,r,i)},u.allocUnsafe=function(e){return m(e)},u.allocUnsafeSlow=function(e){return m(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,t){if(X(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),X(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),null==e||!0!==e._isBuffer||null==t||!0!==t._isBuffer)throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,i=t.length,n=0,s=Math.min(r,i);n<s;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var i;if(r===t)for(r=0,i=0;i<e.length;++i)r+=e[i].length;var n=u.allocUnsafe(r),s=0;for(i=0;i<e.length;++i){var f=e[i];if(X(f,Uint8Array)&&(f=u.from(f)),null==f||!0!==f._isBuffer)throw new TypeError('"list" argument must be an Array of Buffers');f.copy(n,s),s+=f.length}return n},u.byteLength=w,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},u.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?N(this,0,e):function(e,r,i){var n=!1;if((r===t||r<0)&&(r=0),r>this.length)return"";if((i===t||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(r>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return j(this,r,i);case"utf8":case"utf-8":return N(this,r,i);case"ascii":return O(this,r,i);case"latin1":case"binary":return B(this,r,i);case"base64":return q(this,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,r,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(null==e||!0!==e._isBuffer)throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},u.prototype.compare=function(e,r,i,n,s){if(X(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),null==e||!0!==e._isBuffer)throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===t&&(r=0),i===t&&(i=e?e.length:0),n===t&&(n=0),s===t&&(s=this.length),r<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&r>=i)return 0;if(n>=s)return-1;if(r>=i)return 1;if(r>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;for(var f=s-n,d=i-r,o=Math.min(f,d),h=this.slice(n,s),a=e.slice(r,i),c=0;c<o;++c)if(h[c]!==a[c]){f=h[c],d=a[c];break}return f<d?-1:d<f?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},u.prototype.write=function(e,r,i,n){if(r===t)n="utf8",i=this.length,r=0;else if(i===t&&"string"==typeof r)n=r,i=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r>>>=0,isFinite(i)?(i>>>=0,n===t&&(n="utf8")):(n=i,i=t)}var s=this.length-r;if((i===t||i>s)&&(i=s),e.length>0&&(i<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var f=!1;;)switch(n){case"hex":return S(this,e,r,i);case"utf8":case"utf-8":return I(this,e,r,i);case"ascii":return _(this,e,r,i);case"latin1":case"binary":return E(this,e,r,i);case"base64":return A(this,e,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,r,i);default:if(f)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var z=4096;function O(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function B(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function j(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var n="",s=t;s<r;++s)n+=D(e[s]);return n}function R(e,t,r){for(var i=e.slice(t,r),n="",s=0;s<i.length;s+=2)n+=String.fromCharCode(i[s]+256*i[s+1]);return n}function P(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function J(e,t,r,i,n,s){if(null==e||!0!==e._isBuffer)throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function k(e,t,r,i,n,s){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(e,t,r,i,n){return t=+t,r>>>=0,n||k(e,0,r,4),o.write(e,t,r,i,23,4),r+4}function Z(e,t,r,i,n){return t=+t,r>>>=0,n||k(e,0,r,8),o.write(e,t,r,i,52,8),r+8}u.prototype.slice=function(e,r){var i=this.length;e=~~e,r=r===t?i:~~r,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),r<0?(r+=i)<0&&(r=0):r>i&&(r=i),r<e&&(r=e);var n=this.subarray(e,r);return n.__proto__=u.prototype,n},u.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var i=this[e],n=1,s=0;++s<t&&(n*=256);)i+=this[e+s]*n;return i},u.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},u.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var i=this[e],n=1,s=0;++s<t&&(n*=256);)i+=this[e+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},u.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var i=t,n=1,s=this[e+--i];i>0&&(n*=256);)s+=this[e+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},u.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),o.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),o.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),o.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),o.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,r,i){(e=+e,t>>>=0,r>>>=0,i)||J(this,e,t,r,Math.pow(2,8*r)-1,0);var n=1,s=0;for(this[t]=255&e;++s<r&&(n*=256);)this[t+s]=e/n&255;return t+r},u.prototype.writeUIntBE=function(e,t,r,i){(e=+e,t>>>=0,r>>>=0,i)||J(this,e,t,r,Math.pow(2,8*r)-1,0);var n=r-1,s=1;for(this[t+n]=255&e;--n>=0&&(s*=256);)this[t+n]=e/s&255;return t+r},u.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,1,255,0),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);J(this,e,t,r,n-1,-n)}var s=0,f=1,d=0;for(this[t]=255&e;++s<r&&(f*=256);)e<0&&0===d&&0!==this[t+s-1]&&(d=1),this[t+s]=(e/f>>0)-d&255;return t+r},u.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);J(this,e,t,r,n-1,-n)}var s=r-1,f=1,d=0;for(this[t+s]=255&e;--s>=0&&(f*=256);)e<0&&0===d&&0!==this[t+s+1]&&(d=1),this[t+s]=(e/f>>0)-d&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||J(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return Z(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return Z(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,i){if(null==e||!0!==e._isBuffer)throw new TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var n=i-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,i);else if(this===e&&r<t&&t<i)for(var s=n-1;s>=0;--s)e[s+t]=this[s+r];else Uint8Array.prototype.set.call(e,this.subarray(r,i),t);return n},u.prototype.fill=function(e,r,i,n){if("string"==typeof e){if("string"==typeof r?(n=r,r=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),n!==t&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var s=e.charCodeAt(0);("utf8"===n&&s<128||"latin1"===n)&&(e=s)}}else"number"==typeof e&&(e&=255);if(r<0||this.length<r||this.length<i)throw new RangeError("Out of range index");if(i<=r)return this;var f;if(r>>>=0,i=i===t?this.length:i>>>0,e||(e=0),"number"==typeof e)for(f=r;f<i;++f)this[f]=e;else{var d=null!=e&&!0===e._isBuffer?e:u.from(e,n),o=d.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(f=0;f<i-r;++f)this[f+r]=d[f%o]}return this};var L=/[^+/0-9A-Za-z-_]/g;function D(e){return e<16?"0"+e.toString(16):e.toString(16)}function T(e,t){var r;t=t||1/0;for(var i=e.length,n=null,s=[],f=0;f<i;++f){if((r=e.charCodeAt(f))>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(f+1===i){(t-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function U(e){return d.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function C(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}function X(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}}],["base64-js","/index.js",function(e,t,r,i,n){"use strict";e.byteLength=function(e){var t=c(e),r=t[0],i=t[1];return 3*(r+i)/4-i},e.toByteArray=function(e){for(var t,r=c(e),i=r[0],n=r[1],s=new d(function(e,t,r){return 3*(t+r)/4-r}(0,i,n)),o=0,h=n>0?i-4:i,a=0;a<h;a+=4)t=f[e.charCodeAt(a)]<<18|f[e.charCodeAt(a+1)]<<12|f[e.charCodeAt(a+2)]<<6|f[e.charCodeAt(a+3)],s[o++]=t>>16&255,s[o++]=t>>8&255,s[o++]=255&t;2===n&&(t=f[e.charCodeAt(a)]<<2|f[e.charCodeAt(a+1)]>>4,s[o++]=255&t);1===n&&(t=f[e.charCodeAt(a)]<<10|f[e.charCodeAt(a+1)]<<4|f[e.charCodeAt(a+2)]>>2,s[o++]=t>>8&255,s[o++]=255&t);return s},e.fromByteArray=function(e){for(var t,r=e.length,i=r%3,n=[],f=0,d=r-i;f<d;f+=16383)n.push(u(e,f,f+16383>d?d:f+16383));1===i?(t=e[r-1],n.push(s[t>>2]+s[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],n.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return n.join("")};for(var s=[],f=[],d="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,a=o.length;h<a;++h)s[h]=o[h],f[o.charCodeAt(h)]=h;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,r){for(var i,n,f=[],d=t;d<r;d+=3)i=(e[d]<<16&16711680)+(e[d+1]<<8&65280)+(255&e[d+2]),f.push(s[(n=i)>>18&63]+s[n>>12&63]+s[n>>6&63]+s[63&n]);return f.join("")}f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63}],["ieee754","/index.js",function(e,t,r,i,n){e.read=function(e,t,r,i,n){var s,f,d=8*n-i-1,o=(1<<d)-1,h=o>>1,a=-7,c=r?n-1:0,u=r?-1:1,l=e[t+c];for(c+=u,s=l&(1<<-a)-1,l>>=-a,a+=d;a>0;s=256*s+e[t+c],c+=u,a-=8);for(f=s&(1<<-a)-1,s>>=-a,a+=i;a>0;f=256*f+e[t+c],c+=u,a-=8);if(0===s)s=1-h;else{if(s===o)return f?NaN:1/0*(l?-1:1);f+=Math.pow(2,i),s-=h}return(l?-1:1)*f*Math.pow(2,s-i)},e.write=function(e,t,r,i,n,s){var f,d,o,h=8*s-n-1,a=(1<<h)-1,c=a>>1,u=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,l=i?0:s-1,b=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(d=isNaN(t)?1:0,f=a):(f=Math.floor(Math.log(t)/Math.LN2),t*(o=Math.pow(2,-f))<1&&(f--,o*=2),(t+=f+c>=1?u/o:u*Math.pow(2,1-c))*o>=2&&(f++,o/=2),f+c>=a?(d=0,f=a):f+c>=1?(d=(t*o-1)*Math.pow(2,n),f+=c):(d=t*Math.pow(2,c-1)*Math.pow(2,n),f=0));n>=8;e[r+l]=255&d,l+=b,d/=256,n-=8);for(f=f<<n|d,h+=n;h>0;e[r+l]=255&f,l+=b,f/=256,h-=8);e[r+l-b]|=128*m}}]],h=[];function a(t){if(t>>>0!==t||t>o.length)return function(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}(t);for(;h.length<=t;)h.push(null);var r=h[t];if(r)return r.exports;var i=o[t],d=i[0],a=i[1],c=i[2],u=e,l=n;0!==t&&(l={id:"/"+d+a,exports:u={},parent:n.parent,filename:n.filename,loaded:!1,children:n.children,paths:n.paths}),h[t]=l;try{c.call(u,u,l,s,f,void 0)}catch(e){throw h[t]=null,e}return o[t]=null,0!==t&&(l.loaded=!0),l.exports}a(0)}]],s=[];function f(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}function d(e){f(e)}function o(e,t){if(e>>>0!==e||e>n.length)return f(e);if(null!=t&&!t.children)return f(e);for(;s.length<=e;)s.push(null);var r=s[e];if(r)return r.exports;var i=n[e],o=i[0],h=i[1],a=i[2],c=h,u=c.split("/").slice(0,-1).join("/")||"/",l=d,b={},m={id:"/"+o+h,exports:b,parent:t,filename:c,loaded:!1,children:[],paths:["/"],require:l};t&&t.children.push(m),0===e&&(l.main=m),s[e]=m;try{a.call(b,b,l,m,c,u,void 0)}catch(t){throw s[e]=null,t}return n[e]=null,m.loaded=!0,m.exports}d.cache={__proto__:null},d.extensions={__proto__:null},d.main=null,d.resolve=f,d.resolve.paths=f,r=o(25,null).Buffer;var h=o(0,null);"function"==typeof define&&define.amd?define("auth",[],function(){return h}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?module.exports=h:e.auth=h}("undefined"!=typeof window&&window.Math===Math?window:"undefined"!=typeof self&&self.Math===Math?self:Function("return this")());
